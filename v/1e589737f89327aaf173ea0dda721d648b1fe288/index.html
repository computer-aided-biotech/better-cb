<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Daniela C. Soto *" />
  <meta name="author" content="Benjamín J. Sánchez *" />
  <meta name="dcterms.date" content="2022-03-22" />
  <meta name="keywords" content="markdown, publishing, manubot" />
  <title>Tools for (better) computational biology</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/master/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta name="dc.title" content="Tools for (better) computational biology" />
  <meta name="citation_title" content="Tools for (better) computational biology" />
  <meta property="og:title" content="Tools for (better) computational biology" />
  <meta property="twitter:title" content="Tools for (better) computational biology" />
  <meta name="dc.date" content="2022-03-22" />
  <meta name="citation_publication_date" content="2022-03-22" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Daniela C. Soto *" />
  <meta name="citation_author_institution" content="Genome Center, MIND Institute, and Department of Biochemistry &amp; Molecular Medicine, Davis, CA 95616,USA" />
  <meta name="citation_author_orcid" content="0000-0002-6292-655X" />
  <meta name="twitter:creator" content="@dcsoto_cl" />
  <meta name="citation_author" content="Benjamín J. Sánchez *" />
  <meta name="citation_author_institution" content="Department of Bioengineering, Technical University of Denmark, Kgs. Lyngby, 2800, Denmark" />
  <meta name="citation_author_orcid" content="0000-0001-6093-4110" />
  <meta name="twitter:creator" content="@BenjaSanchez" />
  <link rel="canonical" href="https://computer-aided-biotech.github.io/better-cb/" />
  <meta property="og:url" content="https://computer-aided-biotech.github.io/better-cb/" />
  <meta property="twitter:url" content="https://computer-aided-biotech.github.io/better-cb/" />
  <meta name="citation_fulltext_html_url" content="https://computer-aided-biotech.github.io/better-cb/" />
  <meta name="citation_pdf_url" content="https://computer-aided-biotech.github.io/better-cb/manuscript.pdf" />
  <link rel="alternate" type="application/pdf" href="https://computer-aided-biotech.github.io/better-cb/manuscript.pdf" />
  <link rel="alternate" type="text/html" href="https://computer-aided-biotech.github.io/better-cb/v/1e589737f89327aaf173ea0dda721d648b1fe288/" />
  <meta name="manubot_html_url_versioned" content="https://computer-aided-biotech.github.io/better-cb/v/1e589737f89327aaf173ea0dda721d648b1fe288/" />
  <meta name="manubot_pdf_url_versioned" content="https://computer-aided-biotech.github.io/better-cb/v/1e589737f89327aaf173ea0dda721d648b1fe288/manuscript.pdf" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Tools for (better) computational biology</h1>
</header>
<p><small><em>
This manuscript
(<a href="https://computer-aided-biotech.github.io/better-cb/v/1e589737f89327aaf173ea0dda721d648b1fe288/">permalink</a>)
was automatically generated
from <a href="https://github.com/computer-aided-biotech/better-cb/tree/1e589737f89327aaf173ea0dda721d648b1fe288">computer-aided-biotech/better-cb@1e58973</a>
on March 22, 2022.
</em></small></p>
<h2 id="authors">Authors</h2>
<ul>
<li><p><strong>Daniela C. Soto </strong>*<br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-6292-655X">0000-0002-6292-655X</a>
· <img src="images/github.svg" class="inline_icon" alt="GitHub icon" />
<a href="https://github.com/dcsoto">dcsoto</a>
· <img src="images/twitter.svg" class="inline_icon" alt="Twitter icon" />
<a href="https://twitter.com/dcsoto_cl">dcsoto_cl</a><br>
<small>
Genome Center, MIND Institute, and Department of Biochemistry &amp; Molecular Medicine, Davis, CA 95616,USA
</small></p></li>
<li><p><strong>Benjamín J. Sánchez </strong>*<br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0001-6093-4110">0000-0001-6093-4110</a>
· <img src="images/github.svg" class="inline_icon" alt="GitHub icon" />
<a href="https://github.com/BenjaSanchez">BenjaSanchez</a>
· <img src="images/twitter.svg" class="inline_icon" alt="Twitter icon" />
<a href="https://twitter.com/BenjaSanchez">BenjaSanchez</a><br>
<small>
Department of Bioengineering, Technical University of Denmark, Kgs. Lyngby, 2800, Denmark
</small></p></li>
</ul>
<h2 class="page_break_before" id="abstract">Abstract</h2>
<p>As biotechnological and biomedical research are increasingly fed by the insights arising from computation, the conversation about good practices in computational biology becomes more and more prominent. An increasing body of literature has addressed practices for shareable, reproducible, and sustainable computational research, from high-level principles for data and software stewardship to deep-dives into version control or software automation. However, the actual implementation of good practices remains unaddressed. The latter relies on incorporating the right tools into our daily routines, considering the type, scope and stage of the research project. Here we provide a compendium of relevant tools for computational biology research, emphasizing their time and place within a continuum that traverses personal practices, the collaborative practices of a team, and the practices required to interact with a community at large. This compendium will serve as a starting point and as a consulting guide to help navigate the ongoing influx of tools and how to best incorporate them into a computational biologist’s working routine, enabling reproducible biomedical and biotechnological research in the long term.</p>
<h2 id="introduction">Introduction</h2>
<p>Since Margaret Dayhoff pioneered the field of bioinformatics back in the sixties, the application of computational tools in the field of biology has vastly grown in scope and impact. Nowadays, biotechnological and biomedical research are routinely fed by the insights arising from novel computational approaches, machine learning algorithms and mathematical models. The ever increasing amount of biological data and the exponential growth in computing power will amplify this trend in the years to come.</p>
<p>The use of computing to address biological questions encompasses a wide array of applications usually grouped under the terms of “computational biology” and “bioinformatics”. Although distinct definitions have been delineated for each one <span class="citation" data-cites="Xcr0K7I5 jn2NeK3H">[<a href="#ref-Xcr0K7I5" role="doc-biblioref">1</a>,<a href="#ref-jn2NeK3H" role="doc-biblioref">2</a>]</span>, here we will consider both under the umbrella term “computational biology”, alluding to any application that involves the intersection of computing and biological data. As such, a computational biologist can be a data analyst, a data engineer, a statistician, a mathematical modeler, a software developer, and many others. In praxis, the modern computational biologist will be a “scientist of many hats”, taking on several of the duties listed above. But first and foremost, we will consider a computational biologist as a scientist whose ultimate goal is answering a biological question or addressing a need in the life sciences by means of computation.</p>
<p>Scientific computing requires following specific practices to enable shareable, reproducible and sustainable outputs. Computing-heavy disciplines, such as software engineering and data science, have adopted practices addressing the need for collaboration, visualization, project management, and strengthening of online communities. However, as a highly interdisciplinary and evolving field, computational biology has yet to acquire a set of universal “best practices”. Since most computational biologists come from diverse backgrounds and rely on self-study rather than formal education <span class="citation" data-cites="12RoKrne5">[<a href="#ref-12RoKrne5" role="doc-biblioref">3</a>]</span>, the absence of guidelines may leave many computational biologists astray, engaging in unsustainable practices that hinder reproducibility and collaboration, slowing down biomedical and biotechnological research.</p>
<p>In recent years, this “guidelines gap” has been addressed by the definition of FAIR principles—Findability, Accessibility, Interoperability, and Reusability—coined in 2016 <span class="citation" data-cites="6DjakjNS">[<a href="#ref-6DjakjNS" role="doc-biblioref">4</a>]</span>. Originally developed for data stewardship, FAIR principles have been proposed as universal guidelines for all research objects <span class="citation" data-cites="WrDwZxcM">[<a href="#ref-WrDwZxcM" role="doc-biblioref">5</a>]</span>. However, how to translate these high-level principles into day-to-day practices requires additional nuances, based on the type of research object, the size and scope of the project, and the experience of the researcher.</p>
<p>Over the last decade, several researchers have published advice on good practices for scientific computing and computational biology. Recently, the framework ADVerTS (availability of software, documenting software, version control, testing, and support) has been proposed as a set of “barely sufficient” practices to address the need for FAIR scientific software <span class="citation" data-cites="WrDwZxcM">[<a href="#ref-WrDwZxcM" role="doc-biblioref">5</a>]</span>. Other advice includes reviews introducing bench scientists new to computational biology to a wide range of topics ranging from programming to project organization <span class="citation" data-cites="k9JCaCug O6UbstGG 15pOpsdFR SGTWzj9t sSSw0sr0">[<a href="#ref-k9JCaCug" role="doc-biblioref">6</a>,<a href="#ref-O6UbstGG" role="doc-biblioref">7</a>,<a href="#ref-15pOpsdFR" role="doc-biblioref">8</a>,<a href="#ref-SGTWzj9t" role="doc-biblioref">9</a>,<a href="#ref-sSSw0sr0" role="doc-biblioref">10</a>]</span>, deep-dives into the use and applications of one powerful tool, such as the software development and version control cloud service GitHub <span class="citation" data-cites="kEX5dgzK">[<a href="#ref-kEX5dgzK" role="doc-biblioref">11</a>]</span> and the web-application Jupyter Notebooks <span class="citation" data-cites="eYWjWdLd">[<a href="#ref-eYWjWdLd" role="doc-biblioref">12</a>]</span>, or comprehensive reviews covering one specific need in computational biology, such as workflow automation <span class="citation" data-cites="1HhbGD4jJ">[<a href="#ref-1HhbGD4jJ" role="doc-biblioref">13</a>]</span> or software library development <span class="citation" data-cites="16iU4PKI1">[<a href="#ref-16iU4PKI1" role="doc-biblioref">14</a>]</span>.</p>
<p>Although this advice proves immensely helpful, some aspects of the computational biology “journey” remain uncovered. Indeed, guiding principles and general advice are key to establish a behavior roadmap, but their actual implementation is enabled by incorporating the right tools into our daily working routine. Tool selection has many components, from availability to suitability to personal preference, and although the latter is left to the reader, here we will shed light over the first two. We premise that good practices in computational biology lie within a continuum that traverses three “levels”: the individual’s personal practices, the collaborative practices of a team, and the practices that allow a broader scientific community to access and engage over time with the research (Figure <a href="#fig:levels-fig">1</a>). Each one of these levels has a different set of needs and challenges, as well as a specific set of tools that can be used to address them. Here, we compiled a curated list of these tools, emphasizing their time and place in a computational biology research project. Committed to practicality, we illustrated the utility of these tools in case studies covering a wide spectrum of research topics that computational biologists can use to model their own practices, modifying them to suit their own needs and preferences.</p>
<div id="fig:levels-fig" class="fignos">
<figure>
<img src="images/Figure1.png" style="width:75.0%" alt="" /><figcaption><span>Figure 1:</span> The three “levels” of computational biology include your personal research, your group and collaborators, and your scientific field.</figcaption>
</figure>
</div>
<h2 id="level-1-personal-research">Level 1: Personal Research</h2>
<p>The computational biology “journey” begins with you—specifically, with the set of skills, tools and practices that you have in place to conduct your personal research. Taking the time to optimally establish these building blocks will have high payoffs later, when you find yourself in need to go back to your previous analyses. Consider that your most important collaborator is your future self, either of tomorrow or a couple of years from now. To consider all the aspects that comprise a solid ground for any personal project, we devised a framework involving four main sequential steps (Table <a href="#tbl:personal-tools">1</a>).</p>
<div id="tbl:personal-tools" class="tablenos">
<table>
<caption><span>Table 1:</span> Steps to conduct most computational biology projects. </caption>
<tbody>
</tbody>
</table>
</div>
<table>
<thead>
<tr>
<th>
Step
</th>
<th>
Use case
</th>
<th>
Common tools
</th>
</tr>
</thead>
<tbody>
<tr>
<td rowspan="5">
<b>Step 1:</b> Choose your programming languages
</td>
<td rowspan="1">
Interacting with a Unix/Linux HPC
</td>
<td>
• <b>Shell/Bash</b> <span class="citation" data-cites="LOwtrFvP">[<a href="#ref-LOwtrFvP" role="doc-biblioref">15</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Data analysis
</td>
<td>
• <b>Python</b> <span class="citation" data-cites="XST6x2E0">[<a href="#ref-XST6x2E0" role="doc-biblioref">16</a>]</span>, <b>R</b> <span class="citation" data-cites="uUI3eFW7">[<a href="#ref-uUI3eFW7" role="doc-biblioref">17</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Scripts and programs
</td>
<td>
• <i>Interpreted</i>: <b>Python</b> <span class="citation" data-cites="XST6x2E0">[<a href="#ref-XST6x2E0" role="doc-biblioref">16</a>]</span>, <b>R</b> <span class="citation" data-cites="uUI3eFW7">[<a href="#ref-uUI3eFW7" role="doc-biblioref">17</a>]</span>, <b>Perl</b> <span class="citation" data-cites="1Dm6rLdGv">[<a href="#ref-1Dm6rLdGv" role="doc-biblioref">18</a>]</span><br />• <i>Compiled</i>: <b>C/C++</b> <span class="citation" data-cites="FuKo9MoO">[<a href="#ref-FuKo9MoO" role="doc-biblioref">19</a>]</span>, <b>Rust</b> <span class="citation" data-cites="jEGOBKdy">[<a href="#ref-jEGOBKdy" role="doc-biblioref">20</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Workflows
</td>
<td>
• <i>Linux-based</i>: <b>Bash script</b>, <b>GNU Make</b> <span class="citation" data-cites="5iKCi5fm">[<a href="#ref-5iKCi5fm" role="doc-biblioref">21</a>]</span> <br /> • <i>Workflow management systems</i>: <b>Snakemake</b> (Python) <span class="citation" data-cites="1GtwLEEIm">[<a href="#ref-1GtwLEEIm" role="doc-biblioref">22</a>]</span>, <b>Nextflow</b> (Groovy) <span class="citation" data-cites="11OYUtIpR">[<a href="#ref-11OYUtIpR" role="doc-biblioref">23</a>]</span>, <br />• <i>Worflow specifications:</i> <b>CWL</b> <span class="citation" data-cites="hzkdXHo">[<a href="#ref-hzkdXHo" role="doc-biblioref">24</a>]</span>, <b>WDL</b> <span class="citation" data-cites="uPjsd0XZ">[<a href="#ref-uPjsd0XZ" role="doc-biblioref">25</a>]</span>
</td>
</tr>
</tbody>
<tbody>
<tr>
<td rowspan="5">
<b>Step 2:</b> Define your project structure
</td>
<td rowspan="1">
Project structure
</td>
<td>
• <i>Templates</i>: <b>Cookiecutter Data Science</b> <span class="citation" data-cites="j6HfMqoR">[<a href="#ref-j6HfMqoR" role="doc-biblioref">26</a>]</span>, <b>rr-init</b> <span class="citation" data-cites="7D5DgTkH">[<a href="#ref-7D5DgTkH" role="doc-biblioref">27</a>]</span> <br />• <i>Workflows</i>: <b>Snakemake recommendation</b> <span class="citation" data-cites="jq4WP878">[<a href="#ref-jq4WP878" role="doc-biblioref">28</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Virtual environment managers
</td>
<td>
• <i>Language-specific</i>: <b>pipenv</b> (Python) <span class="citation" data-cites="BjGc5Pnm">[<a href="#ref-BjGc5Pnm" role="doc-biblioref">29</a>]</span>, <b>virtualenv</b> (Python) <span class="citation" data-cites="4OxCaUVc">[<a href="#ref-4OxCaUVc" role="doc-biblioref">30</a>]</span>, <b>renv</b> (R) <span class="citation" data-cites="Ga8sduRB">[<a href="#ref-Ga8sduRB" role="doc-biblioref">31</a>]</span><br />• <i>Language agnostic</i>: <b>Conda</b> <span class="citation" data-cites="6ChhcoqP">[<a href="#ref-6ChhcoqP" role="doc-biblioref">32</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Package managers
</td>
<td>
• <i>Language-specific</i>: <b>pip</b> (Python) <span class="citation" data-cites="15ccmJntS">[<a href="#ref-15ccmJntS" role="doc-biblioref">33</a>]</span>, <b>BiocManager</b> (R) <span class="citation" data-cites="78nI2wue">[<a href="#ref-78nI2wue" role="doc-biblioref">34</a>]</span>, <b>R Studio package manager</b> (R) <span class="citation" data-cites="vO2YTdWH">[<a href="#ref-vO2YTdWH" role="doc-biblioref">35</a>]</span><br />• <i>Language-agnostic</i>: <b>Conda</b> <span class="citation" data-cites="6ChhcoqP">[<a href="#ref-6ChhcoqP" role="doc-biblioref">32</a>]</span>
</td>
</tr>
</tbody>
<tbody>
<tr>
<td rowspan="5">
<b>Step 3:</b> Choosing your working set-up
</td>
<td rowspan="1">
Text editors
</td>
<td>
• <i>Desktop applications</i>: <b>Atom</b> <span class="citation" data-cites="HYwZJ66F">[<a href="#ref-HYwZJ66F" role="doc-biblioref">36</a>]</span>, <b>Sublime</b> <span class="citation" data-cites="iD4von7Z">[<a href="#ref-iD4von7Z" role="doc-biblioref">37</a>]</span>, <b>Visual Studio Code</b> <span class="citation" data-cites="llnpg0Du">[<a href="#ref-llnpg0Du" role="doc-biblioref">38</a>]</span>, <b>Notepad++</b> <span class="citation" data-cites="r199dfky">[<a href="#ref-r199dfky" role="doc-biblioref">39</a>]</span><br />• <i>Command line</i>: <b>Vim</b><span class="citation" data-cites="495zSD0M">[<a href="#ref-495zSD0M" role="doc-biblioref">40</a>]</span>, <b>GNU Emacs</b><span class="citation" data-cites="GjC8YrzF">[<a href="#ref-GjC8YrzF" role="doc-biblioref">41</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
IDEs
</td>
<td>
• <i>For Python</i>: <b>JupyterLab</b> <span class="citation" data-cites="1EK7NOavz">[<a href="#ref-1EK7NOavz" role="doc-biblioref">42</a>]</span>, <b>JetBrains/PyCharm</b> <span class="citation" data-cites="G0v2WIik">[<a href="#ref-G0v2WIik" role="doc-biblioref">43</a>]</span>, <b>Spyder</b> <span class="citation" data-cites="sBsTiN8q">[<a href="#ref-sBsTiN8q" role="doc-biblioref">44</a>]</span><br />• <i>For R</i>: <b>R Studio</b> <span class="citation" data-cites="15Xir6Mp8">[<a href="#ref-15Xir6Mp8" role="doc-biblioref">45</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Notebooks
</td>
<td>
• <b>Jupyter</b> (Python, R) <span class="citation" data-cites="1EK7NOavz">[<a href="#ref-1EK7NOavz" role="doc-biblioref">42</a>]</span>, <b>R Markdown</b> (R) <span class="citation" data-cites="DJNUoP3l">[<a href="#ref-DJNUoP3l" role="doc-biblioref">46</a>]</span>
</td>
</tr>
</tbody>
<tbody>
<tr>
<td rowspan="5">
<b>Step 4:</b> Follow good coding practices
</td>
<td rowspan="1">
Coding style
</td>
<td>
• <i>Styling guides:</i> <b>PEP-8</b> (Python) <span class="citation" data-cites="1D76el83m">[<a href="#ref-1D76el83m" role="doc-biblioref">47</a>]</span>, <b>Google</b> (Python, R) <span class="citation" data-cites="4PJ4Kllx">[<a href="#ref-4PJ4Kllx" role="doc-biblioref">48</a>]</span><br />• <i>Linters</i>
</td>
</tr>
<tr>
<td rowspan="1">
Literate programming
</td>
<td>
• <b>Markdown</b> <span class="citation" data-cites="N871n8XH">[<a href="#ref-N871n8XH" role="doc-biblioref">49</a>]</span> <br />• <b>R Markdown</b> <span class="citation" data-cites="DJNUoP3l">[<a href="#ref-DJNUoP3l" role="doc-biblioref">46</a>]</span>
</td>
</tr>
<tr>
<td rowspan="1">
Version control
</td>
<td>
• <i>Version control system:</i> <b>Git</b> <span class="citation" data-cites="XJdnoSwI">[<a href="#ref-XJdnoSwI" role="doc-biblioref">50</a>]</span><br />• <i>Code repositories:</i> <b>GitHub</b> <span class="citation" data-cites="dmEZPbB4">[<a href="#ref-dmEZPbB4" role="doc-biblioref">51</a>]</span>, <b>GitLab</b> <span class="citation" data-cites="16Oz9VFEk">[<a href="#ref-16Oz9VFEk" role="doc-biblioref">52</a>]</span>, <b>Bitbucket</b> <span class="citation" data-cites="1E58VA9bS">[<a href="#ref-1E58VA9bS" role="doc-biblioref">53</a>]</span><br />• <i>Git GUIs:</i> <b>GitHub Desktop</b> <span class="citation" data-cites="1V8gez2v">[<a href="#ref-1V8gez2v" role="doc-biblioref">54</a>]</span>, <b>GitKraken</b> <span class="citation" data-cites="D30wOZ60">[<a href="#ref-D30wOZ60" role="doc-biblioref">55</a>]</span>
</td>
</tr>
</tbody>
</table>
<h3 id="step-1-choose-your-programming-languages">Step 1: Choose your programming languages</h3>
<p>Different programming languages serve distinctive purposes and have different idiosyncrasies. As such, choosing the right programming language for a project depends on your research goals and personal preference or skill set. Additionally, communities usually favor the usage and training of some programming languages over others; utilizing such languages may facilitate integrating your work within the existing ecosystem.</p>
<p>As computational biology becomes a data intensive discipline, interacting with high-performance computing (HPC) has become a hallmark of the field. HPC infrastructures commonly use Unix/Linux distributions as their operating system. To interact with these platforms, you need to use a the command line interpreter known as the “Unix shell”. There are multiple versions of Unix shells, Bash being one of the most widely adopted. Besides providing a user interface, the shell is also a scripting language that allows manipulating files and executing programs through Shell scripts. Unix/Linux operating systems have other interesting perks, such as powerful and fast commands for searching and manipulating files (e.g. <code>sed</code>, <code>grep</code> or <code>join</code>) as well as the language <code>awk</code>, that can perform quick text processing and arithmetic operations.</p>
<p>One of the most common tasks of any computational biologist is data analysis, which usually involves data cleaning, exploration, manipulation, and visualization. Currently, the most widely used programming language for data analysis worldwide is Python <span class="citation" data-cites="lkZcKu7R 1A4rxBI47">[<a href="#ref-lkZcKu7R" role="doc-biblioref">56</a>,<a href="#ref-1A4rxBI47" role="doc-biblioref">57</a>]</span>. Computational biology research has followed this trend making Python one of the most popular languages among researchers, tendency that will likely keep growing as machine learning and deep learning are more widely adopted in biological research. Python usage has been facilitated by the availability of packages for biological data analysis accessible through package managers such as Pip or Conda. Likewise, R is another prominent language in the field. Arguably, one of R main strengths is its wide array of tools for statistical analysis. Of particular interest is the Bioconductor repository, where many gold-standard tools for biological data analysis have been published. R usage in data science has deeply benefited from the Tidyverse packages and surrounding community, increasing the readability of the R syntax for both data manipulation via <code>dplyr</code>, and visualization via <code>ggplot2</code>.</p>
<p>Oftentimes, computational biologists require coding their own sets of instructions for processing data via scripts or programs. A script can be described as lightweight single-file program developed to tackle a narrow purpose. They are likely written in an interpreted programming language instead of a compiled one. Interpreted programming languages execute the program directly, without previous compilation, meaning each statement is run individually. They are quick to edit and can be run interactively, at the expense of computational performance. In computational biology, the current most common multi-purpose scripting languages are Python and R. When working in a HPC environment, Shell/Bash scripting is also widely used. Perl and Matlab are also popular languages among bioinformaticiancs and systems biologists, respectively. A program, on the other hand, is a larger tool that usually combines multiple scripts and works as a “black box” to the user. It is designed to tackle computationally intensive problems; thus, a compiled language is preferred. Several tools designed for high-weight biological data processing have been written in C/C++. In recent years, however, scientists have been turning to Rust because of its speed, safety and active community <span class="citation" data-cites="wu0sr8q2">[<a href="#ref-wu0sr8q2" role="doc-biblioref">58</a>]</span>. If computational performance is less of a concern, Python and R are suitable alternatives as coding programs.</p>
<p>Biological data processing is rarely a one-step process. To go from raw data to useful insights, several steps need to be taken in a specific order, accompanied by a plethora of decisions regarding parameters. Computational biologists have addressed this need by embracing workflow management systems to automate data analysis pipelines. A pipeline can be written as a Shell script where a handful of commands are written one after another, using Shell variables and Shell scripting syntax when needed. Although effective, this approach provides little control over the workflow, and lacks features to run isolated parts of the pipeline or track changes in input and output files. To overcome these limitations, a Bash script can be “upgraded” using the GNU Make program, which was originally designed to automate compilation and installation of software, but that is flexible enough for building other types of workflows also. Nowadays, however, several dedicated bioinformatics workflow managers have been developed. Snakemake is a workflow management system written in Python, allowing to incorporate the syntax of the tool with standard Python code. Similarly, Nextflow was developed as a domain specific language (DSL) for workflow defnition based on Groovy—a programming language for the Java virtual machine. These tools not only provide control over every single step of the pipeline, but also offer features like interacting with job schedulers, software environment managers, and cloud computing support. Alternatively, there are available declarative standards to define workflows in a portable and human-readable manner, such as the Common Workflow Language (CWL) and Workflow Description Language (WDL, pronounced “widdle”). Although these are not executable, they can be run in CWL- or DWL-enabled engines.</p>
<h3 id="step-2-define-your-project-structure">Step 2: Define your project structure</h3>
<p>After choosing your programming languages and before starting any coding, we advise you to come up with a well-thought-out project structure. This design should be intentional and tailored to the present and future needs of your project—remember to be kind to your future self. A computational biology project requires, at the very least, a folder structure that supports code, data, and documentation. Although tempting, cramming all kind of files in a unique folder is unsustainable. Instead, separate each one on different folders and subfolders, if needed. To simplify this process, you can base your project structure on research templates available off-the-rack. For data science projects, the Python package Cookiecutter Data Science cuts down the effort to the very minimum <span class="citation" data-cites="j6HfMqoR">[<a href="#ref-j6HfMqoR" role="doc-biblioref">26</a>]</span>. Running the package prompts a questionnaire in the terminal where you can input the project name, authors, and other basic information. Then, the program generates a folder structure to store data—raw and processed—separated from notebooks and source code, as well as pre-made files for documentation such as a “README”, a docs folder, and a license. Similarly, the Reproducible Research Project Initialization (rr-init) offers a template folder structure that can be cloned from a GitHub repository and modified by the user <span class="citation" data-cites="7D5DgTkH">[<a href="#ref-7D5DgTkH" role="doc-biblioref">27</a>]</span>. Although the latter is slightly simpler, both follow an akin philosophy aimed at research correctness and reproducibility <span class="citation" data-cites="3Gx1ESE4">[<a href="#ref-3Gx1ESE4" role="doc-biblioref">59</a>]</span>. For workflow automation projects, we advice a similar folder structure. Snakemake recommends to store each workflow in a dedicated folder separated into workflow-related files—the Snakefile, rules and scripts—results, and configuration <span class="citation" data-cites="jq4WP878">[<a href="#ref-jq4WP878" role="doc-biblioref">28</a>]</span>. In all cases, the folder must be initialize as a git repo for version control (See <a href="#step-4-follow-good-coding-practices">Step 4</a>).</p>
<p>The software and dependencies needed to execute a workflow or program are also part of the project structure itself. The intricacies of software installation and dependency management are not to be underestimated. Fortunately, package and virtual environment managers significantly reduce this burden. A package manager is a system that automates the installation, upgrading, configuration, and removing of community-developed programs; a virtual environment manager, on the other hand, is a tool that generates isolated “environments” containing programs and dependencies that are functionally independent from other environments or the default operating system. Once a virtual environment is activated, a package manager can be used to install third-party programs.</p>
<p>We believe that every computational biology project must start with its own virtual environment to boost reproducibility: environments save the project’s dependencies and can restore them at will so the code can be run in any other computer. There are multiple options for both package and virtual environment management—some language-specific and some language-agnostic. If you are working with Python, you can initialize a Python environment using virtualenv or pipenv (where different Python versions can be installed). Inside the environment, you can use the Python package manager pip to import Python code from the Python Package Index (PyPI) repository, GitHub, or locally. For the R language, R-specific environments can be created using renv, where packages can be installed via <code>install.packages</code> function from the Comprehensive R Archive Network (CRAN) and CRAN-like repositories. R also has BiocManager to install packages from the Bioconductor repository, which contains relevant software for high-throughput genomic sequencing analysis. Additionally, RStudio developed the RStudio Package Manager which works with third-party code available in CRAN, Bioconductor, GitHub, or locally. A language-agnostic alternative is Conda—an increasingly popular package and a virtual environment manager. It supports program installation from the Anaconda repository, which contains the channel Bioconda specifically tailored to bioinformatics software. If Python is installed, Python dependencies can be installed via pip in a Conda environment as well. Conda is particularly helpful when working with third-party code in all sorts of languages—a common predicament in computational biology. Conda package and environment manager is included in both the Anaconda and Miniconda distributions. The latter is a minimal version of Anaconda, containing only Conda, Python, and a few useful packages.</p>
<h3 id="step-3-choose-your-working-set-up">Step 3: Choose your working set-up</h3>
<p>With the foundation in place, the next step is to start coding. However, a more practical question needs to be answered first: Where to code? The simplest tools available for this purpose are text editors. Since writing code is ultimately writing text, any tool where characters can be typed fulfills this purpose. However, coding can be streamlined by additional features as those found in code editors—text editors especially developed for writing code. Crucial features to facilitate coding include syntax highlight, indentation, and autocompletion. Commonly used desktop editors include Atom, Sublime, Visual Studio Code, and Notepad++ (Windows only), all which offer a myriad of plugins to enhance the coding experience. Command line text editors are also suitable options for coding, with Vim and Emacs being the most powerful ones. All of these tools share the advantage of being language agnostic, which is especially handy for the polyglot computational biologist.</p>
<p>In addition to text editors, integrated development environments (IDEs) are also popular options for coding. At its essence, IDEs are supercharged text editors, i.e. with multiple other features that make writing code easier. The main parts of an IDE are a code editor (with syntax highlight, indentation and suggestions), a debugger, a folder structure, and a way to execute your code (a compiler or interpreter). Most IDEs are not language agnostic, meaning that they only allow to code in one language. The array of features also comes at a cost—IDEs usually use more memory and imply more visual clutter, if that is a concern of yours. For Python, Jupyter Lab, Spyder, and PyCharm are popular options, while for R, RStudio is the gold-standard. Notably, the differences between an IDE and a code editor are somewhat blurry, especially when enough plugins have been added to a code editor.</p>
<p>In the latest years, notebooks have acquired relevance in computational biology research. A notebook is an interactive application that combines live code (read-print-eval loop or REPL), narrative, equations and visualizations. Common notebooks use an interpreted languages such as Python or R, and narrative usually uses Markdown—a lightweight markup language. Data analysis greatly benefits from using notebooks instead of plain text editors or even IDEs: the combination of visuals and texts allows researcher to tell compelling stories about their data, and the interactivity of its code enables quick testing of different strategies. Jupyter notebook is a popular web-based interactive notebook developed originally for Python coding, but that also accepts R and other programming languages upon installation of their kernels—the computing engine that executes the notebook’s live code “under the hood”. Jupyter notebook can also be executed in the cloud using platforms such as Google CoLab and Amazon WebServices, taking advantage of the current trend of cloud computing. RStudio also allows the generation of R-based notebooks known as R Markdown, which is especially well-suited for generating data analysis reports.</p>
<h3 id="step-4-follow-good-coding-practices">Step 4: Follow good coding practices</h3>
<p>After dealing with steps one through three, finally comes writing code. Coding, however, requires good practices to ensure correctness, sustainability, and reproducibility for you, your future self, your collaborators (as we will discuss in <a href="#level-2-collaboration">Level 2</a>) and the whole community (as we will discuss in <a href="#level-3-community">Level 3</a>). First and foremost, you need to make sure your code works correctly. In computational biology, correctness implies biological and statistical soundness. Both are big topics beyond the scope of this manuscript. To achieve the former, however, a useful approach is to design positive and negative controls in your program, analysis or workflow. In scientific experimentation, a positive control is a control group that is expected to produce results; a negative control is expected to produce no results. The same approach can be applied to computation, using input data whose output is previously known. Biological soundness can also be tested by quickly assessing expected orders of magnitude in both, intermediate and final files. All these checks can be packaged in unit testing, of which we will talk about more in <a href="#level-2-collaboration">Level 2</a>.</p>
<p>Beyond the correct functioning of your code, you will need to pay attention to the way your code looks, also know as “coding style”. This includes a series of small and ubiquitous decisions regarding where and how to add comments; indentation and white spaces usage; variable, function and class naming; and overall code organization. It is true that, as in writing, there is a lot of your own personality in the way you code. However, sticking to existing coding style rules facilitates collaboration with your future self and others. Indeed, as we sometimes have trouble reading our own handwriting, we can also struggle reading our own code if we overlook any guidelines. At the very least, your code must display internal consistency. Even better, you can follow any of the multiple coding style guides that have been published. A good place to start is by reading style guides from software development teams. Google, for example, has published guidelines for Python, R, Shell, C++, and HTML/CSS <span class="citation" data-cites="4PJ4Kllx">[<a href="#ref-4PJ4Kllx" role="doc-biblioref">48</a>]</span>. Also, a series of guidelines for the Python programming language have been published as part of the Python Enhancement Proposal (PEP), known as PEP 8 <span class="citation" data-cites="1D76el83m">[<a href="#ref-1D76el83m" role="doc-biblioref">47</a>]</span>. Tools called “linters” can be added to most code editors and IDEs to aid flagging stylistic errors in your code based on a given style guide. Furthermore, many editors and tools facilitate automatic code formatting (e.g. black <span class="citation" data-cites="aUxTEizP">[<a href="#ref-aUxTEizP" role="doc-biblioref">60</a>]</span> that auto-formatsPython code to be PEP 8 compliant), which can greatly facilitate stylistic coherence in a collaborative project.</p>
<p>In the matter of code styling, two topics merit additional attention: variable naming and comments. Variable names should be descriptive enough to convey an idea about the variable, function or class content and use. The goal is to produce “self-documented” code that reads close to plain English. To do so, use multi-words variable names if necessary. In such cases, the most common conventions include Camel Case, where the second and subsequent words are capitalized (<code>camelCase</code>); Pascal Case, where all words are capitalized (<code>PascalCase</code>); and Snake Case, where words are separated by underscores (<code>snake_case</code>). Notably, all these conventions can be used in a same coding style to differentiate variables, functions and classes. For example, PEP-8 recommends Snake Case for functions and variables, and Pascal Case for class names. Importantly, as most modern code editors and IDEs provide autocompletion of variable, function and class names now, it is no longer a valid excuse to use cryptic one character variable names (e.g. x, y, z) to save a few keystrokes.</p>
<p>In addition to mastering variable naming, code comments—explanatory human-readable statements not evaluated by the program—are necessary to enhance the code’s readability. No matter how beautiful and well-organized your code is, high-level code decisions will not be obvious unless stated. As a corollary, code explanations that can be deduced from the syntax itself should be omitted. Comments can span a single line or several ones, forming a block, and can be found in three strategic parts: at the top of the program file (“header comment”), which describes what the code accomplishes and sometimes the code’s author/date; above every function (“function header”), which contains the purpose and behavior of the function; and in line, next to tricky code whose behavior is not obvious or warrants a remark.</p>
<p>Code styling rules also apply to data science notebooks. However, when writing notebooks you must also engage in “literate programming”—a programming paradigm where the code is accompanied by human-readable explanation of its logic and purpose. In other words, notebooks must tell a story about the analysis, connecting the dots between the code, the results and the figures. Human-readable language is often written in Markdown when working in Jupyter, or R Markdown, when working in R. Little has been written about good practices for literate programming, but we advice you to explain the purpose of each chunk of code and provide some interpretation of its results.</p>
<p>When working with a sizable code base, an additional good practice is modular programming—the practice of subdividing a computer program into independent and interchangeable sub-programs, each one tackling a specific functionality. Modularity enhances code readability and reusability, and expedites testing and maintenance (see <a href="#level-2-collaboration">Level 2</a>). In practice, modularity can be implemented at different levels. A single file script, for example, can be modularize using functions, while a program by using different files. In Python, for example, subdivisions are defined as follow: modules are a collection of functions and global variables, packages a collection of modules, libraries a collection of packages, and frameworks a collection of libraries. Modules are simply files with <code>.py</code> extension, while packages are folders than contain several <code>.py</code> files, including one called <code>__init__.py</code>, which can be empty or not, and will allow the Python interpreter to recognize the presence of a package.</p>
<p>Finally, there is version control, one the most important personal practices. Version controls entails the practice of tracking and managing changes in your code using a version control system, such as Git. In Git, a folder needs to be initiated as a Git repository, after which changes to any of the files inside would be tracked. After a change has been made to one or more files, the changed files must be “staged” (using <code>git add</code>) and then “committed” (using <code>git commit</code>). The commit will serve as a screenshot of your project at that time and stage, that you can review or recover later (using <code>git checkout</code>). Additionally, version control allows you to safely try new functionalities in “branches” (using <code>git branch</code> and <code>git checkout</code> )—independent carbon copies of the main original branch (known as “master” or “main”) that you can optionally merge back to the original one. Nowadays, there are multiple hosting services that provide online storage of Git repositories, such as GitHub, GitLab or Bitbucket, that can be navigated using the browser or via a graphic user interfaces (GUI) such as GitHub Desktop or GitKraken. These platforms have the additional benefit of backing up your code in the cloud, keeping your work safe and shareable, which is especially relevant for collaboration, as we will discuss in <a href="#level-2-collaboration">Level 2</a>.</p>
<h2 id="level-2-collaboration">Level 2: Collaboration</h2>
<p>Collaboration is a key aspect of scientific research, but it is especially relevant in computational biology, where interdisciplinary knowledge is often needed. Collaborators can take different forms: your boss or advisor, colleagues or lab mates, other laboratories, people from academia or industry, or your future self (as discussed in <a href="#level-1-personal-research">Level 1</a>). Although collaborators can have a wide range of involvement with your project, here we will consider they all share a direct relationship with you and your research (contrary to a community, which is an open group of a large number of people, as we will discuss in <a href="#level-3-community">Level 3</a>). Each type of collaboration requires its own set of good practices, which we will cover in the next paragraphs.</p>
<h3 id="share-code">2.1 Share code</h3>
<p>Sharing code is one of the most common practices in software development, where large teams work together developing complex functions and scripts. Although computational biology projects are usually not as big, proper ways of sharing code are still essential, as it is not desired to have file conflicts as soon as two different researchers change the same piece of code. Hosting services such as GitHub <span class="citation" data-cites="dmEZPbB4">[<a href="#ref-dmEZPbB4" role="doc-biblioref">51</a>]</span>, GitLab <span class="citation" data-cites="16Oz9VFEk">[<a href="#ref-16Oz9VFEk" role="doc-biblioref">52</a>]</span> and Bitbucket <span class="citation" data-cites="1E58VA9bS">[<a href="#ref-1E58VA9bS" role="doc-biblioref">53</a>]</span> (Table <a href="#tbl:collaboration-tools">2</a>) allow for having a Git repository stored online, by creating a copy of the repository known as the “remote”, which becomes the official version of the repository. The key advantage of using a remote is that there will be no direct interaction between different local copies of the repository, also known as “clones”, but instead each clone will interact with the remote exclusively, updating it only if no conflicts between the two exist. This way, if a collaborator updated the remote repository, other collaborators will not be able to send their changes until they make sure to update their local copy.</p>
<div id="tbl:collaboration-tools" class="tablenos">
<table>
<caption><span>Table 2:</span> Tools for collaborative research. </caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 76%" />
</colgroup>
<thead>
<tr class="header">
<th>Goal</th>
<th>Tools</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Share code</td>
<td>• <em>Hosting services</em>: <strong>GitHub</strong> <span class="citation" data-cites="dmEZPbB4">[<a href="#ref-dmEZPbB4" role="doc-biblioref">51</a>]</span>, <strong>GitLab</strong> <span class="citation" data-cites="16Oz9VFEk">[<a href="#ref-16Oz9VFEk" role="doc-biblioref">52</a>]</span>, <strong>Bitbucket</strong> <span class="citation" data-cites="1E58VA9bS">[<a href="#ref-1E58VA9bS" role="doc-biblioref">53</a>]</span>. <br />• <em>Git branching strategies:</em> <strong>GitHub flow</strong> <span class="citation" data-cites="qjg93S3G">[<a href="#ref-qjg93S3G" role="doc-biblioref">61</a>]</span>.<br />• <em>Tests:</em> correctness (e.g. <strong>pytest</strong> <span class="citation" data-cites="15kUlshEi">[<a href="#ref-15kUlshEi" role="doc-biblioref">62</a>]</span>), coverage (e.g. <strong>codecov</strong> <span class="citation" data-cites="cEpTMlZc">[<a href="#ref-cEpTMlZc" role="doc-biblioref">63</a>]</span>), automation (e.g. <strong>tox</strong> <span class="citation" data-cites="1Bi82XR9D">[<a href="#ref-1Bi82XR9D" role="doc-biblioref">64</a>]</span>, <strong>Travis CI</strong> <span class="citation" data-cites="SM1pqdjN">[<a href="#ref-SM1pqdjN" role="doc-biblioref">65</a>]</span>, <strong>Github Actions</strong> <span class="citation" data-cites="NUXbp429">[<a href="#ref-NUXbp429" role="doc-biblioref">66</a>]</span>).<br />• <em>Code reviews</em>: <strong>Github</strong> <span class="citation" data-cites="RCh2gb01">[<a href="#ref-RCh2gb01" role="doc-biblioref">67</a>]</span>, <strong>Crucible</strong> <span class="citation" data-cites="6woNTKZi">[<a href="#ref-6woNTKZi" role="doc-biblioref">68</a>]</span>, <strong>Upsource</strong> <span class="citation" data-cites="LJc9aT8R">[<a href="#ref-LJc9aT8R" role="doc-biblioref">69</a>]</span>.</td>
</tr>
<tr class="even">
<td>Share data</td>
<td>• <em>FAIR principles</em> <span class="citation" data-cites="6DjakjNS">[<a href="#ref-6DjakjNS" role="doc-biblioref">4</a>]</span>. <br />• <em>Tidy data</em> <span class="citation" data-cites="Gtnr8c2U">[<a href="#ref-Gtnr8c2U" role="doc-biblioref">70</a>]</span>. <br />• <em>Data version control</em> <span class="citation" data-cites="JkrlcwLO">[<a href="#ref-JkrlcwLO" role="doc-biblioref">71</a>]</span>.</td>
</tr>
<tr class="odd">
<td>Share data science notebooks</td>
<td>• <em>Static:</em> <strong>GitHub</strong>, <strong>GitLab</strong>, <strong>NBviewer</strong> <span class="citation" data-cites="8Cn0lgXi">[<a href="#ref-8Cn0lgXi" role="doc-biblioref">72</a>]</span>. <br />• <em>Interactive:</em> <strong>Binder</strong> <span class="citation" data-cites="1dqfprG7">[<a href="#ref-1dqfprG7" role="doc-biblioref">73</a>]</span>, <strong>Google CoLab</strong> <span class="citation" data-cites="mr26BIpF">[<a href="#ref-mr26BIpF" role="doc-biblioref">74</a>]</span>.<br />• <em>Comparative:</em> <strong>ReviewNB</strong> <span class="citation" data-cites="12ovVgVju">[<a href="#ref-12ovVgVju" role="doc-biblioref">75</a>]</span>.</td>
</tr>
<tr class="even">
<td>Share workflows</td>
<td>• <em>General hosting services</em>: <strong>GitHub</strong>, <strong>GitLab</strong>, <strong>Bitbucket</strong><br />• <em>Dedicated workflow repositories:</em> <strong>WorkflowHub</strong> <span class="citation" data-cites="6YE0Zqqy">[<a href="#ref-6YE0Zqqy" role="doc-biblioref">76</a>]</span></td>
</tr>
<tr class="odd">
<td>Share manuscripts</td>
<td>• <em>General-purpose word processors:</em> <strong>Google Docs</strong> <span class="citation" data-cites="18tOsSTai">[<a href="#ref-18tOsSTai" role="doc-biblioref">77</a>]</span>, <strong>Office 365</strong> <span class="citation" data-cites="sP8f9fNq">[<a href="#ref-sP8f9fNq" role="doc-biblioref">78</a>]</span>.<br />• <em>Scholarly word processors:</em> <strong>Authorea</strong> <span class="citation" data-cites="UeFHiqcp">[<a href="#ref-UeFHiqcp" role="doc-biblioref">79</a>]</span>.<br />• <em>Online applications supporting Markup Languages:</em> <strong>Overleaf</strong> (LaTeX) <span class="citation" data-cites="J12A3elW">[<a href="#ref-J12A3elW" role="doc-biblioref">80</a>]</span>, <strong>Manubot</strong> (Markdown + GitHub) <span class="citation" data-cites="petulEc2">[<a href="#ref-petulEc2" role="doc-biblioref">81</a>]</span>.</td>
</tr>
</tbody>
</table>
</div>
<p>To guarantee that different collaborators can work simultaneously in the same repository, a good idea is to implement some type of branching strategy in the repository (Table <a href="#tbl:collaboration-tools">2</a>). In a small team of collaborators, the most common strategy is to have a single <code>main</code> branch and generate from it branches that each different developer can work on. Then, whenever the developer is ready, they can request to combine—or “merge”—the changes from their branch into the main branch, in a process known as “pull request” or PR for short. Once a PR has been opened, collaborators can review it and approve it, so that it can be merged into the main branch, which will now include the branch’s commits as part of its history. This branching strategy is sometimes referred to as GitHub flow <span class="citation" data-cites="qjg93S3G">[<a href="#ref-qjg93S3G" role="doc-biblioref">61</a>]</span> and will suffice for most projects. For more complex branching systems, see <a href="#level-3-community">Level 3</a>.</p>
<p>Using Git hosting services for collaboration has many additional benefits. The commit history not only shows what was done at each point in time, but also which collaborator did it, so that if, for example, a bug was introduced, commands such as <code>git blame</code> will show which collaborator caused it. To ensure hunting down bugs is easy, descriptive commit messages that follow a standard <span class="citation" data-cites="15dXXs6EK VtlfBSxG">[<a href="#ref-15dXXs6EK" role="doc-biblioref">82</a>,<a href="#ref-VtlfBSxG" role="doc-biblioref">83</a>]</span> is recommended. Collaborators can also create “forks”, i.e. full copies of repositories under their own possession. Git hosting services can be accessed interactively online, or from the terminal with tools such as GitHub CLI <span class="citation" data-cites="uRbOUixg">[<a href="#ref-uRbOUixg" role="doc-biblioref">84</a>]</span>. Finally, Git hosting services also allow collaborators to open issues <span class="citation" data-cites="jIIrCDT3">[<a href="#ref-jIIrCDT3" role="doc-biblioref">85</a>]</span> for listing pending to-do’s and/or asking questions, acting as an open forum for development discussions, which has the advantage of remaining accessible for the future (as opposed to closed e-mail discussions). We will consider additional advantages of using Git hosting services, in terms of interacting with a user base, in <a href="#make-your-research-sustainable">Section 3.3</a>.</p>
<p>Another important concept to internalize when developing code, especially together with other collaborators, is to develop unit tests (Table <a href="#tbl:collaboration-tools">2</a>). Unit tests are scripts that will run to determine if specific modules/functions work as intended within the codebase, so that if later the function grows in scope, its proper basic functioning is ensured. For instance, if a function was defined for adding numbers, a simple test would be to asses if the function outputs 13 when the inputs 6 and 7 are provided. Tools such as <code>pytest</code> <span class="citation" data-cites="15kUlshEi">[<a href="#ref-15kUlshEi" role="doc-biblioref">62</a>]</span> for Python and <code>testthat</code> <span class="citation" data-cites="E7mOdOEw">[<a href="#ref-E7mOdOEw" role="doc-biblioref">86</a>]</span> for R exist to then detect said scripts, and run all of them to display if any specific section is failing. It is a very good practice to develop tests at the same time you develop code (at the personal research level), as adding tests <em>a posteriori</em> is significantly harder (although sometimes inevitable). It is even better practice to test every single step of the code (from data loading to figure plotting), a concept known in software development as end-to-end testing <span class="citation" data-cites="GYac9tBn">[<a href="#ref-GYac9tBn" role="doc-biblioref">87</a>]</span>.</p>
<p>Going beyond testing correctness, tools such as <code>flake8</code> <span class="citation" data-cites="ZNYSO1m0">[<a href="#ref-ZNYSO1m0" role="doc-biblioref">88</a>]</span> will test styling preferences (for complying with PEP8), <code>safety</code> <span class="citation" data-cites="iFiB8Hir">[<a href="#ref-iFiB8Hir" role="doc-biblioref">89</a>]</span> will test for vulnerabilities among the software’s dependencies, and Codecov <span class="citation" data-cites="cEpTMlZc">[<a href="#ref-cEpTMlZc" role="doc-biblioref">63</a>]</span> will test coverage, or the percentage of the codebase tested (as a rule of thumb for the latter, the more lines of code are tested, the more reliable the software will be). All these different types of tests can be funneled into a single testing pipeline that can run automatically whenever desired. This process is known as Continuous Integration (CI), and can be tuned to run locally whenever commits are made, or online whenever a pull request is opened and/or merged. When running locally, an environment manager / command line tool such as <code>tox</code> <span class="citation" data-cites="1Bi82XR9D">[<a href="#ref-1Bi82XR9D" role="doc-biblioref">64</a>]</span> helps to ensure all tests are executed under different python versions. For setting up the CI cycle online, different CI tools such as Travis CI <span class="citation" data-cites="SM1pqdjN">[<a href="#ref-SM1pqdjN" role="doc-biblioref">65</a>]</span> or Circle CI <span class="citation" data-cites="T03Api6e">[<a href="#ref-T03Api6e" role="doc-biblioref">90</a>]</span> exist, and more recently GitHub actions <span class="citation" data-cites="NUXbp429">[<a href="#ref-NUXbp429" role="doc-biblioref">66</a>]</span> has been introduced for running the integration directly from GitHub.</p>
<p>Having tests is a great way of ensuring our code fulfills a certain level of correctness and styling. However, it is no replacement for a human assessment to determine if the code is correct, necessary, and useful. Therefore, code reviewing is essential whenever developing code in collaboration (Table <a href="#tbl:collaboration-tools">2</a>). Tools such as Crucible <span class="citation" data-cites="6woNTKZi">[<a href="#ref-6woNTKZi" role="doc-biblioref">68</a>]</span> and Upsource <span class="citation" data-cites="LJc9aT8R">[<a href="#ref-LJc9aT8R" role="doc-biblioref">69</a>]</span> exist for making in-line reviews of each file, but the most common approach is to directly review using the online review tools from the hosting service. In the case of GitHub <span class="citation" data-cites="RCh2gb01">[<a href="#ref-RCh2gb01" role="doc-biblioref">67</a>]</span>, this not only allows the reviewer to open a comment in any line of the code (which creates a thread for the original author to reply), but also to suggest changes that can be approved or dismissed. When reviewing, there are a series of things to look for (from functionality to documentation), and good practices to keep in mind (such as phrasing the comments in a constructive way), which are outside of the scope of this review but presented in detail elsewhere <span class="citation" data-cites="FTO2RnTd HnmFW2rl">[<a href="#ref-FTO2RnTd" role="doc-biblioref">91</a>,<a href="#ref-HnmFW2rl" role="doc-biblioref">92</a>]</span>.</p>
<h3 id="share-data">2.2 Share data</h3>
<p>The practices of sharing data stem from the same place as with sharing code: we should store our dataset and any changes to it in a repository, and ensure it complies with standards by testing its quality. However, due to data having a more consistent structure than code, as they are often processed and outputted by machines in standard formats, there are additional criteria that should be considered when we share it with collaborators (and later on with the community). The main set of guidelines that represent these criteria were outlined a few years ago in what is known as the FAIR principles <span class="citation" data-cites="6DjakjNS">[<a href="#ref-6DjakjNS" role="doc-biblioref">4</a>]</span>: data should be Findable, i.e. easy to find online; Accessible, i.e. easy to access once found; Interoperable, i.e. easy to integrate with other data/applications/workflows/etc.; and Reusable, i.e. presented in a way that allows for others to use it for the same purpose or different settings. For assessing if data is or not FAIR, tools like FAIRshake <span class="citation" data-cites="19KAPSMqo">[<a href="#ref-19KAPSMqo" role="doc-biblioref">93</a>]</span> can be used to determine what is missing.</p>
<p>For making data findable, research repositories such as Zenodo <span class="citation" data-cites="Z6ni32OG">[<a href="#ref-Z6ni32OG" role="doc-biblioref">94</a>]</span> and Figshare <span class="citation" data-cites="1EMndz0j9">[<a href="#ref-1EMndz0j9" role="doc-biblioref">95</a>]</span> allow you to assign a digital object identifier (DOI) to any group of files you upload, including data and/or code. Alternatively, regular code repositories like GitHub can be used instead, as you can employ commits and/or releases to identify specific versions of the data (see <a href="#make-your-research-accessible">Section 3.1</a>), in combination with extensions for Large File Storage such as git LFS <span class="citation" data-cites="11GtZ7icJ">[<a href="#ref-11GtZ7icJ" role="doc-biblioref">96</a>]</span>, in the case of data files larger than 100 MB <span class="citation" data-cites="varWEBV8">[<a href="#ref-varWEBV8" role="doc-biblioref">97</a>]</span>. A final alternative is the Data Version Control (DVC) initiative <span class="citation" data-cites="JkrlcwLO">[<a href="#ref-JkrlcwLO" role="doc-biblioref">71</a>]</span>, which is especially useful when doing machine learning, as it can keep track of data, machine learning models, and even scoring metrics.</p>
<p>For making data accessible, we encourage as much as possible to make your repositories open access, but in cases in which you or your collaborators prefer some restrictions, you can create guest accounts to provide access to private repositories. For making data interoperable, distinctions between raw and clean data have been made <span class="citation" data-cites="3Gx1ESE4">[<a href="#ref-3Gx1ESE4" role="doc-biblioref">59</a>]</span>, with raw data being the files that came out of the measuring device, and clean data the files that are ready to be used for any computational analysis. An important characteristic that clean data should have is to be “tidy”, which is reviewed in detail elsewhere <span class="citation" data-cites="Gtnr8c2U">[<a href="#ref-Gtnr8c2U" role="doc-biblioref">70</a>]</span>. Finally, for making data reusable, thorough documentation of the data is required, including experimental design, measurement units and sources of error.</p>
<h3 id="share-data-science-notebooks">2.3 Share data science notebooks</h3>
<p>As we previously discussed, Jupyter Notebook have become a fundamental tool of data analysis. Notebooks can be shared with collaborators using either static or interactive options. The former, as the name indicates, shares computational notebooks as a rendered text, written internally in HTML. Static notebooks are a good option when you want to avoid any modifications and can work as an archive of past analyses, but interacting with its content is cumbersome—the file must be downloaded and run in a local Jupyter installation. Git-based code repositories, such as GitHub and GitLab, automatically render notebooks that can be later shared using the GitHub repository URL. To facilitate this process, the Project Jupyter provides a web application called NBviewer, where you can paste a Jupyter Notebook’s URL, publicly hosted in GitHub or elsewhere, and renders the file into a static HTML web page with a stable link.</p>
<p>Interactive notebooks, in the other hand, not only render the file but also allow collaborators to fully interact with it, tinkering parameters or trying new input data—no installation required. The Binder Projects (which is also part of the Project Jupyter) offers the Binder service, where any publicly hosted Git-based repository can be open with a Jupyter Notebook interface. The user can fully interact with any notebook within the repository, although changes will not be saved to the original file. The platforms supports Python and R among other languages, and any additional packages required to run the analysis need to be specified in a configuration file within the repository. Similarly, Jupyter Notebooks can be run interactively using Google CoLaboratory (CoLab), which is available to anyone with a Google account. Notebooks can be updated locally, from any public GitHub repository, or from Google Drive. In both cases, the machines provided by these services are comparable to a modern laptop, hence these tools may not be suitable for computing-intensive tasks.</p>
<p>Sometimes computational biologists need to work and edit a notebook together. In those cases, notebooks need to be treated as any other piece of code: updates from different collaborators must be managed with version control in a platform such as GitHub. The problem, however, is that Git-based hosting services deal with notebooks as if they were HTML text, where changes between versions are hard to visualize. To better compare these changes, there is NBreview, which renders and display in parallel the old and new versions of a notebook for easy comparison. The tool can be easily installed using your GitHub account.</p>
<h3 id="share-computational-workflows">2.4 Share computational workflows</h3>
<p>Computational biology projects often demands using multi-step analyses with dozens of third-party software and dependencies. Although these steps can be shared as documentation, complex workflows are better shared as stand-alone code that can be easily run with minimal file manipulation from collaborators. Doing so can safeguard the reproducibility and replicability of the analysis, leading to better science and less issues down the road.</p>
<p>The simplest way to share a pipeline is to generate a Bash script that receives input files from the command line, thus, allowing to run it with different input data. However, Bash scripts offer little control over the overall workflow and cannot re-run specific parts of the pipeline. To address these issues, pipelines are better shared using a workflow automation system. Theoretically, all the instructions regarding the workflow could be written in the main pipeline file—in Snakemake, the <code>.smk</code> file (or Snakefile); in Nextflow, te <code>.nf</code> file; in CWL, <code>.cwl</code> file; and in WDL, <code>.wdl</code>. However, to ensure reproducibility, it is a good practice to share complete pipelines, meaning folder structures, additional files and software specification, as well all custom scripts developed for the analysis. These files can be shared using the same tools as other forms of code, namely GitHub or any other Git hosting services. Alternatively, they can be uploaded to hosting services specialized in workflows, like WorkflowHub <span class="citation" data-cites="6YE0Zqqy">[<a href="#ref-6YE0Zqqy" role="doc-biblioref">76</a>]</span>, currently in beta.</p>
<p>When sharing workflows, consider that sharing software versioning is necessary for your collaborators to reproduce your pipeline using their own computing setup. Conda environments, for example, can be easily created from an environment file (in YAML language), which can be exported from an existing environment. Notably, Snakemake and Nexflow can be configured to automatically build isolated environments for each rule or step, enabling running different versions of a program within the same pipeline (which is especially helpful when needing both Python 2 and 3 in the same pipeline, for example). Besides sharing the specifications of an environment, it is possible to share the environment itself via containers, using platforms like Docker and Singularity as we will discuss in <a href="#level-3-community">Level 3</a>.</p>
<h3 id="write-manuscripts-collaboratively">2.5 Write manuscripts collaboratively</h3>
<p>Writing articles is the main way we share our research with the scientific community at large. However, in a highly interdisciplinary field as computational biology, writing manuscripts is also a collaborative effort. The traditional computer tools for writing documents are not suitable for this type of collaboration, resulting in files with different names, jumping from one e-mail inbox to another, and multiple and even contradictory final versions. Let’s avoid this by streamlining collaborative manuscript writing with tools made for that purpose.</p>
<p>Big companies have become aware of the need for collaborative writing, developing online applications that can be simultaneously edited by multiple people. Google’s Docs and Microsoft’s Office 365 are well-known word processors designed for this purpose, where the text is displayed with the exact appearance than in a printout (know as <em>What-You-See-Is-What-You-Get</em> , or WYSIWYG) and the text can be formatted making use of the internal features of the application. The advantage of these technologies is that they are extremely user-friendly and require no additional knowledge. They are a good option when one or more of your collaborators seeks simplicity, but they are not specifically tailored for the needs of scientific writing, such as adding references, equations and figures. Fortunately, third-party companies such as Paperpile and Zotero have developed plugins for these applications to add references to your document. Companies like Authorea, on the other hand, have developed their own online application specifically designed for writing manuscripts. Authorea, in particular, offers templates for different types of research projects and allows you to easily add references using identifiers (DOI, PubMed, etc.). Consider, nonetheless, that some collaborators may not want to adopt a new tool exclusively for writing manuscripts.</p>
<p>In addition to word processors, text editors are a competitive option to write manuscripts when combined with a markup language—a human-readable computer language that uses tags to delineate formatting elements in a document that will be later rendered. Since the formatting process is internally handled by the application, styling elements (headers, text formatting, equations) can be easily written in text, even achieving greater consistency than word processors. Disciplines closely related to computational biology, such as statistics and mathematics, have historically used the markup language LaTeX for writing articles. This language has a specific syntax to write mathematics constructs as simple text, making it a sound choice for papers with lots of equations. To aid collaborative writing, platforms like Overleaf provide online LaTeX editors, supporting features like real-time editing. In addition to LaTeX, an emerging trend in collaborative writing is to use the lightweight markup language Markdown within the GitHub infrastructure. The software Manubot provides a set of functionalities to write scholarly articles within a GitHub repository, leveraging all the advantages of Git version control and the GitHub hosting platform <span class="citation" data-cites="YuJbg3zO">[<a href="#ref-YuJbg3zO" role="doc-biblioref">98</a>]</span>. For example, it provides cloud storage, version control, and facilitates the maintainers’ work by managing updates via pull requests. The GitHub user interface also allows off-line discussions about the manuscript using issues" and task assignment (See level 3 for tips on project management). Manubot, in particular, accepts citations using manuscripts identifiers and automatically renders the article in PDF and HTML formats. As a drawback, it requires technical expertise in Git and familiarity with GitHub; as an upside, its reliable infrastructure scales well to large and open collaborative projects. The document you are reading now was fully written using Manubot!</p>
<h2 id="level-3-community">Level 3: Community</h2>
<p>The third and final step of this journey is when you want to present your research to the community. This can already be done shortly after the start of your project, or towards the end, when you are close to publish your results. Either way, the main goal when doing it should be to develop and maintain an open and reproducible computational biology project, that can sustain community engagement over time. Here, we will distinguish 3 sub-goals: Make your research (1) accessible, (2) reproducible and (3) sustainable. The latter is especially relevant when part of the research involves developing code that will be used by others in the future (e.g. a tool or workflow), but we believe that many of those ideas are still relevant to any computational biology project as well.</p>
<h3 id="make-your-research-accessible">3.1. Make your research accessible</h3>
<p>Making your research accessible is the first step towards open research. This include ensuring that anyone (inside or outside of academia) can access your research, and that it stays available long after your paper is published. It is extremely frustrating for any researcher to look for software or a set of scripts from a paper published a few years ago, only to find a “404 error” where the code used to be provided. Equally frustrating is whenever authors offer code as “available on request”; this often leads to an email from the supervisor of the project explaining that the developer of the code left years ago and the code is not available anymore.</p>
<p>There are three main ways in which people publish accompanying code to publications: As supplementary material in the publication it was used, via privately-owned domains, or via public repositories. The first option (publishing the code as supplementary material) has low accessibility if the paper is not open access, as only members of institutions that pay the journal membership will be able to access it. Moreover, it is completely static and cannot ever be updated if a new feature wants to be introduced, or a bug is found. The second option (privately-owned domains) lacks sustainability, as it requires certain maintenance, and either the domain can expire or the website might migrate somewhere else. Therefore, here we argue for the third option (public repositories) because of its accessibility and sustainability over time, as owners can update the code (if necessary) in a git-compliant way, and they don’t need to rely on maintaining a domain and/or servers by themselves. As mentioned before (see <a href="#level-2-collaboration">Level 2: Collaboration</a>), there are several hosting services for this purpose <span class="citation" data-cites="dmEZPbB4 16Oz9VFEk 1E58VA9bS">[<a href="#ref-dmEZPbB4" role="doc-biblioref">51</a>,<a href="#ref-16Oz9VFEk" role="doc-biblioref">52</a>,<a href="#ref-1E58VA9bS" role="doc-biblioref">53</a>]</span> (Table <a href="#tbl:community-tools-1">3</a>), all equally valid depending on where people in your specific field usually publish their tools. Here, several repository-specific tools will be exemplified with GitHub.</p>
<div id="tbl:community-tools-1" class="tablenos">
<table>
<caption><span>Table 3:</span> Tools for making your research accessible. </caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 35%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th>Goal</th>
<th>Tool options</th>
<th>Additional remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Publish your code</td>
<td>• <strong>GitHub</strong> <span class="citation" data-cites="dmEZPbB4">[<a href="#ref-dmEZPbB4" role="doc-biblioref">51</a>]</span><br/>• <strong>GitLab</strong> <span class="citation" data-cites="16Oz9VFEk">[<a href="#ref-16Oz9VFEk" role="doc-biblioref">52</a>]</span><br/>• <strong>Bitbucket</strong> <span class="citation" data-cites="1E58VA9bS">[<a href="#ref-1E58VA9bS" role="doc-biblioref">53</a>]</span></td>
<td>All three options allow you to host your repository online for free. Choose whichever is more common in your own field.</td>
</tr>
<tr class="even">
<td>Introduce your code</td>
<td>• <strong>README file</strong> <span class="citation" data-cites="16wWVekW1">[<a href="#ref-16wWVekW1" role="doc-biblioref">99</a>]</span>: First file that shows up in a repository. <br/>• <strong>Github Pages</strong> <span class="citation" data-cites="nR2NTYy9">[<a href="#ref-nR2NTYy9" role="doc-biblioref">100</a>]</span>: Separate website.</td>
<td>Provide a landing page to any repository with a short overview of the code (installation, usage, acknowledgments, etc).</td>
</tr>
<tr class="odd">
<td>Share your code</td>
<td>• Several licensing options <span class="citation" data-cites="Lbp8MQSL">[<a href="#ref-Lbp8MQSL" role="doc-biblioref">101</a>]</span>.</td>
<td>Indicate with a license file what restrictions apply when using your code. If you don’t include this, you will loose many users.</td>
</tr>
<tr class="even">
<td>Archive your code</td>
<td>• <strong>Github Releases</strong> <span class="citation" data-cites="146GfpGTF">[<a href="#ref-146GfpGTF" role="doc-biblioref">102</a>]</span><br/>• <strong>Zenodo</strong> <span class="citation" data-cites="Z6ni32OG">[<a href="#ref-Z6ni32OG" role="doc-biblioref">94</a>]</span>: Provides DOI.<br/>• <strong>figshare</strong> <span class="citation" data-cites="1EMndz0j9">[<a href="#ref-1EMndz0j9" role="doc-biblioref">95</a>]</span>: Provides DOI.</td>
<td>Share progressive stable versions of your code as you develop it. Use <strong>semantic versioning</strong> <span class="citation" data-cites="13UfgtMhu">[<a href="#ref-13UfgtMhu" role="doc-biblioref">103</a>]</span> for assigning standard identifiers to your releases.</td>
</tr>
<tr class="odd">
<td>Publish a tool</td>
<td>• <strong>PyPI</strong> <span class="citation" data-cites="Mduzvxei">[<a href="#ref-Mduzvxei" role="doc-biblioref">104</a>]</span>: Python.<br/>• <strong>CRAN</strong> <span class="citation" data-cites="rWFDdwIs">[<a href="#ref-rWFDdwIs" role="doc-biblioref">105</a>]</span>: R.<br/>• <strong>Bioconductor</strong> <span class="citation" data-cites="10CJ2sJo8">[<a href="#ref-10CJ2sJo8" role="doc-biblioref">106</a>]</span>: R.<br/>• <strong>Bioconda</strong> <span class="citation" data-cites="AvIrTFAn">[<a href="#ref-AvIrTFAn" role="doc-biblioref">107</a>]</span>: Language-agnostic.</td>
<td>Produce a package easy to install and use. Especially useful if you think you could have a userbase that will run the same analysis as you on other datasets and/or conditions.</td>
</tr>
<tr class="even">
<td>Publish an interactive web app</td>
<td>• <strong>Dash</strong> <span class="citation" data-cites="dk80YsaO">[<a href="#ref-dk80YsaO" role="doc-biblioref">108</a>]</span>: Python.<br/>• <strong>R-Shiny</strong> <span class="citation" data-cites="B0TdOflx">[<a href="#ref-B0TdOflx" role="doc-biblioref">109</a>]</span>: R.</td>
<td>Provide easy and interactive data exploration to your users. Especially useful if you have large datasets that can be explored in different ways.</td>
</tr>
</tbody>
</table>
</div>
<p>When publishing any piece of code online, there are two files that are fundamental to include: A readme file and a license. Including a readme file <span class="citation" data-cites="16wWVekW1">[<a href="#ref-16wWVekW1" role="doc-biblioref">99</a>]</span> is about welcoming your users, and introducing them to your code (Table <a href="#tbl:community-tools-1">3</a>): it should include a description about its main intended use, an overview of the installation, the most common commands, a way to contact the developers if problems arise (see <a href="#make-your-research-sustainable">3.3. Make your research sustainable</a> for more details on this), and acknowledgments (if appropriate). We recommend to keep it short: You can include all the details in the documentation of the tool, here we only need a quick overview. The readme file, which can be written in different markup languages such as Markdown <span class="citation" data-cites="LSHekw4z">[<a href="#ref-LSHekw4z" role="doc-biblioref">110</a>]</span> or reStructuredText <span class="citation" data-cites="RPjXsSC8">[<a href="#ref-RPjXsSC8" role="doc-biblioref">111</a>]</span>, will render automatically on the repository’s landing page, below the repository file structure. For improved clarity, you may consider creating a separate landing page: it will unclutter the website’s look by only showing the information of the readme file. All hosting services offer simple ways to do this; in the case of GitHub, you can use GitHub pages <span class="citation" data-cites="nR2NTYy9">[<a href="#ref-nR2NTYy9" role="doc-biblioref">100</a>]</span>.</p>
<p>Adding a license to a repository is also a crucial step (Table <a href="#tbl:community-tools-1">3</a>). Licenses indicate how the code can be used: Is it free to use for any application? Can users modify the code as they please? Does it come with a warranty that it will work? Can it be used for profit? If a license is not provided, many researchers will choose not to use the code at all, as they won’t have an answer to these questions. For instance, academic users will not know if they are entitled to modify the code for their own research, and users from the industry will not know if the code can be used for profit. Many options exist for licensing code <span class="citation" data-cites="Lbp8MQSL">[<a href="#ref-Lbp8MQSL" role="doc-biblioref">101</a>]</span>, from permissive licenses that allow any kind of use with few or no conditions, like the Unlicense and MIT licenses, to more restrictive licenses that enforce disclosing the source and even requiring that any adaptation of the code uses the same license, like the GNU licenses. Our suggestion is to choose whatever suits your research group best; consider that, as a rule of thumb, the more requirements you add, the less potential users you will have, but the more credit you will receive when users utilize your code for their own needs.</p>
<p>Working as a computational biologist, you will probably continue lines of work from scripts or software you have already published. For instance, you could improve the performance of a given function or add a new set of features entirely. Therefore, you should not only be interested in making your code accessible, but also in having different versions available. To keep different versions of your code organized as you develop it, it is important to create and archive succeeding releases of your code (Table <a href="#tbl:community-tools-1">3</a>). A good way to do this is with GitHub releases <span class="citation" data-cites="146GfpGTF">[<a href="#ref-146GfpGTF" role="doc-biblioref">102</a>]</span>, which requires minimal effort and shows all versions you have created of your code. An even better way to do this is with research repositories like Zenodo <span class="citation" data-cites="Z6ni32OG">[<a href="#ref-Z6ni32OG" role="doc-biblioref">94</a>]</span> or Figshare <span class="citation" data-cites="1EMndz0j9">[<a href="#ref-1EMndz0j9" role="doc-biblioref">95</a>]</span>, which not only store your code and data, but also give you a digital object identifier (DOI) for each version, making them citable. This is especially useful when the publication is not available yet, or enough time has passed so that the current version of the code differs widely from what was published. These repositories can even be combined with code repositories, e.g. GitHub has a Zenodo integration that will trigger a new archived version every time a new release is made from GitHub. Regardless of the solution chosen, we recommend keeping some logical order to the releases, using a standard such as semantic versioning <span class="citation" data-cites="13UfgtMhu">[<a href="#ref-13UfgtMhu" role="doc-biblioref">103</a>]</span>.</p>
<p>In most cases, it is probably enough to provide your code as an organized set of scripts and/or notebooks, for anyone to consult if they wish to reproduce and/or re-utilize it. However, if you believe that your code would be partly or entirely used in a routine-fashion by other researchers, for instance for studying other organisms or other experimental conditions, you could consider packaging your code as a tool (Table <a href="#tbl:community-tools-1">3</a>). If you take this route, aim for using one of the main options for publishing tools as packages: Bioconda <span class="citation" data-cites="AvIrTFAn">[<a href="#ref-AvIrTFAn" role="doc-biblioref">107</a>]</span> is a catch-all solution, but language-specific options also exist, such as PyPI <span class="citation" data-cites="Mduzvxei">[<a href="#ref-Mduzvxei" role="doc-biblioref">104</a>]</span> if you work in Python, or CRAN <span class="citation" data-cites="rWFDdwIs">[<a href="#ref-rWFDdwIs" role="doc-biblioref">105</a>]</span> and Bioconductor <span class="citation" data-cites="10CJ2sJo8">[<a href="#ref-10CJ2sJo8" role="doc-biblioref">106</a>]</span> if you work in R. All of these options will allow you to reach a bigger audience, as packages can be easily searched and installed locally with minimal effort.</p>
<p>Another common situation in research projects is having data that can be analyzed in many ways. As producing plots that display the data in every conceivable way is unreasonable, a good solution here is to develop an interactive web app (Table <a href="#tbl:community-tools-1">3</a>), also referred to as a data dashboard, that lets users interact with the data, by showing different sets of variables or changing parameter settings (e.g. the significance of a statistical test). Common options for this goal are Dash <span class="citation" data-cites="dk80YsaO">[<a href="#ref-dk80YsaO" role="doc-biblioref">108</a>]</span> for Python and R Shiny <span class="citation" data-cites="B0TdOflx">[<a href="#ref-B0TdOflx" role="doc-biblioref">109</a>]</span> for R.</p>
<h3 id="make-your-research-reproducible">3.2. Make your research reproducible</h3>
<p>Having your code/data accessible to anyone is only the first step when sharing software with the research community; you also need to make your research reproducible by anyone. We have already discussed the importance of reproducibility in science when working in a personal project (see <a href="#level-1-personal-research">Level 1</a>); however, when sharing your results with the academic community, this becomes even more paramount, as anyone should be able to execute your code and obtain the same results. This is especially relevant in science, as there is a constant number of people that are new to the field (including undergraduates, postgraduates and senior researchers), many who come from very different backgrounds to try to understand how your code, developed for your own specific niche research area, works.</p>
<p>A cornerstone for reproducibility is to have a solid documentation: by explaining what your code does, users can understand the intended use of each function, which will guide them on how to achieve your same results. We can distinguish 4 different levels of documentation <span class="citation" data-cites="woYMAGdl">[<a href="#ref-woYMAGdl" role="doc-biblioref">112</a>]</span>:</p>
<ul>
<li><em>Tutorials:</em> A group of lessons that teach the reader how to become a user of your code.</li>
<li><em>How-to guides:</em> A set of documents that clarify to a user how to solve common problems/tasks.</li>
<li><em>Explanations:</em> Discussions that clarify particular topics related to your code.</li>
<li><em>References:</em> Technical descriptions of your code’s variables/classes/functions.</li>
</ul>
<p>The extent of documentation you write will depend on how many users you expect to have, and conversely will affect how many users you attract. If you foresee that your code has little usability outside of your research, perhaps a solid documentation of each function using docstrings <span class="citation" data-cites="IsDZd09v">[<a href="#ref-IsDZd09v" role="doc-biblioref">113</a>]</span> could be enough. However, you might also want to add a tutorial for a beginner, a couple of how-to guides for frequently used routines, and even some explanations for clarifying the science behind your code. The latter has the added bonus that it can be re-used for the eventual manuscript of your publication. If you are not sure how many users you might get, air on the side of caution and prepare good documentation anyways: you will be surprised to see how often other researchers contact you for reproducing your results and/or using your code for other applications! Finally, to publish comprehensive documentation online, consider using (1) a standard documentation language such as reStructuredText <span class="citation" data-cites="RPjXsSC8">[<a href="#ref-RPjXsSC8" role="doc-biblioref">111</a>]</span> or Markdown <span class="citation" data-cites="LSHekw4z">[<a href="#ref-LSHekw4z" role="doc-biblioref">110</a>]</span>, and (2) a documentation platform such as Readthedocs <span class="citation" data-cites="9HZXe8sx">[<a href="#ref-9HZXe8sx" role="doc-biblioref">114</a>]</span>, Gitbook <span class="citation" data-cites="VjDIpAqq">[<a href="#ref-VjDIpAqq" role="doc-biblioref">115</a>]</span> or Bookdown <span class="citation" data-cites="FMzJsf3g">[<a href="#ref-FMzJsf3g" role="doc-biblioref">116</a>]</span> (Table <a href="#tbl:community-tools-2">4</a>).</p>
<div id="tbl:community-tools-2" class="tablenos">
<table>
<caption><span>Table 4:</span> Tools for making your research reproducible. </caption>
<colgroup>
<col style="width: 18%" />
<col style="width: 43%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="header">
<th>Goal</th>
<th>Tool options</th>
<th>Additional remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Document your code</td>
<td>• <strong>Readthedocs</strong> <span class="citation" data-cites="9HZXe8sx">[<a href="#ref-9HZXe8sx" role="doc-biblioref">114</a>]</span>: Uses <strong>reStructuredText</strong> <span class="citation" data-cites="RPjXsSC8">[<a href="#ref-RPjXsSC8" role="doc-biblioref">111</a>]</span>.<br/>• <strong>Gitbook</strong> <span class="citation" data-cites="VjDIpAqq">[<a href="#ref-VjDIpAqq" role="doc-biblioref">115</a>]</span>: Uses <strong>Markdown</strong> <span class="citation" data-cites="LSHekw4z">[<a href="#ref-LSHekw4z" role="doc-biblioref">110</a>]</span>.<br />• <strong>Bookdown</strong> <span class="citation" data-cites="FMzJsf3g">[<a href="#ref-FMzJsf3g" role="doc-biblioref">116</a>]</span>: Uses <strong>R Markdown</strong> <span class="citation" data-cites="DJNUoP3l">[<a href="#ref-DJNUoP3l" role="doc-biblioref">46</a>]</span>.</td>
<td>Comprehensive documentation: from tutorials and how-to guides all the way down to function documentation based on all compiled <strong>docstrings</strong> <span class="citation" data-cites="IsDZd09v">[<a href="#ref-IsDZd09v" role="doc-biblioref">113</a>]</span>.</td>
</tr>
<tr class="even">
<td>Reproducible environments</td>
<td>• <strong>Virtual environment managers</strong>: See Table 1.<br/>• <strong>pip-tools</strong> <span class="citation" data-cites="dvOzCOyW">[<a href="#ref-dvOzCOyW" role="doc-biblioref">117</a>]</span>: Administer several environments in a single project.</td>
<td>As a recommendation, try having the minimum number of dependencies needed to reproduce your results.</td>
</tr>
<tr class="odd">
<td>Reproducible software</td>
<td>• <strong>Docker</strong> <span class="citation" data-cites="rmvJ2O0Q">[<a href="#ref-rmvJ2O0Q" role="doc-biblioref">118</a>]</span><br/>• <strong>Singularity</strong> <span class="citation" data-cites="99QkJBoF">[<a href="#ref-99QkJBoF" role="doc-biblioref">119</a>]</span></td>
<td>Package your research as a container ready to run in any computer.</td>
</tr>
<tr class="even">
<td>Reproducible commands</td>
<td>• <strong>Make</strong> <span class="citation" data-cites="5iKCi5fm">[<a href="#ref-5iKCi5fm" role="doc-biblioref">21</a>]</span></td>
<td>Build a program by following a series of steps in a single Makefile.</td>
</tr>
<tr class="odd">
<td>Reproducible workflows</td>
<td>• <strong>Workflow management systems</strong>: See Table 1.</td>
<td>Run a pipeline of commands on NGS data in a reproducible way.</td>
</tr>
<tr class="even">
<td>Reproducible notebooks</td>
<td>• <strong>Interactive notebooks</strong>: See Table 2.</td>
<td>Make your notebooks interactive and reproducible.</td>
</tr>
</tbody>
</table>
</div>
<p>A key aspect of code reproducibility is to share dependencies along with the code itself. As we discuss in Level 1, virtual environment managers handle dependency tracking and facilitate software installation for users. For Python, a tool worth using when defining environments is pip-tools <span class="citation" data-cites="dvOzCOyW">[<a href="#ref-dvOzCOyW" role="doc-biblioref">117</a>]</span>, which allows to define different environments for a single project, depending on who accesses the project. For instance, you might want users to use a wider number of dependencies for increased flexibility, but the CI tool to only have a minimal number of dependencies for improved efficiency.</p>
<p>Beyond dependency trackers, you might also want to ensure your tool behaves in the same way across computing environments, even between two different operative systems (e.g. Mac and Windows). The best solution for this is to use a container (Table <a href="#tbl:community-tools-2">4</a>), which is a standardized unit of software that runs using an isolated filesystem known as a container image. This image contains not only the needed dependencies, but also any configurations, binary files, environmental variables, etc., that the software needs for running, and can be built from a text file with all the instructions. The two main tools available for creating containers for free are Docker <span class="citation" data-cites="rmvJ2O0Q">[<a href="#ref-rmvJ2O0Q" role="doc-biblioref">118</a>]</span> and Singularity <span class="citation" data-cites="99QkJBoF">[<a href="#ref-99QkJBoF" role="doc-biblioref">119</a>]</span>.</p>
<p>Sometimes it is necessary to ensure the user follows a series of sequential commands in a specific order, for example, when setting up a specific configuration. To automate this process, Linux systems provide the tool Make (which is also used by containers). Additionally, complex workflows, like a pipeline for analyzing next-generation sequencing (NGS) data, are more reproducible when using workflow management systems (as mentioned in <a href="#level-1-personal-research">Level 1</a>), while data science notebooks, in the other hand, benefit from being published in interactive applications that anyone can run from their own setup (as mentioned in <a href="#level-2-collaboration">Level 2</a>).</p>
<h3 id="make-your-research-sustainable">3.3. Make your research sustainable</h3>
<p>Now that your research can be accessed and reproduced by anyone, the final step is to keep it like that over time—also known as code maintenance. This is especially relevant if you carry the research further by integrating new features requested by your users, which fosters a strong community over time. However, even in the case in which your research is a self-contained project that will not be continued, it is still important to ensure that your user community has ways to contact you, in case bugs are discovered or parts of your code do not work anymore due to dependencies updates (a common phenomenon part of the “software rot” phenomenon <span class="citation" data-cites="TOmDDCcd">[<a href="#ref-TOmDDCcd" role="doc-biblioref">120</a>]</span>). In the following section, we will therefore review useful techniques for making your code/software/research sustainable over time.</p>
<p>Different tools can be used as communication channels between you and your users depending on the size of your user-base and the scope of the questions you receive (Table <a href="#tbl:community-tools-3">5</a>). For smaller projects, where there are only questions once in a while, a single-channel solution like Gitter <span class="citation" data-cites="iXfPU3Cy">[<a href="#ref-iXfPU3Cy" role="doc-biblioref">121</a>]</span> is probably enough, as it offers a simple way for anyone in the community to ask questions, and any of the developers to answer in threads. For larger projects, however, it could become unmanageable to have all discussions in the same channel, so multiple-channel solutions, i.e. forums, are better suited. Google groups <span class="citation" data-cites="6v98AMba">[<a href="#ref-6v98AMba" role="doc-biblioref">122</a>]</span> is a good example that works well for large pieces of software, as it allows for anyone to open separate threads for different issues. As discussed in <a href="#level-2-collaboration">Level 2</a>, GitHub allows to open GitHub Issues where collaborators or users can inform about bugs or ask questions. Additionally, GitHub recently introduced GitHub Discussions <span class="citation" data-cites="E0tpYdxU">[<a href="#ref-E0tpYdxU" role="doc-biblioref">123</a>]</span>, also meant for keeping questions organized in different threads.</p>
<div id="tbl:community-tools-3" class="tablenos">
<table>
<caption><span>Table 5:</span> Tools for making your research sustainable. </caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 33%" />
<col style="width: 46%" />
</colgroup>
<thead>
<tr class="header">
<th>Goal</th>
<th>Tool options</th>
<th>Additional remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Tell users how to contact you</td>
<td>• Specific/shorter questions: <strong>Gitter</strong> <span class="citation" data-cites="iXfPU3Cy">[<a href="#ref-iXfPU3Cy" role="doc-biblioref">121</a>]</span>.<br/>• Larger issues / how-to’s: <strong>Google groups</strong> <span class="citation" data-cites="6v98AMba">[<a href="#ref-6v98AMba" role="doc-biblioref">122</a>]</span>, <strong>GitHub Discussions</strong> <span class="citation" data-cites="E0tpYdxU">[<a href="#ref-E0tpYdxU" role="doc-biblioref">123</a>]</span>.</td>
<td>Provide ways for users to contact you for questions, requests, etc. Remember to visit them periodically!</td>
</tr>
<tr class="even">
<td>Track to-do’s in your research</td>
<td>• <strong>Github Issues</strong> <span class="citation" data-cites="5HELQ2ms">[<a href="#ref-5HELQ2ms" role="doc-biblioref">124</a>]</span></td>
<td>Detail specific pending to-do’s in your research / allow others to request changes and/or highlight bugs.</td>
</tr>
<tr class="odd">
<td>Encourage user contributions</td>
<td>• <strong>Contribution guidelines</strong> <span class="citation" data-cites="ep7wwgWj">[<a href="#ref-ep7wwgWj" role="doc-biblioref">125</a>]</span>: How to open issues / contribute code.<br/>• <strong>Github Wikis</strong> <span class="citation" data-cites="pVl1NEXZ">[<a href="#ref-pVl1NEXZ" role="doc-biblioref">126</a>]</span>: More specific how-to guides.</td>
<td>Provide as much information as you can to guide your users. You can also include administrator guidelines.</td>
</tr>
<tr class="even">
<td>Foster a respectful community</td>
<td>• Smaller projects: <strong>Contributor Covenant</strong> <span class="citation" data-cites="115FgZQh6">[<a href="#ref-115FgZQh6" role="doc-biblioref">127</a>]</span>.<br/>• Larger projects: <strong>Citizen Code of Conduct</strong> <span class="citation" data-cites="qcPNBi0h">[<a href="#ref-qcPNBi0h" role="doc-biblioref">128</a>]</span>.</td>
<td>Essential when you would like researchers to contribute code.</td>
</tr>
<tr class="odd">
<td>Branch your repo sustainably</td>
<td>• <strong>Gitflow</strong> <span class="citation" data-cites="1Ei7XPHmQ">[<a href="#ref-1Ei7XPHmQ" role="doc-biblioref">129</a>]</span></td>
<td>Useful when several developers contribute code to the project. Allows users to get access to stable versions of your research in an ongoing project.</td>
</tr>
<tr class="even">
<td>Keep track of your issues</td>
<td>• <strong>Kanban flowcharts</strong> <span class="citation" data-cites="zcUBK27J">[<a href="#ref-zcUBK27J" role="doc-biblioref">130</a>]</span>: <strong>Github Projects</strong> <span class="citation" data-cites="ssoXtriL">[<a href="#ref-ssoXtriL" role="doc-biblioref">131</a>]</span>, <strong>GitKraken Boards</strong> <span class="citation" data-cites="QrHcaBPj">[<a href="#ref-QrHcaBPj" role="doc-biblioref">132</a>]</span>.<br/>• <strong>Scrum practices</strong> <span class="citation" data-cites="LLiWj74b">[<a href="#ref-LLiWj74b" role="doc-biblioref">133</a>]</span>: <strong>Zenhub</strong> <span class="citation" data-cites="rX7VZWos">[<a href="#ref-rX7VZWos" role="doc-biblioref">134</a>]</span>, <strong>Jira</strong> <span class="citation" data-cites="a6SmwGuV">[<a href="#ref-a6SmwGuV" role="doc-biblioref">135</a>]</span>.</td>
<td>Keep track of your pending tasks in different projects with <strong>Agile</strong> <span class="citation" data-cites="qOcBF2oS">[<a href="#ref-qOcBF2oS" role="doc-biblioref">136</a>]</span> software development practices. Especially useful if your research is split in many different repositories, each with multiple features/fixes to do.</td>
</tr>
<tr class="odd">
<td>Automate your repo</td>
<td>• <strong>bump2version</strong> <span class="citation" data-cites="1UVh4XJi">[<a href="#ref-1UVh4XJi" role="doc-biblioref">137</a>]</span>: Easier releasing.<br/>• <strong>Danger-CI</strong> <span class="citation" data-cites="SXI7Canc">[<a href="#ref-SXI7Canc" role="doc-biblioref">138</a>]</span>: Easier reviewing.</td>
<td>Do less, script more!</td>
</tr>
</tbody>
</table>
</div>
<p>Now that your users know <em>where</em> to contact you, you should also tell them <em>how</em> to contact you. For this, it is essential to have a file with contribution guidelines <span class="citation" data-cites="ep7wwgWj">[<a href="#ref-ep7wwgWj" role="doc-biblioref">125</a>]</span> (Table <a href="#tbl:community-tools-3">5</a>), detailing how users should (1) open issues and (2) contribute with their own code changes via PRs. These guidelines are mainly intended for new users/contributors, so they should be written in the style of a <em>how-to</em> guide; however, they may also include additional instructions for the main developers, or even the administrator of the repository. Alternatively, those detailed guidelines can be included in a supplemental wiki, which hosting services offer as part of the repository <span class="citation" data-cites="pVl1NEXZ">[<a href="#ref-pVl1NEXZ" role="doc-biblioref">126</a>]</span>. Equally important as the contribution guidelines is the code of conduct (Table <a href="#tbl:community-tools-3">5</a>), which includes guidelines on how to behave when engaging with the community in the repository and what to do if someone does not comply, promoting a respectful community. Several templates exist as code of conduct, such as the Contributor Covenant <span class="citation" data-cites="115FgZQh6">[<a href="#ref-115FgZQh6" role="doc-biblioref">127</a>]</span> for smaller projects, and the Citizen Code of Conduct <span class="citation" data-cites="qcPNBi0h">[<a href="#ref-qcPNBi0h" role="doc-biblioref">128</a>]</span> for larger projects.</p>
<p>Finally, ensuring sustainability of your project means not only allowing and encouraging users contacting you, but also smarter ways to develop and maintain your software as it grows in scope and number of users. This includes:</p>
<ol type="1">
<li><p><em>Branching System:</em> When many developers are involved in a project, you want to ensure that users can access functional versions of your code while you work on it. In this case, more advanced branching methods such as GitFlow <span class="citation" data-cites="1Ei7XPHmQ">[<a href="#ref-1Ei7XPHmQ" role="doc-biblioref">129</a>]</span> might be preferable (Table <a href="#tbl:community-tools-3">5</a>). With GitFlow, an additional development branch (often named as <code>devel</code>) is used as main branch for new branches to be based on, leaving the master branch as a separate branch only for stable versions of the code, and a merge from development to master always invoking a code release. This way, users can directly access the master branch for tested releases, whereas the latest additions of the code, perhaps not 100% tested, will be available for developers to further work on in the development branch. Additional branches can be added depending on the scope of the project, such as specific version branches in case further testing is needed, or hotfix branches, in case bugs are detected in master and a quick solution is required.</p></li>
<li><p><em>Project Management:</em> Although issues are fundamental for keeping track of what is there to do, they can become hard to organize and prioritize as they grow in number. Several project management tools exist to solve this (Table <a href="#tbl:community-tools-3">5</a>), all based on Agile <span class="citation" data-cites="qOcBF2oS">[<a href="#ref-qOcBF2oS" role="doc-biblioref">136</a>]</span> principles. The most simple one is to have a Kanban board <span class="citation" data-cites="zcUBK27J">[<a href="#ref-zcUBK27J" role="doc-biblioref">130</a>]</span>, where issues are organized in as many columns as necessary to have a clear layout and figure out what is the current state of a given task. Tools like GitHub Projects <span class="citation" data-cites="ssoXtriL">[<a href="#ref-ssoXtriL" role="doc-biblioref">131</a>]</span> or GitKraken Boards <span class="citation" data-cites="QrHcaBPj">[<a href="#ref-QrHcaBPj" role="doc-biblioref">132</a>]</span> use this approach. For Larger projects with either several collaborators and/or several repositories, a more structured approach such as a Scrum framework <span class="citation" data-cites="LLiWj74b">[<a href="#ref-LLiWj74b" role="doc-biblioref">133</a>]</span> might be needed, as issues are more easily prioritized by setting milestones and estimating difficulties. Both Zenhub <span class="citation" data-cites="rX7VZWos">[<a href="#ref-rX7VZWos" role="doc-biblioref">134</a>]</span> and Jira <span class="citation" data-cites="a6SmwGuV">[<a href="#ref-a6SmwGuV" role="doc-biblioref">135</a>]</span> are great options for this.</p></li>
<li><p><em>Additional Automation:</em> As you develop your project, you will find that many aspects can be automated to improve efficiency. Want to make releasing faster to ensure all sections of your code get updated with the new release? bump2version <span class="citation" data-cites="1UVh4XJi">[<a href="#ref-1UVh4XJi" role="doc-biblioref">137</a>]</span> might help. Want to make sure contributors comply with certain standards in their pull requests, or even locally? Look into Danger-CI <span class="citation" data-cites="SXI7Canc">[<a href="#ref-SXI7Canc" role="doc-biblioref">138</a>]</span> or git hooks <span class="citation" data-cites="JKpPPQzZ">[<a href="#ref-JKpPPQzZ" role="doc-biblioref">139</a>]</span>. Note here that we advice against implementing all of this from the start, but instead adding different tools as you realize you need them. If you find yourself performing a task in a routinely fashion, ask yourself if you could automate it. More often than not the answer is yes!</p></li>
</ol>
<h2 id="case-studies">Case Studies</h2>
<p>We will now exemplify the use of all the introduced tools by presenting three different computational biology projects from the literature, detailing which tools are beneficial for those types of projects, depending on their scope and magnitude (Figure <a href="#fig:cases-fig">2</a>) (two more cases are presented in <a href="#supplementary-material">Supplementary Material</a>). Note that this is a non-comprehensive list, but it is rather intended as a short overview of how can projects in computational biology benefit from robust computational tools and good software development practices. Additionally, it will be quickly evident by reading these case studies that there is a lot of repetition in the chosen tools. For instance, all projects include an environment manager such as Conda, and a version control system like Git. This repetition is intentional, as it denotes that some tools, especially the ones at the personal research level, are ubiquitous in computational biology and can benefit any project in the field.</p>
<div id="fig:cases-fig" class="fignos">
<figure>
<img src="images/Figure2.png" style="width:100.0%" alt="" /><figcaption><span>Figure 2:</span> Examples of computational biology projects and associated depending on the nature of the research and the number of people involved.</figcaption>
</figure>
</div>
<h3 id="case-study-1-genomic-variant-detection-in-a-large-cohort">Case study 1: Genomic variant detection in a large cohort</h3>
<p>Nowadays, the availability and affordability of NGS allows routine sequencing of dozens to even thousands of individuals. These resequencing experiments enable discovery and genotyping of genomic variation within large cohorts to answer key questions regarding population history and susceptibility to disease. For this example, let’s consider a project including whole-genome Illumina sequencing and variant calling in thousands of individuals such as <span class="citation" data-cites="qRqqDo0w">[<a href="#ref-qRqqDo0w" role="doc-biblioref">140</a>]</span>. In a project of this nature, the challenge resides on applying a multi-step variant calling pipeline on a big sample size in a reproducible manner.</p>
<p>In this particular project, the authors utilized the AnVil cloud computing platform, which uses WDL for workflow description. However, if you have access to an HPC, then a project of this nature can be done using the workflow automation tool Snakemake, using Python to parse sample names and perform other data handling operations, and following Snakemake’s recommendation for folder structure. A Conda environment can hold all necessary software since Bioconda contains a wide array of software designed for genomics analyses. The actual coding of the workflow can be done in any text editor that offers easy integration with Git commands and Git hosting repository, such as Atom or Visual Studio Code. Although there are no formal styling rules for Snakefiles, embrace consisting variable and rule naming, and comment your code when needed.</p>
<p>A project of this magnitude will usually imply collaborators from other research groups. The pipelines and scripts can be shared using a GitHub repository. If privacy is a concern, the repository can be set as private and made public in later stages of the project. To write the manuscript, a general-purpose word processors such as Google Doc would suffice, especially if not all your collaborators are familiarized with Git and tools like Manubot. Considering that this type of data are a valuable resource for the community, follow FAIR principles for data sharing. Besides uploading the raw data in a repository like ENA or NCBI, we encourage you to openly share your code, analyses and other types of data in either a GitHub repository or a dedicated research repository like Zenodo.</p>
<h3 id="case-study-2-scrna-seq-data-integration">Case study 2: scRNA-seq data integration</h3>
<p>Single-cell RNA-seq (scRNA-seq) is a rapidly evolving technology that has enable the study of cell heterogeneity and developmental changes of a cell lineage, otherwise intractable with bulk RNA-seq. Current scRNA-seq experiment deliver the transcriptomic profiles of thousand to a million of cells <span class="citation" data-cites="ALU8zyix">[<a href="#ref-ALU8zyix" role="doc-biblioref">141</a>]</span>, making them a suitable target for machine or deep learning approaches. Among the many challenges imposed by this technology, a key one is the integration of scRNA-seq datasets, especially in case-control studies where cell types need to be functionally matched across dataset before evaluating differences across conditions. For this case study, we will consider the development of an unsupervised deep learning method for data integration as described in <span class="citation" data-cites="KBoHN8e8">[<a href="#ref-KBoHN8e8" role="doc-biblioref">142</a>]</span>.</p>
<p>This kind of project often uses a combination of Python, R and Bash scripting depending on the task: Python can be used to write and train deep learning models with TensorFlow and PyTorch libraries, R enables straightforward data pre-processing with tools such as Seurat, and Bash can handle large scale processing of raw data files which cannot be loaded directly into RAM (often required by R and Python applications). Additionally, we advice to use the Python’s reticulate library to incorporate Python tools into the existing R ecosystem. To set up your working directory, we recommend a structure like Cookiecutter Data Science, which includes separated folders for trained models and other components of a deep learning project. To set up a software environment, Python virtual environments like pipenv and virtualenv work well with Tensorflow and PyTorch. The actual coding can be done in any general purpose text editor, such as Atom or Visual Studio Code, where updates can be easily pushed/pulled to/from GitHub. As a good practice, keep the code modular and properly commented, and use detailed filenames with data stamps and model parameters to facilitate revisiting projects. Additionally, take advantage of tools such as TensorFlow’s TensorBoard to diagnose, visualize, and experiment with your models.</p>
<p>When working with collaborators, the best way to share the code is through a Git hosting service like GitHub. When multiple-users need to edit the code in real-time, then Google CoLab is an excellent platform since it offers interactive coding and GPU access. In addition to the code repository, a Manubot can be crated to write the manuscript collaboratively. To make your tool accessible to a larger community, the code can be taken from an internal repository to a public GitHub, which must include an overview of the tool and a license file. Considering that most users in the field use R, you can go one step further and share your code as a Bioconductor package, making sure your method can be called directly in R and that interacts with standard data-structures in the field. For better reproducibility, document your method including example tutorials in a platform like ReadTheDocs or Gitbook, and share the software environment needed to deploy the models as a Docker container. GitHub issues and Bioconductor forums are suitable platforms to promptly reply to users questions, bugs reports, and enhancement opportunities.</p>
<h3 id="case-study-3-tool-development-for-constraint-based-modeling">Case study 3: Tool development for constraint-based modeling</h3>
<p>The last case study we will present is related to constraint-based modeling, a common approach used for simulating cellular metabolism. In this approach, the complete (or partial) metabolic network of a given organism is inferred from its genome and/or literature, and converted to a matrix that contains the reaction’s stoichiometry, hence referred to as a stoichiometric matrix. Using a few simple assumptions, this matrix can then be used to perform simulations under different experimental conditions, to obtain additional insight into cellular physiology <span class="citation" data-cites="94lBUqNp">[<a href="#ref-94lBUqNp" role="doc-biblioref">143</a>]</span>. Several tools have been developed for working with these type of models; here we will consider as example cobrapy <span class="citation" data-cites="cieXgNg">[<a href="#ref-cieXgNg" role="doc-biblioref">144</a>]</span>, a community tool for reading/writing constrained-based models and performing basic simulation operations.</p>
<p>A tool of this nature is especially useful if developed in Python, as it should ideally be presented as a package which can be easily installed with pip or similar. The use of an IDE is ideal for this case, as it will provide additional features for testing changes in the tool. Practices that for other case studies were useful now become pretty much essential, like complying with coding style and using version control. This is because there will potentially be hundreds of people that will read your code, so it needs to be easy to understand, and changes need to be clearly highlighted. Furthermore, the code should be (1) available via a hosting service such as GitHub, (2) tested with a continuous development tool such as GitHub Actions, (3) manually reviewed by collaborators to ensure correctness, (4) released following semantic versioning standards, and (5) documented with a companion documentation website, rich with tutorials and how-to guides. As a branching strategy, Gitflow is probably the best suited, as it allows to have all changes in a development branch, and stable releases in a main branch.</p>
<p>Finally, and due to the size of a project like this, additional considerations must be made for keeping a healthy user-base. The first one is to offer a place for users to raise their questions such as Gitter, Google groups or GitHub Discussions, and to make sure to reply to new questions often. Additionally, guidelines should be provided for everything: for how to open issues (ideally with issue templates), for how to contribute (ideally with pull request templates), for how to communicate within the community (with a code of conduct), and for any other routine task (with development guidelines and/or wikis). Addressing issues is also essential in a project of this nature, as if not done routinely they quickly pile up (and is an indicator that a project has gone stale). Additional tools such as a Kanban flowchart with the help of GitHub projects will help prioritize issues, and if several repositories have to be jointly coordinated, tools like Jira or Zenhub could be implemented instead.</p>
<h2 id="final-words">Final words</h2>
<p>Good practices in the computational biology field have gained the spotlight among researchers thanks to the several guiding principles published in recent years, as well as the increasing usage of Git-based repositories and workflow managers. This review adds to the existing literature by introducing a comprehensive list of good practices and associated tools that can be applied to any computational biology project, regardless of the specific subfield or the experience of the researcher.</p>
<p>We are aware that the many tools and practices introduced in this study and their ever-changing nature may seem overwhelming, especially for someone new to the field. To overcome this, we encourage you to implement only a few practices and tools first, starting from your personal research, and expand your repertoire over time. More importantly than any specific tools is keeping a mindset of striving for reproducibility, regardless of the tools used. We are also aware that we may have left many relevant tools behind and that, as time progresses, many new tools will be released. This means that updated versions of reviews like this one will always be essential to help new computational biologist enter the field as well as to keep experienced computational biologists up to date with the latest trends.</p>
<p>In the midst of our work, under the many pressures of academic research, we can forget to keep good computational practices in place. In such scenario, the consequences will not be seen immediately, but they will be huge in the long run. As all scientific endeavors, computational biology heavily relies on building new knowledge from previous one; as such, the good practices that we adopt will act as building blocks for the overall reproducibility of the field, propelling novel and exciting discoveries.</p>
<h2 id="acknowledgments">Acknowledgments</h2>
<p>We would like to thank Nelson Johansen for his insights on the scRNA-seq data integration case study.</p>
<h2 class="page_break_before" id="references">References</h2>
<!-- Explicitly insert bibliography here -->
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-Xcr0K7I5">
<p>1. <strong>NIH working definition of bioinformatics and computational biology</strong> <br />
Huerta Michael, Downing Gregory, Haseltine Florence, Seto Belinda, Liu Yuan<br />
(2000-07-17) <a href="https://www.kennedykrieger.org/sites/default/files/library/documents/research/center-labs-cores/bioinformatics/bioinformatics-def.pdf">https://www.kennedykrieger.org/sites/default/files/library/documents/research/center-labs-cores/bioinformatics/bioinformatics-def.pdf</a></p>
</div>
<div id="ref-jn2NeK3H">
<p>2. <strong>What is bioinformatics? A proposed definition and overview of the field.</strong> <br />
NM Luscombe, D Greenbaum, M Gerstein<br />
<em>Methods of information in medicine</em> (2001) <a href="https://www.ncbi.nlm.nih.gov/pubmed/11552348">https://www.ncbi.nlm.nih.gov/pubmed/11552348</a> <br />
PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/11552348">11552348</a></p>
</div>
<div id="ref-12RoKrne5">
<p>3. <strong>How do scientists develop scientific software? An external replication</strong> <br />
Gustavo Pinto, Igor Wiese, Luiz Felipe Dias<br />
<em>2018 IEEE 25th International Conference on Software Analysis, Evolution and Reengineering (SANER)</em> (2018-03) <a href="https://doi.org/ggk6nc">https://doi.org/ggk6nc</a> <br />
DOI: <a href="https://doi.org/10.1109/saner.2018.8330263">10.1109/saner.2018.8330263</a> · ISBN: <a href="https://worldcat.org/isbn/9781538649695">9781538649695</a></p>
</div>
<div id="ref-6DjakjNS">
<p>4. <strong>The FAIR Guiding Principles for scientific data management and stewardship</strong> <br />
Mark D. Wilkinson, Michel Dumontier, IJsbrand Jan Aalbersberg, Gabrielle Appleton, Myles Axton, Arie Baak, Niklas Blomberg, Jan-Willem Boiten, Luiz Bonino da Silva Santos, Philip E. Bourne, … Barend Mons<br />
<em>Scientific Data</em> (2016-12) <a href="https://doi.org/bdd4">https://doi.org/bdd4</a> <br />
DOI: <a href="https://doi.org/10.1038/sdata.2016.18">10.1038/sdata.2016.18</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/26978244">26978244</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4792175">PMC4792175</a></p>
</div>
<div id="ref-WrDwZxcM">
<p>5. <strong>Barely sufficient practices in scientific computing</strong> <br />
Graham Lee, Sebastian Bacon, Ian Bush, Laura Fortunato, David Gavaghan, Thibault Lestang, Caroline Morton, Martin Robinson, Philippe Rocca-Serra, Susanna-Assunta Sansone, Helena Webb<br />
<em>Patterns</em> (2021-02) <a href="https://doi.org/gjpcb6">https://doi.org/gjpcb6</a> <br />
DOI: <a href="https://doi.org/10.1016/j.patter.2021.100206">10.1016/j.patter.2021.100206</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33659915">33659915</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7892476">PMC7892476</a></p>
</div>
<div id="ref-k9JCaCug">
<p>6. <strong>Good enough practices in scientific computing</strong> <br />
Greg Wilson, Jennifer Bryan, Karen Cranston, Justin Kitzes, Lex Nederbragt, Tracy K. Teal<br />
<em>PLOS Computational Biology</em> (2017-06-22) <a href="https://doi.org/gbkbwp">https://doi.org/gbkbwp</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1005510">10.1371/journal.pcbi.1005510</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28640806">28640806</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5480810">PMC5480810</a></p>
</div>
<div id="ref-O6UbstGG">
<p>7. <strong>Best Practices for Scientific Computing</strong> <br />
Greg Wilson, D. A. Aruliah, C. Titus Brown, Neil P. Chue Hong, Matt Davis, Richard T. Guy, Steven H. D. Haddock, Kathryn D. Huff, Ian M. Mitchell, Mark D. Plumbley, … Paul Wilson<br />
<em>PLoS Biology</em> (2014-01-07) <a href="https://doi.org/qtt">https://doi.org/qtt</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pbio.1001745">10.1371/journal.pbio.1001745</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24415924">24415924</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3886731">PMC3886731</a></p>
</div>
<div id="ref-15pOpsdFR">
<p>8. <strong>Software engineering for scientific big data analysis</strong> <br />
Björn A Grüning, Samuel Lampa, Marc Vaudel, Daniel Blankenberg<br />
<em>GigaScience</em> (2019-05-01) <a href="https://doi.org/gf4f4m">https://doi.org/gf4f4m</a> <br />
DOI: <a href="https://doi.org/10.1093/gigascience/giz054">10.1093/gigascience/giz054</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31121028">31121028</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6532757">PMC6532757</a></p>
</div>
<div id="ref-SGTWzj9t">
<p>9. <strong>So you want to be a computational biologist?</strong> <br />
Nick Loman, Mick Watson<br />
<em>Nature Biotechnology</em> (2013-11) <a href="https://doi.org/p3j">https://doi.org/p3j</a> <br />
DOI: <a href="https://doi.org/10.1038/nbt.2740">10.1038/nbt.2740</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24213777">24213777</a></p>
</div>
<div id="ref-sSSw0sr0">
<p>10. <strong>Ten simple rules for biologists learning to program</strong> <br />
Maureen A. Carey, Jason A. Papin<br />
<em>PLOS Computational Biology</em> (2018-01-04) <a href="https://doi.org/gft4n3">https://doi.org/gft4n3</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1005871">10.1371/journal.pcbi.1005871</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29300745">29300745</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5754048">PMC5754048</a></p>
</div>
<div id="ref-kEX5dgzK">
<p>11. <strong>Ten Simple Rules for Taking Advantage of Git and GitHub</strong> <br />
Yasset Perez-Riverol, Laurent Gatto, Rui Wang, Timo Sachsenberg, Julian Uszkoreit, Felipe da Veiga Leprevost, Christian Fufezan, Tobias Ternent, Stephen J. Eglen, Daniel S. Katz, … Juan Antonio Vizcaíno<br />
<em>PLOS Computational Biology</em> (2016-07-14) <a href="https://doi.org/gbrb39">https://doi.org/gbrb39</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1004947">10.1371/journal.pcbi.1004947</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/27415786">27415786</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4945047">PMC4945047</a></p>
</div>
<div id="ref-eYWjWdLd">
<p>12. <strong>Ten Simple Rules for Reproducible Research in Jupyter Notebooks</strong> <br />
Adam Rule, Amanda Birmingham, Cristal Zuniga, Ilkay Altintas, Shih-Cheng Huang, Rob Knight, Niema Moshiri, Mai H. Nguyen, Sara Brin Rosenthal, Fernando Pérez, Peter W. Rose<br />
<em>arXiv</em> (2018-10-13) <a href="https://arxiv.org/abs/1810.08055v1">https://arxiv.org/abs/1810.08055v1</a></p>
</div>
<div id="ref-1HhbGD4jJ">
<p>13. <strong>Streamlining Data-Intensive Biology With Workflow Systems</strong> <br />
Taylor Reiter, Phillip T. Brooks, Luiz Irber, Shannon E. K. Joslin, Charles M. Reid, Camille Scott, C. Titus Brown, N. Tessa Pierce<br />
<em>Bioinformatics</em> (2020-07-01) <a href="https://doi.org/gg353v">https://doi.org/gg353v</a> <br />
DOI: <a href="https://doi.org/10.1101/2020.06.30.178673">10.1101/2020.06.30.178673</a></p>
</div>
<div id="ref-16iU4PKI1">
<p>14. <strong>A Padawan Programmer’s Guide to Developing Software Libraries</strong> <br />
James T. Yurkovich, Benjamin J. Yurkovich, Andreas Dräger, Bernhard O. Palsson, Zachary A. King<br />
<em>Cell Systems</em> (2017-11) <a href="https://doi.org/gg8tqz">https://doi.org/gg8tqz</a> <br />
DOI: <a href="https://doi.org/10.1016/j.cels.2017.08.003">10.1016/j.cels.2017.08.003</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/28988801">28988801</a></p>
</div>
<div id="ref-LOwtrFvP">
<p>15. <strong>Bash - GNU Project - Free Software Foundation</strong> <a href="https://www.gnu.org/software/bash/">https://www.gnu.org/software/bash/</a></p>
</div>
<div id="ref-XST6x2E0">
<p>16. <strong>Welcome to Python.org</strong> <br />
Python.org<br />
<a href="https://www.python.org/">https://www.python.org/</a></p>
</div>
<div id="ref-uUI3eFW7">
<p>17. <strong>R: The R Project for Statistical Computing</strong> <a href="https://www.r-project.org/">https://www.r-project.org/</a></p>
</div>
<div id="ref-1Dm6rLdGv">
<p>18. <strong>The Perl Programming Language - www.perl.org</strong> <a href="https://www.perl.org/">https://www.perl.org/</a></p>
</div>
<div id="ref-FuKo9MoO">
<p>19. <strong>cplusplus.com - The C++ Resources Network</strong> <a href="https://www.cplusplus.com/">https://www.cplusplus.com/</a></p>
</div>
<div id="ref-jEGOBKdy">
<p>20. <strong>Rust Programming Language</strong> <a href="https://www.rust-lang.org/">https://www.rust-lang.org/</a></p>
</div>
<div id="ref-5iKCi5fm">
<p>21. <strong>Make - GNU Project - Free Software Foundation</strong> <a href="https://www.gnu.org/software/make/">https://www.gnu.org/software/make/</a></p>
</div>
<div id="ref-1GtwLEEIm">
<p>22. <strong>Snakemake - A framework for reproducible data analysis</strong> <a href="https://snakemake.github.io/">https://snakemake.github.io/</a></p>
</div>
<div id="ref-11OYUtIpR">
<p>23. <strong>A DSL for parallel and scalable computational pipelines | Nextflow</strong> <a href="https://www.nextflow.io/">https://www.nextflow.io/</a></p>
</div>
<div id="ref-hzkdXHo">
<p>24. <strong>Home</strong> <br />
Common Workflow Language (CWL)<br />
<em>Common Workflow Language (CWL)</em> <a href="https://www.commonwl.org/">https://www.commonwl.org/</a></p>
</div>
<div id="ref-uPjsd0XZ">
<p>25. <strong>OpenWDL</strong> <a href="https://openwdl.org/">https://openwdl.org/</a></p>
</div>
<div id="ref-j6HfMqoR">
<p>26. <strong>Home - Cookiecutter Data Science</strong> <a href="https://drivendata.github.io/cookiecutter-data-science/">https://drivendata.github.io/cookiecutter-data-science/</a></p>
</div>
<div id="ref-7D5DgTkH">
<p>27. <strong>GitHub - Reproducible-Science-Curriculum/rr-init: Research project initialization and organization following reproducible research guidelines</strong> <br />
GitHub<br />
<a href="https://github.com/Reproducible-Science-Curriculum/rr-init">https://github.com/Reproducible-Science-Curriculum/rr-init</a></p>
</div>
<div id="ref-jq4WP878">
<p>28. <strong>Distribution and Reproducibility — Snakemake 7.3.0 documentation</strong> <a href="https://snakemake.readthedocs.io/en/stable/snakefiles/deployment.html">https://snakemake.readthedocs.io/en/stable/snakefiles/deployment.html</a></p>
</div>
<div id="ref-BjGc5Pnm">
<p>29. <strong>Pipenv: Python Dev Workflow for Humans — pipenv 2022.1.9.dev0 documentation</strong> <a href="https://pipenv.pypa.io/en/latest/">https://pipenv.pypa.io/en/latest/</a></p>
</div>
<div id="ref-4OxCaUVc">
<p>30. <strong>Virtualenv — virtualenv 20.13.4.dev4+g63c94af documentation</strong> <a href="https://virtualenv.pypa.io/en/latest/">https://virtualenv.pypa.io/en/latest/</a></p>
</div>
<div id="ref-Ga8sduRB">
<p>31. <strong>Project Environments</strong> <a href="https://rstudio.github.io/renv/index.html">https://rstudio.github.io/renv/index.html</a></p>
</div>
<div id="ref-6ChhcoqP">
<p>32. <strong>Conda — Conda documentation</strong> <a href="https://docs.conda.io/en/latest/">https://docs.conda.io/en/latest/</a></p>
</div>
<div id="ref-15ccmJntS">
<p>33. <strong>pip documentation v22.0.4</strong> <a href="https://pip.pypa.io/en/stable/">https://pip.pypa.io/en/stable/</a></p>
</div>
<div id="ref-78nI2wue">
<p>34. <strong>GitHub - Bioconductor/BiocManager: CRAN Package For Managing Bioconductor Packages</strong> <br />
GitHub<br />
<a href="https://github.com/Bioconductor/BiocManager">https://github.com/Bioconductor/BiocManager</a></p>
</div>
<div id="ref-vO2YTdWH">
<p>35. <strong>RStudio Package Manager</strong> <a href="https://www.rstudio.com/products/package-manager/">https://www.rstudio.com/products/package-manager/</a></p>
</div>
<div id="ref-HYwZJ66F">
<p>36. <strong>A hackable text editor for the 21st Century</strong> <br />
Atom<br />
<a href="https://atom.io/">https://atom.io/</a></p>
</div>
<div id="ref-iD4von7Z">
<p>37. <strong>Sublime Text - the sophisticated text editor for code, markup and prose</strong> <a href="https://www.sublimetext.com/">https://www.sublimetext.com/</a></p>
</div>
<div id="ref-llnpg0Du">
<p>38. <strong>Visual Studio Code - Code Editing. Redefined</strong> <a href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p>
</div>
<div id="ref-r199dfky">
<p>39. <strong>Notepad++</strong> <a href="https://notepad-plus-plus.org/">https://notepad-plus-plus.org/</a></p>
</div>
<div id="ref-495zSD0M">
<p>40. <strong>welcome home : vim online</strong> <a href="https://www.vim.org/">https://www.vim.org/</a></p>
</div>
<div id="ref-GjC8YrzF">
<p>41. <strong>GNU Emacs - GNU Project</strong> <a href="https://www.gnu.org/software/emacs/">https://www.gnu.org/software/emacs/</a></p>
</div>
<div id="ref-1EK7NOavz">
<p>42. <strong>Project Jupyter</strong> <a href="https://jupyter.org">https://jupyter.org</a></p>
</div>
<div id="ref-G0v2WIik">
<p>43. <strong>PyCharm: the Python IDE for Professional Developers by JetBrains</strong> <br />
JetBrains<br />
<a href="https://www.jetbrains.com/pycharm/">https://www.jetbrains.com/pycharm/</a></p>
</div>
<div id="ref-sBsTiN8q">
<p>44. <strong>Home — Spyder IDE</strong> <a href="https://www.spyder-ide.org/">https://www.spyder-ide.org/</a></p>
</div>
<div id="ref-15Xir6Mp8">
<p>45. <strong>RStudio | Open source &amp; professional software for data science teams</strong> <a href="https://www.rstudio.com/">https://www.rstudio.com/</a></p>
</div>
<div id="ref-DJNUoP3l">
<p>46. <strong>R Markdown</strong> <a href="https://rmarkdown.rstudio.com/">https://rmarkdown.rstudio.com/</a></p>
</div>
<div id="ref-1D76el83m">
<p>47. <strong>PEP 8 – Style Guide for Python Code | peps.python.org</strong> <a href="https://peps.python.org/pep-0008/">https://peps.python.org/pep-0008/</a></p>
</div>
<div id="ref-4PJ4Kllx">
<p>48. <strong>GitHub - google/styleguide: Style guides for Google-originated open-source projects</strong> <br />
GitHub<br />
<a href="https://github.com/google/styleguide">https://github.com/google/styleguide</a></p>
</div>
<div id="ref-N871n8XH">
<p>49. <strong>Markdown Guide</strong> <a href="https://www.markdownguide.org/">https://www.markdownguide.org/</a></p>
</div>
<div id="ref-XJdnoSwI">
<p>50. <strong>Git</strong> <a href="https://git-scm.com/">https://git-scm.com/</a></p>
</div>
<div id="ref-dmEZPbB4">
<p>51. <strong>GitHub: Where the world builds software</strong> <br />
GitHub<br />
<a href="https://github.com/">https://github.com/</a></p>
</div>
<div id="ref-16Oz9VFEk">
<p>52. <strong>Iterate faster, innovate together | GitLab</strong> <a href="https://about.gitlab.com/">https://about.gitlab.com/</a></p>
</div>
<div id="ref-1E58VA9bS">
<p>53. <strong>Bitbucket | The Git solution for professional teams</strong> <br />
Atlassian<br />
<em>Bitbucket</em> <a href="https://bitbucket.org/product">https://bitbucket.org/product</a></p>
</div>
<div id="ref-1V8gez2v">
<p>54. <strong>GitHub Desktop</strong> <br />
GitHub Desktop<br />
<a href="https://desktop.github.com/">https://desktop.github.com/</a></p>
</div>
<div id="ref-D30wOZ60">
<p>55. <strong>GitKraken Legendary Git Tools | GitKraken</strong> <a href="https://www.gitkraken.com">https://www.gitkraken.com</a></p>
</div>
<div id="ref-lkZcKu7R">
<p>56. <strong>2018 Kaggle Machine Learning &amp; Data Science Survey</strong> <a href="https://kaggle.com/datasets/kaggle/kaggle-survey-2018">https://kaggle.com/datasets/kaggle/kaggle-survey-2018</a></p>
</div>
<div id="ref-1A4rxBI47">
<p>57. <strong>Modulecounts</strong> <a href="http://www.modulecounts.com/">http://www.modulecounts.com/</a></p>
</div>
<div id="ref-wu0sr8q2">
<p>58. <strong>Why scientists are turning to Rust</strong> <br />
Jeffrey M. Perkel<br />
<em>Nature</em> (2020-12-03) <a href="https://doi.org/ghqc7g">https://doi.org/ghqc7g</a> <br />
DOI: <a href="https://doi.org/10.1038/d41586-020-03382-2">10.1038/d41586-020-03382-2</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33262490">33262490</a></p>
</div>
<div id="ref-3Gx1ESE4">
<p>59. <strong>A Quick Guide to Organizing Computational Biology Projects</strong> <br />
William Stafford Noble<br />
<em>PLoS Computational Biology</em> (2009-07-31) <a href="https://doi.org/fbbpkn">https://doi.org/fbbpkn</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1000424">10.1371/journal.pcbi.1000424</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/19649301">19649301</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2709440">PMC2709440</a></p>
</div>
<div id="ref-aUxTEizP">
<p>60. <strong>Black 22.1.0 documentation</strong> <a href="https://black.readthedocs.io/en/stable/">https://black.readthedocs.io/en/stable/</a></p>
</div>
<div id="ref-qjg93S3G">
<p>61. <strong>GitHub flow</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/get-started/quickstart/github-flow">https://docs.github.com/en/get-started/quickstart/github-flow</a></p>
</div>
<div id="ref-15kUlshEi">
<p>62. <strong>pytest: helps you write better programs — pytest documentation</strong> <a href="https://docs.pytest.org/en/stable/">https://docs.pytest.org/en/stable/</a></p>
</div>
<div id="ref-cEpTMlZc">
<p>63. <strong>Codecov - The Leading Code Coverage Solution</strong> <br />
Codecov<br />
<a href="https://about.codecov.io/">https://about.codecov.io/</a></p>
</div>
<div id="ref-1Bi82XR9D">
<p>64. <strong>Welcome to the tox automation project — tox 3.24.6.dev12 documentation</strong> <a href="https://tox.wiki/en/latest/">https://tox.wiki/en/latest/</a></p>
</div>
<div id="ref-SM1pqdjN">
<p>65. <strong>Homepage | Travis CI – Start building today!</strong> <br />
Travis CI<br />
<a href="https://www.travis-ci.com/">https://www.travis-ci.com/</a></p>
</div>
<div id="ref-NUXbp429">
<p>66. <strong>Features • GitHub Actions</strong> <br />
GitHub<br />
<a href="https://github.com/features/actions">https://github.com/features/actions</a></p>
</div>
<div id="ref-RCh2gb01">
<p>67. <strong>Reviewing changes in pull requests</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests">https://docs.github.com/en/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests</a></p>
</div>
<div id="ref-6woNTKZi">
<p>68. <strong>Crucible Code Review Tool for Git, SVN, Perforce and More</strong> <br />
Atlassian<br />
<em>Atlassian</em> <a href="https://www.atlassian.com/software/crucible">https://www.atlassian.com/software/crucible</a></p>
</div>
<div id="ref-LJc9aT8R">
<p>69. <strong>Upsource: Code Review and Project Analytics by JetBrains</strong> <br />
JetBrains<br />
<a href="https://www.jetbrains.com/upsource/">https://www.jetbrains.com/upsource/</a></p>
</div>
<div id="ref-Gtnr8c2U">
<p>70. <strong>Tidy Data</strong> <br />
Hadley Wickham<br />
<em>Journal of Statistical Software</em> (2014) <a href="https://doi.org/gdm3p7">https://doi.org/gdm3p7</a> <br />
DOI: <a href="https://doi.org/10.18637/jss.v059.i10">10.18637/jss.v059.i10</a></p>
</div>
<div id="ref-JkrlcwLO">
<p>71. <strong>Data Version Control · DVC</strong> <br />
Data Version Control · DVC<br />
<a href="https://dvc.org/">https://dvc.org/</a></p>
</div>
<div id="ref-8Cn0lgXi">
<p>72. <strong>nbviewer</strong> <a href="https://nbviewer.org/">https://nbviewer.org/</a></p>
</div>
<div id="ref-1dqfprG7">
<p>73. <strong>The Binder Project</strong> <a href="https://mybinder.org/">https://mybinder.org/</a></p>
</div>
<div id="ref-mr26BIpF">
<p>74. <strong>Google Colaboratory</strong> <a href="https://colab.research.google.com/">https://colab.research.google.com/</a></p>
</div>
<div id="ref-12ovVgVju">
<p>75. <strong>ReviewNB - Jupyter Notebook Code Reviews &amp; Collaboration</strong> <a href="https://www.reviewnb.com/">https://www.reviewnb.com/</a></p>
</div>
<div id="ref-6YE0Zqqy">
<p>76. <strong>The WorkflowHub</strong> <a href="https://workflowhub.eu/">https://workflowhub.eu/</a></p>
</div>
<div id="ref-18tOsSTai">
<p>77. <strong>Google Docs: Free Online Document Editor | Google Workspace</strong> <a href="https://www.facebook.com/GoogleDocs/">https://www.facebook.com/GoogleDocs/</a></p>
</div>
<div id="ref-sP8f9fNq">
<p>78. <strong>Microsoft 365 - Subscription for Office Apps | Microsoft 365</strong> <a href="https://www.microsoft.com/en-us/microsoft-365">https://www.microsoft.com/en-us/microsoft-365</a></p>
</div>
<div id="ref-UeFHiqcp">
<p>79. <strong>Open Research Collaboration and Publishing - Authorea</strong> <a href="https://www.authorea.com/">https://www.authorea.com/</a></p>
</div>
<div id="ref-J12A3elW">
<p>80. <strong>Overleaf, Online LaTeX Editor</strong> <a href="https://www.overleaf.com">https://www.overleaf.com</a></p>
</div>
<div id="ref-petulEc2">
<p>81. <strong>Manubot - Manuscripts, open and automated</strong> <a href="https://manubot.org">https://manubot.org</a></p>
</div>
<div id="ref-15dXXs6EK">
<p>82. <strong>Semantic Commit Messages</strong> <br />
Sparkbox<br />
<a href="https://sparkbox.com/foundry/semantic_commit_messages">https://sparkbox.com/foundry/semantic_commit_messages</a></p>
</div>
<div id="ref-VtlfBSxG">
<p>83. <strong>Conventional Commits</strong> <br />
Conventional Commits<br />
<a href="https://www.conventionalcommits.org/en/v1.0.0/">https://www.conventionalcommits.org/en/v1.0.0/</a></p>
</div>
<div id="ref-uRbOUixg">
<p>84. <strong>GitHub CLI</strong> <br />
GitHub CLI<br />
<a href="https://cli.github.com/">https://cli.github.com/</a></p>
</div>
<div id="ref-jIIrCDT3">
<p>85. <strong>About issues</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/issues/tracking-your-work-with-issues/about-issues">https://docs.github.com/en/issues/tracking-your-work-with-issues/about-issues</a></p>
</div>
<div id="ref-E7mOdOEw">
<p>86. <strong>Unit Testing for R</strong> <a href="https://testthat.r-lib.org/">https://testthat.r-lib.org/</a></p>
</div>
<div id="ref-GYac9tBn">
<p>87. <strong>Combine API and UI Testing For Confidence At Every Layer Of Your Application</strong> <br />
smartbear.com<br />
<a href="https://smartbear.com/en/solutions/end-to-end-testing/">https://smartbear.com/en/solutions/end-to-end-testing/</a></p>
</div>
<div id="ref-ZNYSO1m0">
<p>88. <strong>Flake8: Your Tool For Style Guide Enforcement — flake8 4.0.1 documentation</strong> <a href="https://flake8.pycqa.org/en/latest/">https://flake8.pycqa.org/en/latest/</a></p>
</div>
<div id="ref-iFiB8Hir">
<p>89. <strong>Safety - Security for your Python dependencies</strong> <a href="https://pyup.io/safety/">https://pyup.io/safety/</a></p>
</div>
<div id="ref-T03Api6e">
<p>90. <strong>Continuous Integration and Delivery</strong> <br />
CircleCI<br />
<a href="https://circleci.com/">https://circleci.com/</a></p>
</div>
<div id="ref-FTO2RnTd">
<p>91. <strong>How to do a code review</strong> <br />
eng-practices<br />
<a href="https://google.github.io/eng-practices/review/reviewer/">https://google.github.io/eng-practices/review/reviewer/</a></p>
</div>
<div id="ref-HnmFW2rl">
<p>92. <strong>Code Review Guidelines for Humans</strong> <br />
Philipp Hauer<br />
<em>Philipp Hauer’s Blog</em> (2018-07-31) <a href="https://phauer.com/2018/code-review-guidelines/">https://phauer.com/2018/code-review-guidelines/</a></p>
</div>
<div id="ref-19KAPSMqo">
<p>93. <strong>FAIRshake</strong> <a href="https://fairshake.cloud/">https://fairshake.cloud/</a></p>
</div>
<div id="ref-Z6ni32OG">
<p>94. <strong>Zenodo - Research. Shared.</strong> <a href="https://zenodo.org/">https://zenodo.org/</a></p>
</div>
<div id="ref-1EMndz0j9">
<p>95. <strong>about figshare</strong> <a href="https://knowledge.figshare.com/about">https://knowledge.figshare.com/about</a></p>
</div>
<div id="ref-11GtZ7icJ">
<p>96. <strong>Git Large File Storage</strong> <br />
Git Large File Storage<br />
<a href="https://git-lfs.github.com/">https://git-lfs.github.com/</a></p>
</div>
<div id="ref-varWEBV8">
<p>97. <strong>About large files on GitHub</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/repositories/working-with-files/managing-large-files/about-large-files-on-github">https://docs.github.com/en/repositories/working-with-files/managing-large-files/about-large-files-on-github</a></p>
</div>
<div id="ref-YuJbg3zO">
<p>98. <strong>Open collaborative writing with Manubot</strong> <br />
Daniel S. Himmelstein, Vincent Rubinetti, David R. Slochower, Dongbo Hu, Venkat S. Malladi, Casey S. Greene, Anthony Gitter<br />
<em>PLOS Computational Biology</em> (2019-06-24) <a href="https://doi.org/c7np">https://doi.org/c7np</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1007128">10.1371/journal.pcbi.1007128</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31233491">31233491</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6611653">PMC6611653</a></p>
</div>
<div id="ref-16wWVekW1">
<p>99. <strong>Make a README</strong> <br />
Make a README<br />
<a href="https://www.makeareadme.com">https://www.makeareadme.com</a></p>
</div>
<div id="ref-nR2NTYy9">
<p>100. <strong>GitHub Pages</strong> <br />
GitHub Pages<br />
<a href="https://pages.github.com/">https://pages.github.com/</a></p>
</div>
<div id="ref-Lbp8MQSL">
<p>101. <strong>Licenses</strong> <br />
Choose a License<br />
<a href="https://choosealicense.com/licenses/">https://choosealicense.com/licenses/</a></p>
</div>
<div id="ref-146GfpGTF">
<p>102. <strong>Managing releases in a repository</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository">https://docs.github.com/en/repositories/releasing-projects-on-github/managing-releases-in-a-repository</a></p>
</div>
<div id="ref-13UfgtMhu">
<p>103. <strong>Semantic Versioning 2.0.0</strong> <br />
Tom Preston-Werner<br />
<em>Semantic Versioning</em> <a href="https://semver.org/">https://semver.org/</a></p>
</div>
<div id="ref-Mduzvxei">
<p>104. <strong>PyPI · The Python Package Index</strong> <br />
PyPI<br />
<a href="https://pypi.org/">https://pypi.org/</a></p>
</div>
<div id="ref-rWFDdwIs">
<p>105. <strong>The Comprehensive R Archive Network</strong> <a href="https://cran.r-project.org/">https://cran.r-project.org/</a></p>
</div>
<div id="ref-10CJ2sJo8">
<p>106. <strong>Bioconductor - Home</strong> <a href="https://www.bioconductor.org/">https://www.bioconductor.org/</a></p>
</div>
<div id="ref-AvIrTFAn">
<p>107. <strong>News — Bioconda documentation</strong> <a href="https://bioconda.github.io/">https://bioconda.github.io/</a></p>
</div>
<div id="ref-dk80YsaO">
<p>108. <strong>Dash Overview</strong> <a href="https://plotly.com/dash">https://plotly.com/dash</a></p>
</div>
<div id="ref-B0TdOflx">
<p>109. <strong>Shiny</strong> <a href="https://shiny.rstudio.com/">https://shiny.rstudio.com/</a></p>
</div>
<div id="ref-LSHekw4z">
<p>110. <strong>Daring Fireball: Markdown Syntax Documentation</strong> <a href="https://daringfireball.net/projects/markdown/syntax">https://daringfireball.net/projects/markdown/syntax</a></p>
</div>
<div id="ref-RPjXsSC8">
<p>111. <strong>reStructuredText</strong> (2021-10-22) <a href="https://docutils.sourceforge.io/rst.html">https://docutils.sourceforge.io/rst.html</a></p>
</div>
<div id="ref-woYMAGdl">
<p>112. <strong>Documentation System</strong> <a href="https://documentation.divio.com/">https://documentation.divio.com/</a></p>
</div>
<div id="ref-IsDZd09v">
<p>113. <strong>Python Docstrings</strong> <br />
GeeksforGeeks<br />
(2017-06-01) <a href="https://www.geeksforgeeks.org/python-docstrings/">https://www.geeksforgeeks.org/python-docstrings/</a></p>
</div>
<div id="ref-9HZXe8sx">
<p>114. <strong>Home | Read the Docs</strong> <a href="https://readthedocs.org/">https://readthedocs.org/</a></p>
</div>
<div id="ref-VjDIpAqq">
<p>115. <strong>GitBook - Where software teams break knowledge silos.</strong> <a href="https://www.gitbook.com/">https://www.gitbook.com/</a></p>
</div>
<div id="ref-FMzJsf3g">
<p>116. <strong>Home | Bookdown</strong> <a href="https://bookdown.org/home/">https://bookdown.org/home/</a></p>
</div>
<div id="ref-dvOzCOyW">
<p>117. <strong>GitHub - jazzband/pip-tools: A set of tools to keep your pinned Python dependencies fresh.</strong> <br />
GitHub<br />
<a href="https://github.com/jazzband/pip-tools">https://github.com/jazzband/pip-tools</a></p>
</div>
<div id="ref-rmvJ2O0Q">
<p>118. <strong>Home</strong> <br />
Docker<br />
<a href="https://www.docker.com/">https://www.docker.com/</a></p>
</div>
<div id="ref-99QkJBoF">
<p>119. <strong>Sylabs.io | Home</strong> <br />
Sylabs.io<br />
<a href="https://sylabs.io/">https://sylabs.io/</a></p>
</div>
<div id="ref-TOmDDCcd">
<p>120. <strong>What is Software Rot? - Definition from Techopedia</strong> <br />
Techopedia.com<br />
<a href="http://www.techopedia.com/definition/22202/software-rot">http://www.techopedia.com/definition/22202/software-rot</a></p>
</div>
<div id="ref-iXfPU3Cy">
<p>121. <strong>Gitter</strong> <a href="https://gitter.im/">https://gitter.im/</a></p>
</div>
<div id="ref-6v98AMba">
<p>122. <strong>Redirecting to Google Groups</strong> <a href="https://groups.google.com/forum/m">https://groups.google.com/forum/m</a></p>
</div>
<div id="ref-E0tpYdxU">
<p>123. <strong>GitHub Discussions Documentation</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/discussions">https://docs.github.com/en/discussions</a></p>
</div>
<div id="ref-5HELQ2ms">
<p>124. <strong>About issues</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/issues/tracking-your-work-with-issues/about-issues">https://docs.github.com/en/issues/tracking-your-work-with-issues/about-issues</a></p>
</div>
<div id="ref-ep7wwgWj">
<p>125. <strong>Setting guidelines for repository contributors</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/communities/setting-up-your-project-for-healthy-contributions/setting-guidelines-for-repository-contributors">https://docs.github.com/en/communities/setting-up-your-project-for-healthy-contributions/setting-guidelines-for-repository-contributors</a></p>
</div>
<div id="ref-pVl1NEXZ">
<p>126. <strong>About wikis</strong> <br />
GitHub Docs<br />
<a href="https://docs.github.com/en/communities/documenting-your-project-with-wikis/about-wikis">https://docs.github.com/en/communities/documenting-your-project-with-wikis/about-wikis</a></p>
</div>
<div id="ref-115FgZQh6">
<p>127. <strong>Contributor Covenant: A Code of Conduct for Open Source and Other Digital Commons Communities</strong> <a href="https://www.contributor-covenant.org/">https://www.contributor-covenant.org/</a></p>
</div>
<div id="ref-qcPNBi0h">
<p>128. <strong>policies/citizen_code_of_conduct.md at master · stumpsyn/policies</strong> <br />
GitHub<br />
<a href="https://github.com/stumpsyn/policies">https://github.com/stumpsyn/policies</a></p>
</div>
<div id="ref-1Ei7XPHmQ">
<p>129. <strong>A successful Git branching model</strong> <br />
nvie.com<br />
<a href="http://nvie.com/posts/a-successful-git-branching-model/">http://nvie.com/posts/a-successful-git-branching-model/</a></p>
</div>
<div id="ref-zcUBK27J">
<p>130. <strong>Kanban - A brief introduction</strong> <br />
Atlassian<br />
<em>Atlassian</em> <a href="https://www.atlassian.com/agile/kanban">https://www.atlassian.com/agile/kanban</a></p>
</div>
<div id="ref-ssoXtriL">
<p>131. <strong>GitHub Issues · Project planning for developers</strong> <br />
GitHub<br />
<a href="https://github.com/features/issues">https://github.com/features/issues</a></p>
</div>
<div id="ref-QrHcaBPj">
<p>132. <strong>Boards Timelines FAQ | GitKraken</strong> <a href="https://www.gitkraken.com/boards-and-timelines">https://www.gitkraken.com/boards-and-timelines</a></p>
</div>
<div id="ref-LLiWj74b">
<p>133. <strong>What is Scrum?</strong> <br />
Scrum.org<br />
<a href="https://www.scrum.org/resources/what-is-scrum">https://www.scrum.org/resources/what-is-scrum</a></p>
</div>
<div id="ref-rX7VZWos">
<p>134. <strong>ZenHub - Productivity Management for Software Teams</strong> <a href="https://www.zenhub.com/">https://www.zenhub.com/</a></p>
</div>
<div id="ref-a6SmwGuV">
<p>135. <strong>Jira | Issue &amp; Project Tracking Software</strong> <br />
Atlassian<br />
<em>Atlassian</em> <a href="https://www.atlassian.com/software/jira">https://www.atlassian.com/software/jira</a></p>
</div>
<div id="ref-qOcBF2oS">
<p>136. <strong>Manifesto for Agile Software Development</strong> <a href="https://agilemanifesto.org/">https://agilemanifesto.org/</a></p>
</div>
<div id="ref-1UVh4XJi">
<p>137. <strong>GitHub - c4urself/bump2version: Version-bump your software with a single command</strong> <br />
GitHub<br />
<a href="https://github.com/c4urself/bump2version">https://github.com/c4urself/bump2version</a></p>
</div>
<div id="ref-SXI7Canc">
<p>138. <strong>Danger - Stop Saying “You Forgot To…” in Code Review</strong> <br />
Orta Therox<br />
<a href="http://danger.systems/ruby/index.html">http://danger.systems/ruby/index.html</a></p>
</div>
<div id="ref-JKpPPQzZ">
<p>139. <strong>Git - Git Hooks</strong> <a href="https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks">https://git-scm.com/book/en/v2/Customizing-Git-Git-Hooks</a></p>
</div>
<div id="ref-qRqqDo0w">
<p>140. <strong>A complete reference genome improves analysis of human genetic variation</strong> <br />
Sergey Aganezov, Stephanie M. Yan, Daniela C. Soto, Melanie Kirsche, Samantha Zarate, Pavel Avdeyev, Dylan J. Taylor, Kishwar Shafin, Alaina Shumate, Chunlin Xiao, … Michael C. Schatz<br />
<em>Genomics</em> (2021-07-13) <a href="https://doi.org/gk6dwc">https://doi.org/gk6dwc</a> <br />
DOI: <a href="https://doi.org/10.1101/2021.07.12.452063">10.1101/2021.07.12.452063</a></p>
</div>
<div id="ref-ALU8zyix">
<p>141. <strong>Exponential scaling of single-cell RNA-seq in the past decade</strong> <br />
Valentine Svensson, Roser Vento-Tormo, Sarah A Teichmann<br />
<em>Nature Protocols</em> (2018-04) <a href="https://doi.org/gc5ndt">https://doi.org/gc5ndt</a> <br />
DOI: <a href="https://doi.org/10.1038/nprot.2017.149">10.1038/nprot.2017.149</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/29494575">29494575</a></p>
</div>
<div id="ref-KBoHN8e8">
<p>142. <strong>scAlign: a tool for alignment, integration, and rare cell identification from scRNA-seq data</strong> <br />
Nelson Johansen, Gerald Quon<br />
<em>Genome Biology</em> (2019-12) <a href="https://doi.org/gh5jhj">https://doi.org/gh5jhj</a> <br />
DOI: <a href="https://doi.org/10.1186/s13059-019-1766-4">10.1186/s13059-019-1766-4</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31412909">31412909</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6693154">PMC6693154</a></p>
</div>
<div id="ref-94lBUqNp">
<p>143. <strong>Constraint-based models predict metabolic and associated cellular functions</strong> <br />
Aarash Bordbar, Jonathan M. Monk, Zachary A. King, Bernhard O. Palsson<br />
<em>Nature Reviews Genetics</em> (2014-02) <a href="https://doi.org/f5sk8s">https://doi.org/f5sk8s</a> <br />
DOI: <a href="https://doi.org/10.1038/nrg3643">10.1038/nrg3643</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24430943">24430943</a></p>
</div>
<div id="ref-cieXgNg">
<p>144. <strong>COBRApy: COnstraints-Based Reconstruction and Analysis for Python</strong> <br />
Ali Ebrahim, Joshua A Lerman, Bernhard O Palsson, Daniel R Hyduke<br />
<em>BMC Systems Biology</em> (2013-12) <a href="https://doi.org/gb3qmh">https://doi.org/gb3qmh</a> <br />
DOI: <a href="https://doi.org/10.1186/1752-0509-7-74">10.1186/1752-0509-7-74</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/23927696">23927696</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3751080">PMC3751080</a></p>
</div>
<div id="ref-1DX19gjFK">
<p>145. <strong>RNA sequencing: the teenage years</strong> <br />
Rory Stark, Marta Grzelak, James Hadfield<br />
<em>Nature Reviews Genetics</em> (2019-11) <a href="https://doi.org/gf6vfx">https://doi.org/gf6vfx</a> <br />
DOI: <a href="https://doi.org/10.1038/s41576-019-0150-2">10.1038/s41576-019-0150-2</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31341269">31341269</a></p>
</div>
<div id="ref-31ZBzbN6">
<p>146. <strong>Genome-scale metabolic modelling of P. thermoglucosidasius NCIMB 11955 reveals metabolic bottlenecks in anaerobic metabolism.</strong> <br />
Viviënne Mol, Martyn Bennett, Benjamín J. Sánchez, Beata K. Lisowska, Markus J. Herrgård, Alex Toftgaard Nielsen, David J Leak, Nikolaus Sonnenschein<br />
<em>Microbiology</em> (2021-02-01) <a href="https://doi.org/gh4s89">https://doi.org/gh4s89</a> <br />
DOI: <a href="https://doi.org/10.1101/2021.02.01.429138">10.1101/2021.02.01.429138</a></p>
</div>
<div id="ref-1GXDCoupc">
<p>147. <strong>A systematic assessment of current genome-scale metabolic reconstruction tools</strong> <br />
Sebastián N. Mendoza, Brett G. Olivier, Douwe Molenaar, Bas Teusink<br />
<em>Genome Biology</em> (2019-12) <a href="https://doi.org/gh3pjm">https://doi.org/gh3pjm</a> <br />
DOI: <a href="https://doi.org/10.1186/s13059-019-1769-1">10.1186/s13059-019-1769-1</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31391098">31391098</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6685185">PMC6685185</a></p>
</div>
<div id="ref-14iHcKBb7">
<p>148. <strong>MEMOTE for standardized genome-scale metabolic model testing</strong> <br />
Christian Lieven, Moritz E. Beber, Brett G. Olivier, Frank T. Bergmann, Meric Ataman, Parizad Babaei, Jennifer A. Bartell, Lars M. Blank, Siddharth Chauhan, Kevin Correia, … Cheng Zhang<br />
<em>Nature Biotechnology</em> (2020-03-01) <a href="https://doi.org/gh4s88">https://doi.org/gh4s88</a> <br />
DOI: <a href="https://doi.org/10.1038/s41587-020-0446-y">10.1038/s41587-020-0446-y</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32123384">32123384</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7082222">PMC7082222</a></p>
</div>
</div>
<h2 id="supplementary-material">Supplementary Material</h2>
<h3 id="additional-case-study-1-rna-seq-differential-gene-expression">Additional case study 1: RNA-seq differential gene expression</h3>
<p>Differential gene expression (DGE) analysis is a routine research tool in the field of functional genomics. Its main goal is to determine quantitative changes in gene expression levels between different experimental conditions or different populations. Nowadays, given the availability of NGS technologies, most DGE analysis are based on RNA-seq data, being the primary application of the technology <span class="citation" data-cites="1DX19gjFK">[<a href="#ref-1DX19gjFK" role="doc-biblioref">145</a>]</span>. Here, we will consider a study designed to gain insights regarding a specific condition of interest, leading to interest genes that can be functionally characterized in animal models afterwards. The experimental setup included a control group and an experimental group with the condition of interest, both sequenced using RNA-seq. The experiment was conducted four times independently to get four replicates per group.</p>
<p>In this example, the most relevant part is personal research. Following this work’s framework, the first step is to decide which programming languages to use. Considering that the bioinformatics analysis will include a first step performed in the command line—where read will be trimmed and aligned to a reference transcriptome, and the number of reads per transcripts will be counted—followed by a second step for data filtering and statistical analysis, the programming languages to use will be Shell and R. The folder structure must have separated spaces for raw data, results, documentation and scripts used in the analysis. We recommend to clone the RR-init template into our HPC since a simple structure will suffice. For this project, the best option will be to use a Conda environment with R installed, where we can download packages from Bioconductor and Bioconda. A bash script written in Emacs will be a suitable option for the first step in the HPC, and R Studio for the second part of analysis and visualization. We advice to follow literate programming, especially when writing R code, and to track changes using Git.</p>
<h3 id="additional-case-study-2-genome-scale-metabolic-model">Additional case study 2: Genome-scale metabolic model</h3>
<p>A sub group of constraint-based models (<a href="#case-study-3-tool-development-for-constraint-based-modeling">Case Study 3</a>) are genome-scale metabolic models, where the model represents the complete metabolism of a cell, inferred from genome sequencing. These models are significantly larger in size, making the model generation and curation steps hard to trace back if we don’t use adequate tools. As a reference paper, consider the generation, curation and validation of a genome-scale model for <em>Parageobacillus thermoglucosidasius</em> <span class="citation" data-cites="31ZBzbN6">[<a href="#ref-31ZBzbN6" role="doc-biblioref">146</a>]</span>, a thermophilic facultative anaerobic bacteria with promising traits for industrial metabolic engineering.</p>
<p>The first step in a project of this nature is to use one of the many reconstruction algorithms available <span class="citation" data-cites="1GXDCoupc">[<a href="#ref-1GXDCoupc" role="doc-biblioref">147</a>]</span> to start from what is referred to as a draft reconstruction; therefore, the choice of programming language for that section will depend on the selected algorithm. After that, there is a lengthy step of model curation and gap filling, in order to end up with a model that can produce all necessary building blocks of the cell. For this step we recommend a basic setup of Python as programming language and Conda as environment manager, due to their ease of use and the growing number of Python packages being developed in the field. Additionally, we advice using Jupyter Notebook as main working setup and Git for version control, as you can use different notebooks (or different versions of a notebook) as logs of analysis performed on your working draft. When collaborating, tools that will be especially useful while working on a genome-scale model are unit-testing, to ensure your model maintains a certain quality as you and others develop it <span class="citation" data-cites="14iHcKBb7">[<a href="#ref-14iHcKBb7" role="doc-biblioref">148</a>]</span>, and ReviewNB, to keep track of changes in notebooks across commits and/or branches. Finally, when sharing the model within the community, Zenodo is a great option for defining different versions of the model, and any issue tracker will make it possible for users to pinpoint mathematical or biological inconsistencies in the network.</p>
<!-- default theme -->

<style>
    /* import google fonts */
    @import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700");
    @import url("https://fonts.googleapis.com/css?family=Source+Code+Pro");

    /* -------------------------------------------------- */
    /* global */
    /* -------------------------------------------------- */

    /* all elements */
    * {
        /* force sans-serif font unless specified otherwise */
        font-family: "Open Sans", "Helvetica", sans-serif;

        /* prevent text inflation on some mobile browsers */
        -webkit-text-size-adjust: none !important;
        -moz-text-size-adjust: none !important;
        -o-text-size-adjust: none !important;
        text-size-adjust: none !important;
    }

    @media only screen {
        /* "page" element */
        body {
            position: relative;
            box-sizing: border-box;
            font-size: 12pt;
            line-height: 1.5;
            max-width: 8.5in;
            margin: 20px auto;
            padding: 40px;
            border-radius: 5px;
            border: solid 1px #bdbdbd;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            background: #ffffff;
        }
    }

    /* when on screen < 8.5in wide */
    @media only screen and (max-width: 8.5in) {
        /* "page" element */
        body {
            padding: 20px;
            margin: 0;
            border-radius: 0;
            border: none;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05) inset;
            background: none;
        }
    }

    /* -------------------------------------------------- */
    /* headings */
    /* -------------------------------------------------- */

    /* all headings */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        margin: 20px 0;
        padding: 0;
        font-weight: bold;
    }

    /* biggest heading */
    h1 {
        margin: 40px 0;
        text-align: center;
    }

    /* second biggest heading */
    h2 {
        margin-top: 30px;
        padding-bottom: 5px;
        border-bottom: solid 1px #bdbdbd;
    }

    /* heading font sizes */
    h1 {
        font-size: 2em;
    }
    h2 {
        font-size: 1.5em;
    }
    h3{
        font-size: 1.35em;
    }
    h4 {
        font-size: 1.25em;
    }
    h5 {
        font-size: 1.15em;
    }
    h6 {
        font-size: 1em;
    }

    /* -------------------------------------------------- */
    /* manuscript header */
    /* -------------------------------------------------- */

    /* manuscript title */
    header > h1 {
        margin: 0;
    }

    /* manuscript title caption text (ie "automatically generated on") */
    header + p {
        text-align: center;
        margin-top: 10px;
    }

    /* -------------------------------------------------- */
    /* text elements */
    /* -------------------------------------------------- */

    /* links */
    a {
        color: #2196f3;
        overflow-wrap: break-word;
    }

    /* normal links (not empty, not button link, not syntax highlighting link) */
    a:not(:empty):not(.button):not(.sourceLine) {
        padding-left: 1px;
        padding-right: 1px;
    }

    /* superscripts and subscripts */
    sub,
    sup {
        /* prevent from affecting line height */
        line-height: 0;
    }

    /* unordered and ordered lists*/
    ul,
    ol {
        padding-left: 20px;
    }

    /* class for styling text semibold */
    .semibold {
        font-weight: 600;
    }

    /* class for styling elements horizontally left aligned */
    .left {
        display: block;
        text-align: left;
        margin-left: auto;
        margin-right: 0;
        justify-content: left;
    }

    /* class for styling elements horizontally centered */
    .center {
        display: block;
        text-align: center;
        margin-left: auto;
        margin-right: auto;
        justify-content: center;
    }

    /* class for styling elements horizontally right aligned */
    .right {
        display: block;
        text-align: right;
        margin-left: 0;
        margin-right: auto;
        justify-content: right;
    }

    /* -------------------------------------------------- */
    /* section elements */
    /* -------------------------------------------------- */

    /* horizontal divider line */
    hr {
        border: none;
        height: 1px;
        background: #bdbdbd;
    }

    /* paragraphs, horizontal dividers, figures, tables, code */
    p,
    hr,
    figure,
    table,
    pre {
        /* treat all as "paragraphs", with consistent vertical margins */
        margin-top: 20px;
        margin-bottom: 20px;
    }

    /* -------------------------------------------------- */
    /* figures */
    /* -------------------------------------------------- */

    /* figure */
    figure {
        max-width: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    /* figure caption */
    figcaption {
        padding: 0;
        padding-top: 10px;
    }

    /* figure image element */
    figure > img,
    figure > svg {
        max-width: 100%;
        display: block;
        margin-left: auto;
        margin-right: auto;
    }

    /* figure auto-number */
    img + figcaption > span:first-of-type,
    svg + figcaption > span:first-of-type {
        font-weight: bold;
        margin-right: 5px;
    }

    /* -------------------------------------------------- */
    /* tables */
    /* -------------------------------------------------- */

    /* table */
    table {
        border-collapse: collapse;
        border-spacing: 0;
        width: 100%;
        margin-left: auto;
        margin-right: auto;
    }

    /* table cells */
    th,
    td {
        border: solid 1px #bdbdbd;
        padding: 10px;
        /* squash table if too wide for page by forcing line breaks */
        overflow-wrap: break-word;
        word-break: break-word;
    }

    /* header row and even rows */
    th,
    tr:nth-child(2n) {
        background-color: #fafafa;
    }

    /* odd rows */
    tr:nth-child(2n + 1) {
        background-color: #ffffff;
    }

    /* table caption */
    caption {
        text-align: left;
        padding: 0;
        padding-bottom: 10px;
    }

    /* table auto-number */
    table > caption > span:first-of-type,
    div.table_wrapper > table > caption > span:first-of-type {
        font-weight: bold;
        margin-right: 5px;
    }

    /* -------------------------------------------------- */
    /* code */
    /* -------------------------------------------------- */

    /* multi-line code block */
    pre {
        padding: 10px;
        background-color: #eeeeee;
        color: #000000;
        border-radius: 5px;
        break-inside: avoid;
        text-align: left;
    }

    /* inline code, ie code within normal text */
    :not(pre) > code {
        padding: 0 4px;
        background-color: #eeeeee;
        color: #000000;
        border-radius: 5px;
    }

    /* code text */
    /* apply all children, to reach syntax highlighting sub-elements */
    code,
    code * {
        /* force monospace font */
        font-family: "Source Code Pro", "Courier New", monospace;
    }

    /* -------------------------------------------------- */
    /* quotes */
    /* -------------------------------------------------- */

    /* quoted text */
    blockquote {
        margin: 0;
        padding: 0;
        border-left: 4px solid #bdbdbd;
        padding-left: 16px;
        break-inside: avoid;
    }

    /* -------------------------------------------------- */
    /* banners */
    /* -------------------------------------------------- */

    /* info banners */
    .banner {
        box-sizing: border-box;
        display: block;
        position: relative;
        width: 100%;
        margin-top: 20px;
        margin-bottom: 20px;
        padding: 20px;
        text-align: center;
    }

    /* paragraph in banner */
    .banner > p {
        margin: 0;
    }

    /* -------------------------------------------------- */
    /* highlight colors */
    /* -------------------------------------------------- */

    .white {
        background: #ffffff;
    }
    .lightgrey {
        background: #eeeeee;
    }
    .grey {
        background: #757575;
    }
    .darkgrey {
        background: #424242;
    }
    .black {
        background: #000000;
    }
    .lightred {
        background: #ffcdd2;
    }
    .lightyellow {
        background: #ffecb3;
    }
    .lightgreen {
        background: #dcedc8;
    }
    .lightblue {
        background: #e3f2fd;
    }
    .lightpurple {
        background: #f3e5f5;
    }
    .red {
        background: #f44336;
    }
    .orange {
        background: #ff9800;
    }
    .yellow {
        background: #ffeb3b;
    }
    .green {
        background: #4caf50;
    }
    .blue {
        background: #2196f3;
    }
    .purple {
        background: #9c27b0;
    }
    .white,
    .lightgrey,
    .lightred,
    .lightyellow,
    .lightgreen,
    .lightblue,
    .lightpurple,
    .orange,
    .yellow,
    .white a,
    .lightgrey a,
    .lightred a,
    .lightyellow a,
    .lightgreen a,
    .lightblue a,
    .lightpurple a,
    .orange a,
    .yellow a {
        color: #000000;
    }
    .grey,
    .darkgrey,
    .black,
    .red,
    .green,
    .blue,
    .purple,
    .grey a,
    .darkgrey a,
    .black a,
    .red a,
    .green a,
    .blue a,
    .purple a {
        color: #ffffff;
    }

    /* -------------------------------------------------- */
    /* buttons */
    /* -------------------------------------------------- */

    /* class for styling links like buttons */
    .button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        margin: 5px;
        padding: 10px 20px;
        font-size: 0.75em;
        font-weight: 600;
        text-transform: uppercase;
        text-decoration: none;
        letter-spacing: 1px;
        background: none;
        color: #2196f3;
        border: solid 1px #bdbdbd;
        border-radius: 5px;
    }

    /* buttons when hovered */
    .button:hover:not([disabled]),
    .icon_button:hover:not([disabled]) {
        cursor: pointer;
        background: #f5f5f5;
    }

    /* buttons when disabled */
    .button[disabled],
    .icon_button[disabled] {
        opacity: 0.35;
        pointer-events: none;
    }

    /* class for styling buttons containg only single icon */
    .icon_button {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        text-decoration: none;
        margin: 0;
        padding: 0;
        background: none;
        border-radius: 5px;
        border: none;
        width: 20px;
        height: 20px;
        min-width: 20px;
        min-height: 20px;
    }

    /* icon button inner svg image */
    .icon_button > svg {
        height: 16px;
    }

    /* -------------------------------------------------- */
    /* icons */
    /* -------------------------------------------------- */

    /* class for styling icons inline with text */
    .inline_icon {
        height: 1em;
        position: relative;
        top: 0.125em;
    }

    /* -------------------------------------------------- */
    /* print control */
    /* -------------------------------------------------- */

    @media print {
        @page {
            /* suggested printing margin */
            margin: 0.5in;
        }

        /* document and "page" elements */
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
        }

        /* "page" element */
        body {
            font-size: 11pt !important;
            line-height: 1.35;
        }

        /* all headings */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            margin: 15px 0;
        }

        /* figures and tables */
        figure, table {
            font-size: 0.85em;
        }

        /* table cells */
        th,
        td {
            padding: 5px;
        }

        /* shrink font awesome icons */
        i.fas,
        i.fab,
        i.far,
        i.fal {
            transform: scale(0.85);
        }

        /* decrease banner margins */
        .banner {
            margin-top: 15px;
            margin-bottom: 15px;
            padding: 15px;
        }

        /* class for centering an element vertically on its own page */
        .page_center {
            margin: auto;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            vertical-align: middle;
            break-before: page;
            break-after: page;
        }

        /* always insert a page break before the element */
        .page_break_before {
            break-before: page;
        }

        /* always insert a page break after the element */
        .page_break_after {
            break-after: page;
        }

        /* avoid page break before the element */
        .page_break_before_avoid {
            break-before: avoid;
        }

        /* avoid page break after the element */
        .page_break_after_avoid {
            break-after: avoid;
        }

        /* avoid page break inside the element */
        .page_break_inside_avoid {
            break-inside: avoid;
        }
    }

    /* -------------------------------------------------- */
    /* override pandoc css quirks */
    /* -------------------------------------------------- */

    .sourceCode {
        /* prevent unsightly overflow in wide code blocks */
        overflow: auto !important;
    }

    div.sourceCode {
        /* prevent background fill on top-most code block  container */
        background: none !important;
    }

    .sourceCode * {
        /* force consistent line spacing */
        line-height: 1.5 !important;
    }

    div.sourceCode {
        /* style code block margins same as <pre> element */
        margin-top: 20px;
        margin-bottom: 20px;
    }

    /* -------------------------------------------------- */
    /* tablenos */
    /* -------------------------------------------------- */

    /* tablenos wrapper */
    .tablenos {
        /* show scrollbar on tables if necessary to prevent overflow */
        width: 100%;
        margin: 20px 0;
    }

    .tablenos > table {
        /* move margins from table to table_wrapper to allow margin collapsing */
        margin: 0;
    }

    @media only screen {
        /* tablenos wrapper */
        .tablenos {
            /* show scrollbar on tables if necessary to prevent overflow */
            overflow-x: auto !important;
        }

        .tablenos th,
        .tablenos td {
            overflow-wrap: unset !important;
            word-break: unset !important;
        }

        /* table in wrapper */
        .tablenos table,
        .tablenos table * {
            /* don't break table words */
            overflow-wrap: normal !important;
        }
    }

    /* -------------------------------------------------- */
    /* mathjax */
    /* -------------------------------------------------- */

    /* mathjax containers */
    .math.display > span:not(.MathJax_Preview) {
        /* turn inline element (no dimensions) into block (allows fixed width and thus scrolling) */
        display: flex !important;
        overflow-x: auto !important;
        overflow-y: hidden !important;
        justify-content: center;
        align-items: center;
        margin: 0 !important;
    }

    /* right click menu */
    .MathJax_Menu {
        border-radius: 5px !important;
        border: solid 1px #bdbdbd !important;
        box-shadow: none !important;
    }

    /* equation auto-number */
    span[id^="eq:"] > span.math.display + span {
        font-weight: 600;
    }

    /* equation */
    span[id^="eq:"] > span.math.display > span {
        /* nudge to make room for equation auto-number and anchor */
        margin-right: 60px !important;
    }

    /* -------------------------------------------------- */
    /* anchors plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* anchor button */
        .anchor {
            opacity: 0;
            margin-left: 5px;
        }

        /* anchor buttons within <h2>'s */
        h2 .anchor {
            margin-left: 10px;
        }

        /* anchor buttons when hovered/focused and anything containing an anchor button when hovered */
        *:hover > .anchor,
        .anchor:hover,
        .anchor:focus {
            opacity: 1;
        }

        /* anchor button when hovered */
        .anchor:hover {
            cursor: pointer;
        }
    }

    /* always show anchor button on devices with no mouse/hover ability */
    @media (hover: none) {
        .anchor {
            opacity: 1;
        }
    }

    /* always hide anchor button on print */
    @media only print {
        .anchor {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* accordion plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* accordion arrow button */
        .accordion_arrow {
            margin-right: 10px;
        }

        /* arrow icon when <h2> data-collapsed attribute true */
        h2[data-collapsed="true"] > .accordion_arrow > svg {
            transform: rotate(-90deg);
        }

        /* all elements (except <h2>'s) when data-collapsed attribute true */
        *:not(h2)[data-collapsed="true"] {
            display: none;
        }

        /* accordion arrow button when hovered and <h2>'s when hovered */
        .accordion_arrow:hover,
        h2[data-collapsed="true"]:hover,
        h2[data-collapsed="false"]:hover {
            cursor: pointer;
        }
    }

    /* always hide accordion arrow button on print */
    @media only print {
        .accordion_arrow {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* tooltips plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* tooltip container */
        #tooltip {
            position: absolute;
            width: 50%;
            min-width: 240px;
            max-width: 75%;
            z-index: 1;
        }

        /* tooltip content */
        #tooltip_content {
            margin-bottom: 5px;
            padding: 20px;
            border-radius: 5px;
            border: solid 1px #bdbdbd;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            background: #ffffff;
            overflow-wrap: break-word;
        }

        /* tooltip copy of paragraphs and figures */
        #tooltip_content > p,
        #tooltip_content > figure {
            margin: 0;
            max-height: 320px;
            overflow-y: auto;
        }

        /* tooltip copy of <img> */
        #tooltip_content > figure > img,
        #tooltip_content > figure > svg {
            max-height: 260px;
        }

        /* navigation bar */
        #tooltip_nav_bar {
            margin-top: 10px;
            text-align: center;
        }

        /* navigation bar previous/next buton */
        #tooltip_nav_bar > .icon_button {
            position: relative;
            top: 3px;
        }

        /* navigation bar previous button */
        #tooltip_nav_bar > .icon_button:first-of-type {
            margin-right: 5px;
        }

        /* navigation bar next button */
        #tooltip_nav_bar > .icon_button:last-of-type {
            margin-left: 5px;
        }
    }

    /* always hide tooltip on print */
    @media only print {
        #tooltip {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* jump to first plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* jump button */
        .jump_arrow {
            position: relative;
            top: 0.125em;
            margin-right: 5px;
        }
    }

    /* always hide jump button on print */
    @media only print {
        .jump_arrow {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* link highlight plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* anything with data-highlighted attribute true */
        [data-highlighted="true"] {
            background: #ffeb3b;
        }

        /* anything with data-selected attribute true */
        [data-selected="true"] {
            background: #ff8a65 !important;
        }

        /* animation definition for glow */
        @keyframes highlight_glow {
            0% {
                background: none;
            }
            10% {
                background: #bbdefb;
            }
            100% {
                background: none;
            }
        }

        /* anything with data-glow attribute true */
        [data-glow="true"] {
            animation: highlight_glow 2s;
        }
    }

    /* -------------------------------------------------- */
    /* table of contents plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* toc panel */
        #toc_panel {
            box-sizing: border-box;
            position: fixed;
            top: 0;
            left: 0;
            background: #ffffff;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
            z-index: 2;
        }

        /* toc panel when closed */
        #toc_panel[data-open="false"] {
            min-width: 60px;
            width: 60px;
            height: 60px;
            border-right: solid 1px #bdbdbd;
            border-bottom: solid 1px #bdbdbd;
        }

        /* toc panel when open */
        #toc_panel[data-open="true"] {
            min-width: 260px;
            max-width: 480px;
            /* keep panel edge consistent distance away from "page" edge */
            width: calc(((100vw - 8.5in) / 2) - 30px - 40px);
            bottom: 0;
            border-right: solid 1px #bdbdbd;
        }

        /* toc panel header */
        #toc_header {
            box-sizing: border-box;
            display: flex;
            flex-direction: row;
            align-items: center;
            height: 60px;
            margin: 0;
            padding: 20px;
        }

        /* toc panel header when hovered */
        #toc_header:hover {
            cursor: pointer;
        }

        /* toc panel header when panel open */
        #toc_panel[data-open="true"] > #toc_header {
            border-bottom: solid 1px #bdbdbd;
        }

        /* toc open/close header button */
        #toc_button {
            margin-right: 20px;
        }

        /* hide toc list and header text when closed */
        #toc_panel[data-open="false"] > #toc_header > *:not(#toc_button),
        #toc_panel[data-open="false"] > #toc_list {
            display: none;
        }

        /* toc list of entries */
        #toc_list {
            box-sizing: border-box;
            width: 100%;
            padding: 20px;
            position: absolute;
            top: calc(60px + 1px);
            bottom: 0;
            overflow: auto;
        }

        /* toc entry, link to section in document */
        .toc_link {
            display: block;
            padding: 5px;
            position: relative;
            font-weight: 600;
            text-decoration: none;
        }

        /* toc entry when hovered or when "viewed" */
        .toc_link:hover,
        .toc_link[data-viewing="true"] {
            background: #f5f5f5;
        }

        /* toc entry, level 1 indentation */
        .toc_link[data-level="1"] {
            margin-left: 0;
        }

        /* toc entry, level 2 indentation */
        .toc_link[data-level="2"] {
            margin-left: 20px;
        }

        /* toc entry, level 3 indentation */
        .toc_link[data-level="3"] {
            margin-left: 40px;
        }

        /* toc entry, level 4 indentation */
        .toc_link[data-level="4"] {
            margin-left: 60px;
        }

        /* toc entry bullets */
        #toc_panel[data-bullets="true"] .toc_link[data-level]:before {
            position: absolute;
            left: -15px;
            top: -1px;
            font-size: 1.5em;
        }

        /* toc entry, level 2 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="2"]:before {
            content: "\2022";
        }

        /* toc entry, level 3 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="3"]:before {
            content: "\25AB";
        }

        /* toc entry, level 4 bullet */
        #toc_panel[data-bullets="true"] .toc_link[data-level="4"]:before {
            content: "-";
        }
    }

    /* when on screen < 8.5in wide */
    @media only screen and (max-width: 8.5in) {
        /* push <body> ("page") element down to make room for toc icon */
        .toc_body_nudge {
            padding-top: 60px;
        }

        /* toc icon when panel closed and not hovered */
        #toc_panel[data-open="false"]:not(:hover) {
            background: rgba(255, 255, 255, 0.75);
        }
    }

    /* always hide toc panel on print */
    @media only print {
        #toc_panel {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* lightbox plugin */
    /* -------------------------------------------------- */

    @media only screen {
        /* regular <img> in document when hovered */
        img.lightbox_document_img:hover {
            cursor: pointer;
        }

        .body_no_scroll {
            overflow: hidden !important;
        }

        /* screen overlay */
        #lightbox_overlay {
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.75);
            z-index: 3;
        }

        /* middle area containing lightbox image */
        #lightbox_image_container {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
            padding: 20px;
        }

        /* bottom area containing caption */
        #lightbox_bottom_container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100px;
            min-height: 100px;
            max-height: 100px;
            background: rgba(0, 0, 0, 0.5);
        }

        /* image number info text box */
        #lightbox_number_info {
            position: absolute;
            color: #ffffff;
            font-weight: 600;
            left: 2px;
            top: 0;
            z-index: 4;
        }

        /* zoom info text box */
        #lightbox_zoom_info {
            position: absolute;
            color: #ffffff;
            font-weight: 600;
            right: 2px;
            top: 0;
            z-index: 4;
        }

        /* copy of image caption */
        #lightbox_caption {
            box-sizing: border-box;
            display: inline-block;
            width: 100%;
            max-height: 100%;
            padding: 10px 0;
            text-align: center;
            overflow-y: auto;
            color: #ffffff;
        }

        /* navigation previous/next button */
        .lightbox_button {
            width: 100px;
            height: 100%;
            min-width: 100px;
            min-height: 100%;
            color: #ffffff;
        }

        /* navigation previous/next button when hovered */
        .lightbox_button:hover {
            background: none !important;
        }

        /* navigation button icon */
        .lightbox_button > svg {
            height: 25px;
        }

        /* figure auto-number */
        #lightbox_caption > span:first-of-type {
            font-weight: bold;
            margin-right: 5px;
        }

        /* lightbox image when hovered */
        #lightbox_img:hover {
            cursor: grab;
        }

        /* lightbox image when grabbed */
        #lightbox_img:active {
            cursor: grabbing;
        }
    }

    /* when on screen < 480px wide */
    @media only screen and (max-width: 480px) {
        /* make navigation buttons skinnier on small screens to make more room for caption text */
        .lightbox_button {
            width: 50px;
            min-width: 50px;
        }
    }

    /* always hide lightbox on print */
    @media only print {
        #lightbox_overlay {
            display: none;
        }
    }

    /* -------------------------------------------------- */
    /* hypothesis (annotations) plugin */
    /* -------------------------------------------------- */

    /* hypothesis activation button */
    #hypothesis_button {
        box-sizing: border-box;
        position: fixed;
        top: 0;
        right: 0;
        width: 60px;
        height: 60px;
        background: #ffffff;
        border-radius: 0;
        border-left: solid 1px #bdbdbd;
        border-bottom: solid 1px #bdbdbd;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
        z-index: 2;
    }

    /* hypothesis button svg */
    #hypothesis_button > svg {
        position: relative;
        top: -4px;
    }

    /* hypothesis annotation count */
    #hypothesis_count {
        position: absolute;
        left: 0;
        right: 0;
        bottom: 5px;
    }

    /* side panel */
    .annotator-frame {
        width: 280px !important;
    }

    /* match highlight color to rest of theme */
    .annotator-highlights-always-on .annotator-hl {
        background-color: #ffeb3b !important;
    }

    /* match focused color to rest of theme */
    .annotator-hl.annotator-hl-focused {
        background-color: #ff8a65 !important;
    }

    /* match bucket bar color to rest of theme */
    .annotator-bucket-bar {
        background: #f5f5f5 !important;
    }

    /* always hide button, toolbar, and tooltip on print */
    @media only print {
        #hypothesis_button {
            display: none;
        }

        .annotator-frame {
            display: none !important;
        }

        hypothesis-adder {
            display: none !important;
        }
    }
</style>
<!-- anchors plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin adds an anchor next to each of a certain type
        // of element that provides a human-readable url to that specific
        // item/position in the document (eg "manuscript.html#abstract"). It
        // also makes it such that scrolling out of view of a target removes
        // its identifier from the url.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'anchors';

        // default plugin options
        const options = {
            // which types of elements to add anchors next to, in
            // "document.querySelector" format
            typesQuery: 'h1, h2, h3, [id^="fig:"], [id^="tbl:"], [id^="eq:"]',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // add anchor to each element of specified types
            const elements = document.querySelectorAll(options.typesQuery);
            for (const element of elements)
                addAnchor(element);

            // attach scroll listener to window
            window.addEventListener('scroll', onScroll);
        }

        // when window is scrolled
        function onScroll() {
            // if url has hash and user has scrolled out of view of hash
            // target, remove hash from url
            const tolerance = 100;
            const target = getHashTarget();
            if (target) {
                if (
                    target.getBoundingClientRect().top >
                        window.innerHeight + tolerance ||
                    target.getBoundingClientRect().bottom < 0 - tolerance
                )
                    history.pushState(null, null, ' ');
            }
        }

        // add anchor to element
        function addAnchor(element) {
            let addTo; // element to add anchor button to

            // if figure or table, modify withId and addTo to get expected
            // elements
            if (element.id.indexOf('fig:') === 0) {
                addTo = element.querySelector('figcaption');
            } else if (element.id.indexOf('tbl:') === 0) {
                addTo = element.querySelector('caption');
            } else if (element.id.indexOf('eq:') === 0) {
                addTo = element.querySelector('.eqnos-number');
            }

            addTo = addTo || element;
            const id = element.id || null;

            // do not add anchor if element doesn't have assigned id.
            // id is generated by pandoc and is assumed to be unique and
            // human-readable
            if (!id)
                return;

            // create anchor button
            const anchor = document.createElement('a');
            anchor.innerHTML = document.querySelector('.icon_link').innerHTML;
            anchor.title = 'Link to this part of the document';
            anchor.classList.add('icon_button', 'anchor');
            anchor.dataset.ignore = 'true';
            anchor.href = '#' + id;
            addTo.appendChild(anchor);
        }

        // get element that is target of link or url hash
        function getHashTarget() {
            const hash = window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if figure or table, modify target to get expected element
            if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');
            if (id.indexOf('tbl:') === 0)
                target = target.querySelector('table');

            return target;
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- link icon -->

<template class="icon_link">
    <!-- modified from: https://fontawesome.com/icons/link -->
    <svg width="16" height="16" viewBox="0 0 512 512">
        <path
            fill="currentColor"
            d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"
        ></path>
    </svg>
</template>
<!-- accordion plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin allows sections of content under <h2> headings
        // to be collapsible.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'accordion';

        // default plugin options
        const options = {
            // whether to always start expanded ('false'), always start
            // collapsed ('true'), or start collapsed when screen small ('auto')
            startCollapsed: 'auto',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // run through each <h2> heading
            const headings = document.querySelectorAll('h2');
            for (const heading of headings) {
                addArrow(heading);

                // start expanded/collapsed based on option
                if (
                    options.startCollapsed === 'true' ||
                    (options.startCollapsed === 'auto' && isSmallScreen())
                )
                    collapseHeading(heading);
                else
                    expandHeading(heading);
            }

            // attach hash change listener to window
            window.addEventListener('hashchange', onHashChange);
        }

        // when hash (eg manuscript.html#introduction) changes
        function onHashChange() {
            const target = getHashTarget();
            if (target)
                goToElement(target);
        }

        // add arrow to heading
        function addArrow(heading) {
            // add arrow button
            const arrow = document.createElement('button');
            arrow.innerHTML = document.querySelector(
                '.icon_angle_down'
            ).innerHTML;
            arrow.classList.add('icon_button', 'accordion_arrow');
            heading.insertBefore(arrow, heading.firstChild);

            // attach click listener to heading and button
            heading.addEventListener('click', onHeadingClick);
            arrow.addEventListener('click', onArrowClick);
        }

        // determine if on mobile-like device with small screen
        function isSmallScreen() {
            return Math.min(window.innerWidth, window.innerHeight) < 480;
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // get element that is target of hash
        function getHashTarget(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if figure or table, modify target to get expected element
            if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');
            if (id.indexOf('tbl:') === 0)
                target = target.querySelector('table');

            return target;
        }

        // when <h2> heading is clicked
        function onHeadingClick(event) {
            // only collapse if <h2> itself is target of click (eg, user did
            // not click on anchor within <h2>)
            if (event.target === this)
                toggleCollapse(this);
        }

        // when arrow button is clicked
        function onArrowClick() {
            toggleCollapse(this.parentNode);
        }

        // collapse section if expanded, expand if collapsed
        function toggleCollapse(heading) {
            if (heading.dataset.collapsed === 'false')
                collapseHeading(heading);
            else
                expandHeading(heading);
        }

        // elements to exclude from collapse, such as table of contents panel,
        // hypothesis panel, etc
        const exclude = '#toc_panel, div.annotator-frame, #lightbox_overlay';

        // collapse section
        function collapseHeading(heading) {
            heading.setAttribute('data-collapsed', 'true');
            const children = getChildren(heading);
            for (const child of children)
                child.setAttribute('data-collapsed', 'true');
        }

        // expand section
        function expandHeading(heading) {
            heading.setAttribute('data-collapsed', 'false');
            const children = getChildren(heading);
            for (const child of children)
                child.setAttribute('data-collapsed', 'false');
        }

        // get list of elements between this <h2> and next <h2> or <h1>
        // ("children" of the <h2> section)
        function getChildren(heading) {
            return nextUntil(heading, 'h2, h1', exclude);
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get list of elements after a start element up to element matching
        // query
        function nextUntil(element, query, exclude) {
            const elements = [];
            while (element = element.nextElementSibling, element) {
                if (element.matches(query))
                    break;
                if (!element.matches(exclude))
                    elements.push(element);
            }
            return elements;
        }

        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- angle down icon -->

<template class="icon_angle_down">
    <!-- modified from: https://fontawesome.com/icons/angle-down -->
    <svg width="16" height="16" viewBox="0 0 448 512">
        <path
            fill="currentColor"
            d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"
        ></path>
    </svg>
</template>
<!-- tooltips plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when the user hovers or
        // focuses a link to a citation or figure, a tooltip appears with a
        // preview of the reference content, along with arrows to navigate
        // between instances of the same reference in the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'tooltips';

        // default plugin options
        const options = {
            // whether user must click off to close tooltip instead of just
            // un-hovering
            clickClose: 'false',
            // delay (in ms) between opening and closing tooltip
            delay: '100',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            const links = getLinks();
            for (const link of links) {
                // attach hover and focus listeners to link
                link.addEventListener('mouseover', onLinkHover);
                link.addEventListener('mouseleave', onLinkUnhover);
                link.addEventListener('focus', onLinkFocus);
                link.addEventListener('touchend', onLinkTouch);
            }

            // attach mouse, key, and resize listeners to window
            window.addEventListener('mousedown', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('keyup', onKeyUp);
            window.addEventListener('resize', onResize);
        }

        // when link is hovered
        function onLinkHover() {
            // function to open tooltip
            const delayOpenTooltip = function() {
                openTooltip(this);
            }.bind(this);

            // run open function after delay
            this.openTooltipTimer = window.setTimeout(
                delayOpenTooltip,
                options.delay
            );
        }

        // when mouse leaves link
        function onLinkUnhover() {
            // cancel opening tooltip
            window.clearTimeout(this.openTooltipTimer);

            // don't close on unhover if option specifies
            if (options.clickClose === 'true')
                return;

            // function to close tooltip
            const delayCloseTooltip = function() {
                // if tooltip open and if mouse isn't over tooltip, close
                const tooltip = document.getElementById('tooltip');
                if (tooltip && !tooltip.matches(':hover'))
                    closeTooltip();
            };

            // run close function after delay
            this.closeTooltipTimer = window.setTimeout(
                delayCloseTooltip,
                options.delay
            );
        }

        // when link is focused (tabbed to)
        function onLinkFocus(event) {
            openTooltip(this);
        }

        // when link is touched on touch screen
        function onLinkTouch(event) {
            // attempt to force hover state on first tap always, and trigger
            // regular link click (and navigation) on second tap
            if (event.target === document.activeElement)
                event.target.click();
            else {
                document.activeElement.blur();
                event.target.focus();
            }
            if (event.cancelable)
                event.preventDefault();
            event.stopPropagation();
            return false;
        }

        // when mouse is clicked anywhere in window
        function onClick(event) {
            closeTooltip();
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            switch (event.key) {
                // trigger click of prev button
                case 'ArrowLeft':
                    const prevButton = document.getElementById(
                        'tooltip_prev_button'
                    );
                    if (prevButton)
                        prevButton.click();
                    break;
                // trigger click of next button
                case 'ArrowRight':
                    const nextButton = document.getElementById(
                        'tooltip_next_button'
                    );
                    if (nextButton)
                        nextButton.click();
                    break;
                // close on esc
                case 'Escape':
                    closeTooltip();
                    break;
            }
        }

        // when window is resized or zoomed
        function onResize() {
            closeTooltip();
        }

        // get all links of types we wish to handle
        function getLinks() {
            const queries = [];
            // exclude buttons, anchor links, toc links, etc
            const exclude =
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            queries.push('a[href^="#ref-"]' + exclude); // citation links
            queries.push('a[href^="#fig:"]' + exclude); // figure links
            const query = queries.join(', ');
            return document.querySelectorAll(query);
        }

        // get links with same target, get index of link in set, get total
        // same links
        function getSameLinks(link) {
            const sameLinks = [];
            const links = getLinks();
            for (const otherLink of links) {
                if (
                    otherLink.getAttribute('href') === link.getAttribute('href')
                )
                    sameLinks.push(otherLink);
            }

            return {
                elements: sameLinks,
                index: sameLinks.indexOf(link),
                total: sameLinks.length
            };
        }

        // open tooltip
        function openTooltip(link) {
            // delete tooltip if it exists, start fresh
            closeTooltip();

            // make tooltip element
            const tooltip = makeTooltip(link);

            // if source couldn't be found and tooltip not made, exit
            if (!tooltip)
                return;

            // make navbar elements
            const navBar = makeNavBar(link);
            if (navBar)
                tooltip.firstElementChild.appendChild(navBar);

            // attach tooltip to page
            document.body.appendChild(tooltip);

            // position tooltip
            const position = function() {
                positionTooltip(link);
            };
            position();

            // if tooltip contains images, position again after they've loaded
            const imgs = tooltip.querySelectorAll('img');
            for (const img of imgs)
                img.addEventListener('load', position);
        }

        // close (delete) tooltip
        function closeTooltip() {
            const tooltip = document.getElementById('tooltip');
            if (tooltip)
                tooltip.remove();
        }

        // make tooltip
        function makeTooltip(link) {
            // get target element that link points to
            const source = getSource(link);

            // if source can't be found, exit
            if (!source)
                return;

            // create new tooltip
            const tooltip = document.createElement('div');
            tooltip.id = 'tooltip';
            const tooltipContent = document.createElement('div');
            tooltipContent.id = 'tooltip_content';
            tooltip.appendChild(tooltipContent);

            // make copy of source node and put in tooltip
            const sourceCopy = makeCopy(source);
            tooltipContent.appendChild(sourceCopy);

            // attach mouse event listeners
            tooltip.addEventListener('click', onTooltipClick);
            tooltip.addEventListener('mousedown', onTooltipClick);
            tooltip.addEventListener('touchstart', onTooltipClick);
            tooltip.addEventListener('mouseleave', onTooltipUnhover);

            // (for interaction with lightbox plugin)
            // transfer click on tooltip copied img to original img
            const sourceImg = source.querySelector('img');
            const sourceCopyImg = sourceCopy.querySelector('img');
            if (sourceImg && sourceCopyImg) {
                const clickImg = function() {
                    sourceImg.click();
                    closeTooltip();
                };
                sourceCopyImg.addEventListener('click', clickImg);
            }

            return tooltip;
        }

        // make carbon copy of html dom element
        function makeCopy(source) {
            const sourceCopy = source.cloneNode(true);

            // delete elements marked with ignore (eg anchor and jump buttons)
            const deleteFromCopy = sourceCopy.querySelectorAll(
                '[data-ignore="true"]'
            );
            for (const element of deleteFromCopy)
                element.remove();

            // delete certain element attributes
            const attributes = [
                'id',
                'data-collapsed',
                'data-selected',
                'data-highlighted',
                'data-glow'
            ];
            for (const attribute of attributes) {
                sourceCopy.removeAttribute(attribute);
                const elements = sourceCopy.querySelectorAll(
                    '[' + attribute + ']'
                );
                for (const element of elements)
                    element.removeAttribute(attribute);
            }

            return sourceCopy;
        }

        // when tooltip is clicked
        function onTooltipClick(event) {
            // when user clicks on tooltip, stop click from transferring
            // outside of tooltip (eg, click off to close tooltip, or eg click
            // off to unhighlight same refs)
            event.stopPropagation();
        }

        // when tooltip is unhovered
        function onTooltipUnhover(event) {
            if (options.clickClose === 'true')
                return;

            // make sure new mouse/touch/focus no longer over tooltip or any
            // element within it
            const tooltip = document.getElementById('tooltip');
            if (!tooltip)
                return;
            if (this.contains(event.relatedTarget))
                return;

            closeTooltip();
        }

        // make nav bar to go betwen prev/next instances of same reference
        function makeNavBar(link) {
            // find other links to the same source
            const sameLinks = getSameLinks(link);

            // don't show nav bar when singular reference
            if (sameLinks.total <= 1)
                return;

            // find prev/next links with same target
            const prevLink = getPrevLink(link, sameLinks);
            const nextLink = getNextLink(link, sameLinks);

            // create nav bar
            const navBar = document.createElement('div');
            navBar.id = 'tooltip_nav_bar';
            const text = sameLinks.index + 1 + ' of ' + sameLinks.total;

            // create nav bar prev/next buttons
            const prevButton = document.createElement('button');
            const nextButton = document.createElement('button');
            prevButton.id = 'tooltip_prev_button';
            nextButton.id = 'tooltip_next_button';
            prevButton.title =
                'Jump to the previous occurence of this item in the document [←]';
            nextButton.title =
                'Jump to the next occurence of this item in the document [→]';
            prevButton.classList.add('icon_button');
            nextButton.classList.add('icon_button');
            prevButton.innerHTML = document.querySelector(
                '.icon_caret_left'
            ).innerHTML;
            nextButton.innerHTML = document.querySelector(
                '.icon_caret_right'
            ).innerHTML;
            navBar.appendChild(prevButton);
            navBar.appendChild(document.createTextNode(text));
            navBar.appendChild(nextButton);

            // attach click listeners to buttons
            prevButton.addEventListener('click', function() {
                onPrevNextClick(link, prevLink);
            });
            nextButton.addEventListener('click', function() {
                onPrevNextClick(link, nextLink);
            });

            return navBar;
        }

        // get previous link with same target
        function getPrevLink(link, sameLinks) {
            if (!sameLinks)
                sameLinks = getSameLinks(link);
            // wrap index to other side if < 1
            let index;
            if (sameLinks.index - 1 >= 0)
                index = sameLinks.index - 1;
            else
                index = sameLinks.total - 1;
            return sameLinks.elements[index];
        }

        // get next link with same target
        function getNextLink(link, sameLinks) {
            if (!sameLinks)
                sameLinks = getSameLinks(link);
            // wrap index to other side if > total
            let index;
            if (sameLinks.index + 1 <= sameLinks.total - 1)
                index = sameLinks.index + 1;
            else
                index = 0;
            return sameLinks.elements[index];
        }

        // get element that is target of link or url hash
        function getSource(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            // if ref or figure, modify target to get expected element
            if (id.indexOf('ref-') === 0)
                target = target.querySelector('p');
            else if (id.indexOf('fig:') === 0)
                target = target.querySelector('figure');

            return target;
        }

        // when prev/next arrow button is clicked
        function onPrevNextClick(link, prevNextLink) {
            if (link && prevNextLink)
                goToElement(prevNextLink, window.innerHeight * 0.5);
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // determine position to place tooltip based on link position in
        // viewport and tooltip size
        function positionTooltip(link, left, top) {
            const tooltipElement = document.getElementById('tooltip');
            if (!tooltipElement)
                return;

            // get convenient vars for position/dimensions of
            // link/tooltip/page/view
            link = getRectInPage(link);
            const tooltip = getRectInPage(tooltipElement);
            const view = getRectInPage();

            // horizontal positioning
            if (left)
                // use explicit value
                left = left;
            else if (link.left + tooltip.width < view.right)
                // fit tooltip to right of link
                left = link.left;
            else if (link.right - tooltip.width > view.left)
                // fit tooltip to left of link
                left = link.right - tooltip.width;
            // center tooltip in view
            else
                left = (view.right - view.left) / 2 - tooltip.width / 2;

            // vertical positioning
            if (top)
                // use explicit value
                top = top;
            else if (link.top - tooltip.height > view.top)
                // fit tooltip above link
                top = link.top - tooltip.height;
            else if (link.bottom + tooltip.height < view.bottom)
                // fit tooltip below link
                top = link.bottom;
            else {
                // center tooltip in view
                top = view.top + view.height / 2 - tooltip.height / 2;
                // nudge off of link to left/right if possible
                if (link.right + tooltip.width < view.right)
                    left = link.right;
                else if (link.left - tooltip.width > view.left)
                    left = link.left - tooltip.width;
            }

            tooltipElement.style.left = left + 'px';
            tooltipElement.style.top = top + 'px';
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get position of element relative to page
        function getRectInPage(element) {
            const rect = getRectInView(element);
            const body = getRectInView(document.body);

            const newRect = {};
            newRect.left = rect.left - body.left;
            newRect.top = rect.top - body.top;
            newRect.right = rect.right - body.left;
            newRect.bottom = rect.bottom - body.top;
            newRect.width = rect.width;
            newRect.height = rect.height;

            return newRect;
        }

        // (for interaction with accordion plugin)
        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // (for interaction with accordion plugin)
        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // (for interaction with accordion plugin)
        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
    <!-- modified from: https://fontawesome.com/icons/caret-left -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
        ></path>
    </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
    <!-- modified from: https://fontawesome.com/icons/caret-right -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
        ></path>
    </svg>
</template>
<!-- jump to first plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin adds a button next to each reference entry,
        // figure, and table that jumps the page to the first occurrence of a
        // link to that item in the manuscript.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'jumpToFirst';

        // default plugin options
        const options = {
            // whether to add buttons next to reference entries
            references: 'true',
            // whether to add buttons next to figures
            figures: 'true',
            // whether to add buttons next to tables
            tables: 'true',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            if (options.references !== 'false')
                makeReferenceButtons();
            if (options.figures !== 'false')
                makeFigureButtons();
            if (options.tables !== 'false')
                makeTableButtons();
        }

        // when jump button clicked
        function onButtonClick() {
            const first = getFirstOccurrence(this.dataset.id);
            if (!first)
                return;

            // update url hash so navigating "back" in history will return
            // user to jump button
            window.location.hash = this.dataset.id;
            // scroll to link
            window.setTimeout(function() {
                goToElement(first, window.innerHeight * 0.5);
            }, 0);
        }

        // get first occurence of link to item in document
        function getFirstOccurrence(id) {
            let query = 'a';
            query += '[href="#' + id + '"]';
            // exclude buttons, anchor links, toc links, etc
            query +=
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            return document.querySelector(query);
        }

        // add button next to each reference entry
        function makeReferenceButtons() {
            const references = document.querySelectorAll('div[id^="ref-"]');
            for (const reference of references) {
                // get reference id and element to add button to
                const id = reference.id;
                const container = reference.firstElementChild;
                const first = getFirstOccurrence(id);

                // if can't find link to reference, ignore
                if (!first)
                    continue;

                // make jump button
                let button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this reference in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.innerHTML = button.outerHTML + container.innerHTML;
                button = container.firstElementChild;
                button.addEventListener('click', onButtonClick);
            }
        }

        // add button next to each figure
        function makeFigureButtons() {
            const figures = document.querySelectorAll('[id^="fig:"]');
            for (const figure of figures) {
                // get figure id and element to add button to
                const id = figure.id;
                const container = figure.querySelector('figcaption') || figure;
                const first = getFirstOccurrence(id);

                // if can't find link to figure, ignore
                if (!first)
                    continue;

                // make jump button
                const button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this figure in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.insertBefore(button, container.firstElementChild);
                button.addEventListener('click', onButtonClick);
            }
        }

        // add button next to each figure
        function makeTableButtons() {
            const tables = document.querySelectorAll('[id^="tbl:"]');
            for (const table of tables) {
                // get ref id and element to add button to
                const id = table.id;
                const container = table.querySelector('caption') || table;
                const first = getFirstOccurrence(id);

                // if can't find link to table, ignore
                if (!first)
                    continue;

                // make jump button
                const button = document.createElement('button');
                button.classList.add('icon_button', 'jump_arrow');
                button.title =
                    'Jump to the first occurence of this table in the document';
                button.innerHTML = document.querySelector(
                    '.icon_angle_double_up'
                ).innerHTML;
                button.dataset.id = id;
                button.dataset.ignore = 'true';
                container.insertBefore(button, container.firstElementChild);
                button.addEventListener('click', onButtonClick);
            }
        }

        // scroll to and focus element
        function goToElement(element, offset) {
            // expand accordion section if collapsed
            expandElement(element);
            const y =
                getRectInView(element).top -
                getRectInView(document.documentElement).top -
                (offset || 0);
            // trigger any function listening for "onscroll" event
            window.dispatchEvent(new Event('scroll'));
            window.scrollTo(0, y);
            document.activeElement.blur();
            element.focus();
        }

        // get position/dimensions of element or viewport
        function getRectInView(element) {
            let rect = {};
            rect.left = 0;
            rect.top = 0;
            rect.right = document.documentElement.clientWidth;
            rect.bottom = document.documentElement.clientHeight;
            let style = {};

            if (element instanceof HTMLElement) {
                rect = element.getBoundingClientRect();
                style = window.getComputedStyle(element);
            }

            const margin = {};
            margin.left = parseFloat(style.marginLeftWidth) || 0;
            margin.top = parseFloat(style.marginTopWidth) || 0;
            margin.right = parseFloat(style.marginRightWidth) || 0;
            margin.bottom = parseFloat(style.marginBottomWidth) || 0;

            const border = {};
            border.left = parseFloat(style.borderLeftWidth) || 0;
            border.top = parseFloat(style.borderTopWidth) || 0;
            border.right = parseFloat(style.borderRightWidth) || 0;
            border.bottom = parseFloat(style.borderBottomWidth) || 0;

            const newRect = {};
            newRect.left = rect.left + margin.left + border.left;
            newRect.top = rect.top + margin.top + border.top;
            newRect.right = rect.right + margin.right + border.right;
            newRect.bottom = rect.bottom + margin.bottom + border.bottom;
            newRect.width = newRect.right - newRect.left;
            newRect.height = newRect.bottom - newRect.top;

            return newRect;
        }

        // get closest element before specified element that matches query
        function firstBefore(element, query) {
            while (
                element &&
                element !== document.body &&
                !element.matches(query)
            )
                element = element.previousElementSibling || element.parentNode;

            return element;
        }

        // check if element is part of collapsed heading
        function isCollapsed(element) {
            while (element && element !== document.body) {
                if (element.dataset.collapsed === 'true')
                    return true;
                element = element.parentNode;
            }
            return false;
        }

        // (for interaction with accordion plugin)
        // expand heading containing element if necesary
        function expandElement(element) {
            if (isCollapsed(element)) {
                const heading = firstBefore(element, 'h2');
                if (heading)
                    heading.click();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- angle double up icon -->

<template class="icon_angle_double_up">
    <!-- modified from: https://fontawesome.com/icons/angle-double-up -->
    <svg width="16" height="16" viewBox="0 0 320 512">
        <path
            fill="currentColor"
            d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"
        ></path>
    </svg>
</template>
<!-- link highlight plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when a user hovers or
        // focuses a link, other links that have the same target will be
        // highlighted. It also makes it such that when clicking a link, the
        // target of the link (eg reference, figure, table) is briefly
        // highlighted.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'linkHighlight';

        // default plugin options
        const options = {
            // whether to also highlight links that go to external urls
            externalLinks: 'false',
            // whether user must click off to unhighlight instead of just
            // un-hovering
            clickUnhighlight: 'false',
            // whether to also highlight links that are unique
            highlightUnique: 'true',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            const links = getLinks();
            for (const link of links) {
                // attach mouse and focus listeners to link
                link.addEventListener('mouseenter', onLinkFocus);
                link.addEventListener('focus', onLinkFocus);
                link.addEventListener('mouseleave', onLinkUnhover);
            }

            // attach click and hash change listeners to window
            window.addEventListener('click', onClick);
            window.addEventListener('touchstart', onClick);
            window.addEventListener('hashchange', onHashChange);

            // run hash change on window load in case user has navigated
            // directly to hash
            onHashChange();
        }

        // when link is focused (tabbed to) or hovered
        function onLinkFocus() {
            highlight(this);
        }

        // when link is unhovered
        function onLinkUnhover() {
            if (options.clickUnhighlight !== 'true')
                unhighlightAll();
        }

        // when the mouse is clicked anywhere in window
        function onClick(event) {
            unhighlightAll();
        }

        // when hash (eg manuscript.html#introduction) changes
        function onHashChange() {
            const target = getHashTarget();
            if (target)
                glowElement(target);
        }

        // get element that is target of link or url hash
        function getHashTarget(link) {
            const hash = link ? link.hash : window.location.hash;
            const id = hash.slice(1);
            let target = document.querySelector('[id="' + id + '"]');
            if (!target)
                return;

            return target;
        }

        // start glow sequence on an element
        function glowElement(element) {
            const startGlow = function() {
                onGlowEnd();
                element.dataset.glow = 'true';
                element.addEventListener('animationend', onGlowEnd);
            };
            const onGlowEnd = function() {
                element.removeAttribute('data-glow');
                element.removeEventListener('animationend', onGlowEnd);
            };
            startGlow();
        }

        // highlight link and all others with same target
        function highlight(link) {
            // force unhighlight all to start fresh
            unhighlightAll();

            // get links with same target
            if (!link)
                return;
            const sameLinks = getSameLinks(link);

            // if link unique and option is off, exit and don't highlight
            if (sameLinks.length <= 1 && options.highlightUnique !== 'true')
                return;

            // highlight all same links, and "select" (special highlight) this
            // one
            for (const sameLink of sameLinks) {
                if (sameLink === link)
                    sameLink.setAttribute('data-selected', 'true');
                else
                    sameLink.setAttribute('data-highlighted', 'true');
            }
        }

        // unhighlight all links
        function unhighlightAll() {
            const links = getLinks();
            for (const link of links) {
                link.setAttribute('data-selected', 'false');
                link.setAttribute('data-highlighted', 'false');
            }
        }

        // get links with same target
        function getSameLinks(link) {
            const results = [];
            const links = getLinks();
            for (const otherLink of links) {
                if (
                    otherLink.getAttribute('href') === link.getAttribute('href')
                )
                    results.push(otherLink);
            }
            return results;
        }

        // get all links of types we wish to handle
        function getLinks() {
            let query = 'a';
            if (options.externalLinks !== 'true')
                query += '[href^="#"]';
            // exclude buttons, anchor links, toc links, etc
            query +=
                ':not(.button):not(.icon_button):not(.anchor):not(.toc_link)';
            return document.querySelectorAll(query);
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>
<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin provides a "table of contents" (toc) panel on
        // the side of the document that allows the user to conveniently
        // navigate between sections of the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'tableOfContents';

        // default plugin options
        const options = {
            // which types of elements to add links for, in
            // "document.querySelector" format
            typesQuery: 'h1, h2, h3',
            // whether toc starts open. use 'true' or 'false', or 'auto' to
            // use 'true' behavior when screen wide enough and 'false' when not
            startOpen: 'false',
            // whether toc closes when clicking on toc link. use 'true' or
            // 'false', or 'auto' to use 'false' behavior when screen wide
            // enough and 'true' when not
            clickClose: 'auto',
            // if list item is more than this many characters, text will be
            // truncated
            charLimit: '50',
            // whether or not to show bullets next to each toc item
            bullets: 'false',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // make toc panel and populate with entries (links to document
            // sections)
            const panel = makePanel();
            if (!panel)
                return;
            makeEntries(panel);
            // attach panel to document after making entries, so 'toc' heading
            // in panel isn't included in toc
            document.body.insertBefore(panel, document.body.firstChild);

            // initial panel state
            if (
                options.startOpen === 'true' ||
                (options.startOpen === 'auto' && !isSmallScreen())
            )
                openPanel();
            else
                closePanel();

            // attach click, scroll, and hash change listeners to window
            window.addEventListener('click', onClick);
            window.addEventListener('scroll', onScroll);
            window.addEventListener('hashchange', onScroll);
            window.addEventListener('keyup', onKeyUp);
            onScroll();

            // add class to push document body down out of way of toc button
            document.body.classList.add('toc_body_nudge');
        }

        // determine if screen wide enough to fit toc panel
        function isSmallScreen() {
            // in default theme:
            // 816px = 8.5in = width of "page" (<body>) element
            // 260px = min width of toc panel (*2 for both sides of <body>)
            return window.innerWidth < 816 + 260 * 2;
        }

        // when mouse is clicked anywhere in window
        function onClick() {
            if (isSmallScreen())
                closePanel();
        }

        // when window is scrolled or hash changed
        function onScroll() {
            highlightViewed();
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            // close on esc
            if (event.key === 'Escape')
                closePanel();
        }

        // find entry of currently viewed document section in toc and highlight
        function highlightViewed() {
            const firstId = getFirstInView(options.typesQuery);

            // get toc entries (links), unhighlight all, then highlight viewed
            const list = document.getElementById('toc_list');
            if (!firstId || !list)
                return;
            const links = list.querySelectorAll('a');
            for (const link of links)
                link.dataset.viewing = 'false';
            const link = list.querySelector('a[href="#' + firstId + '"]');
            if (!link)
                return;
            link.dataset.viewing = 'true';
        }

        // get first or previous toc listed element in top half of view
        function getFirstInView(query) {
            // get all elements matching query and with id
            const elements = document.querySelectorAll(query);
            const elementsWithIds = [];
            for (const element of elements) {
                if (element.id)
                    elementsWithIds.push(element);
            }


            // get first or previous element in top half of view
            for (let i = 0; i < elementsWithIds.length; i++) {
                const element = elementsWithIds[i];
                const prevElement = elementsWithIds[Math.max(0, i - 1)];
                if (element.getBoundingClientRect().top >= 0) {
                    if (
                        element.getBoundingClientRect().top <
                        window.innerHeight / 2
                    )
                        return element.id;
                    else
                        return prevElement.id;
                }
            }
        }

        // make panel
        function makePanel() {
            // create panel
            const panel = document.createElement('div');
            panel.id = 'toc_panel';
            if (options.bullets === 'true')
                panel.dataset.bullets = 'true';

            // create header
            const header = document.createElement('div');
            header.id = 'toc_header';

            // create toc button
            const button = document.createElement('button');
            button.id = 'toc_button';
            button.innerHTML = document.querySelector('.icon_th_list').innerHTML;
            button.title = 'Table of Contents';
            button.classList.add('icon_button');

            // create header text
            const text = document.createElement('h4');
            text.innerHTML = 'Table of Contents';

            // create container for toc list
            const list = document.createElement('div');
            list.id = 'toc_list';

            // attach click listeners
            panel.addEventListener('click', onPanelClick);
            header.addEventListener('click', onHeaderClick);
            button.addEventListener('click', onButtonClick);

            // attach elements
            header.appendChild(button);
            header.appendChild(text);
            panel.appendChild(header);
            panel.appendChild(list);

            return panel;
        }

        // create toc entries (links) to each element of the specified types
        function makeEntries(panel) {
            const elements = document.querySelectorAll(options.typesQuery);
            for (const element of elements) {
                // do not add link if element doesn't have assigned id
                if (!element.id)
                    continue;

                // create link/list item
                const link = document.createElement('a');
                link.classList.add('toc_link');
                switch (element.tagName.toLowerCase()) {
                    case 'h1':
                        link.dataset.level = '1';
                        break;
                    case 'h2':
                        link.dataset.level = '2';
                        break;
                    case 'h3':
                        link.dataset.level = '3';
                        break;
                    case 'h4':
                        link.dataset.level = '4';
                        break;
                }
                link.title = element.innerText;
                let text = element.innerText;
                if (text.length > options.charLimit)
                    text = text.slice(0, options.charLimit) + '...';
                link.innerHTML = text;
                link.href = '#' + element.id;
                link.addEventListener('click', onLinkClick);

                // attach link
                panel.querySelector('#toc_list').appendChild(link);
            }
        }

        // when panel is clicked
        function onPanelClick(event) {
            // stop click from propagating to window/document and closing panel
            event.stopPropagation();
        }

        // when header itself is clicked
        function onHeaderClick(event) {
            togglePanel();
        }

        // when button is clicked
        function onButtonClick(event) {
            togglePanel();
            // stop header underneath button from also being clicked
            event.stopPropagation();
        }

        // when link is clicked
        function onLinkClick(event) {
            if (
                options.clickClose === 'true' ||
                (options.clickClose === 'auto' && isSmallScreen())
            )
                closePanel();
            else
                openPanel();
        }

        // open panel if closed, close if opened
        function togglePanel() {
            const panel = document.getElementById('toc_panel');
            if (!panel)
                return;

            if (panel.dataset.open === 'true')
                closePanel();
            else
                openPanel();
        }

        // open panel
        function openPanel() {
            const panel = document.getElementById('toc_panel');
            if (panel)
                panel.dataset.open = 'true';
        }

        // close panel
        function closePanel() {
            const panel = document.getElementById('toc_panel');
            if (panel)
                panel.dataset.open = 'false';
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- th list icon -->

<template class="icon_th_list">
    <!-- modified from: https://fontawesome.com/icons/th-list -->
    <svg width="16" height="16" viewBox="0 0 512 512" tabindex="-1">
        <path
            fill="currentColor"
            d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"
            tabindex="-1"
        ></path>
    </svg>
</template>
<!-- lightbox plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin makes it such that when a user clicks on an
        // image, the image fills the screen and the user can pan/drag/zoom
        // the image and navigate between other images in the document.

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'lightbox';

        // default plugin options
        const options = {
            // list of possible zoom/scale factors
            zoomSteps:
                '0.1, 0.25, 0.333333, 0.5, 0.666666, 0.75, 1,' +
                '1.25, 1.5, 1.75, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8',
            // whether to fit image to view ('fit'), display at 100% and shrink
            // if necessary ('shrink'), or always display at 100% ('100')
            defaultZoom: 'fit',
            // whether to zoom in/out toward center of view ('true') or mouse
            // ('false')
            centerZoom: 'false',
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // run through each <img> element
            const imgs = document.querySelectorAll('figure > img');
            let count = 1;
            for (const img of imgs) {
                img.classList.add('lightbox_document_img');
                img.dataset.number = count;
                img.dataset.total = imgs.length;
                img.addEventListener('click', openLightbox);
                count++;
            }

            // attach mouse and key listeners to window
            window.addEventListener('mousemove', onWindowMouseMove);
            window.addEventListener('keyup', onKeyUp);
        }

        // when mouse is moved anywhere in window
        function onWindowMouseMove(event) {
            window.mouseX = event.clientX;
            window.mouseY = event.clientY;
        }

        // when key pressed
        function onKeyUp(event) {
            if (!event || !event.key)
                return;

            switch (event.key) {
                // trigger click of prev button
                case 'ArrowLeft':
                    const prevButton = document.getElementById(
                        'lightbox_prev_button'
                    );
                    if (prevButton)
                        prevButton.click();
                    break;
                // trigger click of next button
                case 'ArrowRight':
                    const nextButton = document.getElementById(
                        'lightbox_next_button'
                    );
                    if (nextButton)
                        nextButton.click();
                    break;
                // close on esc
                case 'Escape':
                    closeLightbox();
                    break;
            }
        }

        // open lightbox
        function openLightbox() {
            const lightbox = makeLightbox(this);
            if (!lightbox)
                return;

            blurBody(lightbox);
            document.body.appendChild(lightbox);
        }

        // make lightbox
        function makeLightbox(img) {
            // delete lightbox if it exists, start fresh
            closeLightbox();

            // create screen overlay containing lightbox
            const overlay = document.createElement('div');
            overlay.id = 'lightbox_overlay';

            // create image info boxes
            const numberInfo = document.createElement('div');
            const zoomInfo = document.createElement('div');
            numberInfo.id = 'lightbox_number_info';
            zoomInfo.id = 'lightbox_zoom_info';

            // create container for image
            const imageContainer = document.createElement('div');
            imageContainer.id = 'lightbox_image_container';
            const lightboxImg = makeLightboxImg(
                img,
                imageContainer,
                numberInfo,
                zoomInfo
            );
            imageContainer.appendChild(lightboxImg);

            // create bottom container for caption and navigation buttons
            const bottomContainer = document.createElement('div');
            bottomContainer.id = 'lightbox_bottom_container';
            const caption = makeCaption(img);
            const prevButton = makePrevButton(img);
            const nextButton = makeNextButton(img);
            bottomContainer.appendChild(prevButton);
            bottomContainer.appendChild(caption);
            bottomContainer.appendChild(nextButton);

            // attach top middle and bottom to overlay
            overlay.appendChild(numberInfo);
            overlay.appendChild(zoomInfo);
            overlay.appendChild(imageContainer);
            overlay.appendChild(bottomContainer);

            return overlay;
        }

        // make <img> object that is intuitively draggable and zoomable
        function makeLightboxImg(
            sourceImg,
            container,
            numberInfoBox,
            zoomInfoBox
        ) {
            // create copy of source <img>
            const img = sourceImg.cloneNode(true);
            img.classList.remove('lightbox_document_img');
            img.removeAttribute('id');
            img.removeAttribute('width');
            img.removeAttribute('height');
            img.style.position = 'unset';
            img.style.margin = '0';
            img.style.padding = '0';
            img.style.width = '';
            img.style.height = '';
            img.style.minWidth = '';
            img.style.minHeight = '';
            img.style.maxWidth = '';
            img.style.maxHeight = '';
            img.id = 'lightbox_img';

            // build sorted list of unique zoomSteps, always including a 100%
            let zoomSteps = [];
            const optionsZooms = options.zoomSteps.split(/[^0-9.]/);
            for (const optionZoom of optionsZooms) {
                const newZoom = parseFloat(optionZoom);
                if (newZoom && !zoomSteps.includes(newZoom))
                    zoomSteps.push(newZoom);
            }
            if (!zoomSteps.includes(1))
                zoomSteps.push(1);
            zoomSteps = zoomSteps.sort(function sortNumber(a, b) {
                return a - b;
            });

            // <img> object property variables
            let zoom = 1;
            let translateX = 0;
            let translateY = 0;
            let clickMouseX = undefined;
            let clickMouseY = undefined;
            let clickTranslateX = undefined;
            let clickTranslateY = undefined;

            updateNumberInfo();

            // update image numbers displayed in info box
            function updateNumberInfo() {
                numberInfoBox.innerHTML =
                    sourceImg.dataset.number + ' of ' + sourceImg.dataset.total;
            }

            // update zoom displayed in info box
            function updateZoomInfo() {
                let zoomInfo = zoom * 100;
                if (!Number.isInteger(zoomInfo))
                    zoomInfo = zoomInfo.toFixed(2);
                zoomInfoBox.innerHTML = zoomInfo + '%';
            }

            // move to closest zoom step above current zoom
            const zoomIn = function() {
                for (const zoomStep of zoomSteps) {
                    if (zoomStep > zoom) {
                        zoom = zoomStep;
                        break;
                    }
                }
                updateTransform();
            };

            // move to closest zoom step above current zoom
            const zoomOut = function() {
                zoomSteps.reverse();
                for (const zoomStep of zoomSteps) {
                    if (zoomStep < zoom) {
                        zoom = zoomStep;
                        break;
                    }
                }
                zoomSteps.reverse();

                updateTransform();
            };

            // update display of <img> based on scale/translate properties
            const updateTransform = function() {
                // set transform
                img.style.transform =
                    'translate(' +
                    (translateX || 0) +
                    'px,' +
                    (translateY || 0) +
                    'px) scale(' +
                    (zoom || 1) +
                    ')';

                // get new width/height after scale
                const rect = img.getBoundingClientRect();
                // limit translate
                translateX = Math.max(translateX, -rect.width / 2);
                translateX = Math.min(translateX, rect.width / 2);
                translateY = Math.max(translateY, -rect.height / 2);
                translateY = Math.min(translateY, rect.height / 2);

                // set transform
                img.style.transform =
                    'translate(' +
                    (translateX || 0) +
                    'px,' +
                    (translateY || 0) +
                    'px) scale(' +
                    (zoom || 1) +
                    ')';

                updateZoomInfo();
            };

            // fit <img> to container
            const fit = function() {
                // no x/y offset, 100% zoom by default
                translateX = 0;
                translateY = 0;
                zoom = 1;

                // widths of <img> and container
                const imgWidth = img.naturalWidth;
                const imgHeight = img.naturalHeight;
                const containerWidth = parseFloat(
                    window.getComputedStyle(container).width
                );
                const containerHeight = parseFloat(
                    window.getComputedStyle(container).height
                );

                // how much zooming is needed to fit <img> to container
                const xRatio = imgWidth / containerWidth;
                const yRatio = imgHeight / containerHeight;
                const maxRatio = Math.max(xRatio, yRatio);
                const newZoom = 1 / maxRatio;

                // fit <img> to container according to option
                if (options.defaultZoom === 'shrink') {
                    if (maxRatio > 1)
                        zoom = newZoom;
                } else if (options.defaultZoom === 'fit')
                    zoom = newZoom;

                updateTransform();
            };

            // when mouse wheel is rolled anywhere in container
            const onContainerWheel = function(event) {
                if (!event)
                    return;

                // let ctrl + mouse wheel to zoom behave as normal
                if (event.ctrlKey)
                    return;

                // prevent normal scroll behavior
                event.preventDefault();
                event.stopPropagation();

                // point around which to scale img
                const viewRect = container.getBoundingClientRect();
                const viewX = (viewRect.left + viewRect.right) / 2;
                const viewY = (viewRect.top + viewRect.bottom) / 2;
                const originX = options.centerZoom === 'true' ? viewX : mouseX;
                const originY = options.centerZoom === 'true' ? viewY : mouseY;

                // get point on image under origin
                const oldRect = img.getBoundingClientRect();
                const oldPercentX = (originX - oldRect.left) / oldRect.width;
                const oldPercentY = (originY - oldRect.top) / oldRect.height;

                // increment/decrement zoom
                if (event.deltaY < 0)
                    zoomIn();
                if (event.deltaY > 0)
                    zoomOut();

                // get offset between previous image point and origin
                const newRect = img.getBoundingClientRect();
                const offsetX =
                    originX - (newRect.left + newRect.width * oldPercentX);
                const offsetY =
                    originY - (newRect.top + newRect.height * oldPercentY);

                // translate image to keep image point under origin
                translateX += offsetX;
                translateY += offsetY;

                // perform translate
                updateTransform();
            };

            // when container is clicked
            function onContainerClick(event) {
                // if container itself is target of click, and not other
                // element above it
                if (event.target === this)
                    closeLightbox();
            }

            // when mouse button is pressed on image
            const onImageMouseDown = function(event) {
                // store original mouse position relative to image
                clickMouseX = window.mouseX;
                clickMouseY = window.mouseY;
                clickTranslateX = translateX;
                clickTranslateY = translateY;
                event.stopPropagation();
                event.preventDefault();
            };

            // when mouse button is released anywhere in window
            const onWindowMouseUp = function(event) {
                // reset original mouse position
                clickMouseX = undefined;
                clickMouseY = undefined;
                clickTranslateX = undefined;
                clickTranslateY = undefined;

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('mouseup', onWindowMouseUp);
            };

            // when mouse is moved anywhere in window
            const onWindowMouseMove = function(event) {
                if (
                    clickMouseX === undefined ||
                    clickMouseY === undefined ||
                    clickTranslateX === undefined ||
                    clickTranslateY === undefined
                )
                    return;

                // offset image based on original and current mouse position
                translateX = clickTranslateX + window.mouseX - clickMouseX;
                translateY = clickTranslateY + window.mouseY - clickMouseY;
                updateTransform();
                event.preventDefault();

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('mousemove', onWindowMouseMove);
            };

            // when window is resized
            const onWindowResize = function(event) {
                fit();

                // remove global listener if lightbox removed from document
                if (!document.body.contains(container))
                    window.removeEventListener('resize', onWindowResize);
            };

            // attach the necessary event listeners
            img.addEventListener('dblclick', fit);
            img.addEventListener('mousedown', onImageMouseDown);
            container.addEventListener('wheel', onContainerWheel);
            container.addEventListener('mousedown', onContainerClick);
            container.addEventListener('touchstart', onContainerClick);
            window.addEventListener('mouseup', onWindowMouseUp);
            window.addEventListener('mousemove', onWindowMouseMove);
            window.addEventListener('resize', onWindowResize);

            // run fit() after lightbox atttached to document and <img> Loaded
            // so needed container and img dimensions available
            img.addEventListener('load', fit);

            return img;
        }

        // make caption
        function makeCaption(img) {
            const caption = document.createElement('div');
            caption.id = 'lightbox_caption';
            const captionSource = img.nextElementSibling;
            if (captionSource.tagName.toLowerCase() === 'figcaption') {
                const captionCopy = makeCopy(captionSource);
                caption.innerHTML = captionCopy.innerHTML;
            }

            caption.addEventListener('touchstart', function(event) {
                event.stopPropagation();
            });

            return caption;
        }

        // make carbon copy of html dom element
        function makeCopy(source) {
            const sourceCopy = source.cloneNode(true);

            // delete elements marked with ignore (eg anchor and jump buttons)
            const deleteFromCopy = sourceCopy.querySelectorAll(
                '[data-ignore="true"]'
            );
            for (const element of deleteFromCopy)
                element.remove();

            // delete certain element attributes
            const attributes = [
                'id',
                'data-collapsed',
                'data-selected',
                'data-highlighted',
                'data-glow'
            ];
            for (const attribute of attributes) {
                sourceCopy.removeAttribute(attribute);
                const elements = sourceCopy.querySelectorAll(
                    '[' + attribute + ']'
                );
                for (const element of elements)
                    element.removeAttribute(attribute);
            }

            return sourceCopy;
        }

        // make button to jump to previous image in document
        function makePrevButton(img) {
            const prevButton = document.createElement('button');
            prevButton.id = 'lightbox_prev_button';
            prevButton.title = 'Jump to the previous image in the document [←]';
            prevButton.classList.add('icon_button', 'lightbox_button');
            prevButton.innerHTML = document.querySelector(
                '.icon_caret_left'
            ).innerHTML;

            // attach click listeners to button
            prevButton.addEventListener('click', function() {
                getPrevImg(img).click();
            });

            return prevButton;
        }

        // make button to jump to next image in document
        function makeNextButton(img) {
            const nextButton = document.createElement('button');
            nextButton.id = 'lightbox_next_button';
            nextButton.title = 'Jump to the next image in the document [→]';
            nextButton.classList.add('icon_button', 'lightbox_button');
            nextButton.innerHTML = document.querySelector(
                '.icon_caret_right'
            ).innerHTML;

            // attach click listeners to button
            nextButton.addEventListener('click', function() {
                getNextImg(img).click();
            });

            return nextButton;
        }

        // get previous image in document
        function getPrevImg(img) {
            const imgs = document.querySelectorAll('.lightbox_document_img');

            // find index of provided img
            let index;
            for (index = 0; index < imgs.length; index++) {
                if (imgs[index] === img)
                    break;
            }


            // wrap index to other side if < 1
            if (index - 1 >= 0)
                index--;
            else
                index = imgs.length - 1;
            return imgs[index];
        }

        // get next image in document
        function getNextImg(img) {
            const imgs = document.querySelectorAll('.lightbox_document_img');

            // find index of provided img
            let index;
            for (index = 0; index < imgs.length; index++) {
                if (imgs[index] === img)
                    break;
            }


            // wrap index to other side if > total
            if (index + 1 <= imgs.length - 1)
                index++;
            else
                index = 0;
            return imgs[index];
        }

        // close lightbox
        function closeLightbox() {
            focusBody();

            const lightbox = document.getElementById('lightbox_overlay');
            if (lightbox)
                lightbox.remove();
        }

        // make all elements behind lightbox non-focusable
        function blurBody(overlay) {
            const all = document.querySelectorAll('*');
            for (const element of all)
                element.tabIndex = -1;
            document.body.classList.add('body_no_scroll');
        }

        // make all elements focusable again
        function focusBody() {
            const all = document.querySelectorAll('*');
            for (const element of all)
                element.removeAttribute('tabIndex');
            document.body.classList.remove('body_no_scroll');
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
    <!-- modified from: https://fontawesome.com/icons/caret-left -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
        ></path>
    </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
    <!-- modified from: https://fontawesome.com/icons/caret-right -->
    <svg width="16" height="16" viewBox="0 0 192 512">
        <path
            fill="currentColor"
            d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
        ></path>
    </svg>
</template>
<!-- attributes plugin -->

<script>
    (function() {
        // /////////////////////////
        // DESCRIPTION
        // /////////////////////////

        // This Manubot plugin allows arbitrary HTML attributes to be attached
        // to (almost) any element. Place an HTML comment inside or next to the
        // desired element in the format <!-- $attribute="value" -->

        // /////////////////////////
        // OPTIONS
        // /////////////////////////

        // plugin name prefix for url parameters
        const pluginName = 'attributes';

        // default plugin options
        const options = {
            // whether plugin is on or not
            enabled: 'true'
        };

        // change options above, or override with url parameter, eg:
        // 'manuscript.html?pluginName-enabled=false'

        // /////////////////////////
        // SCRIPT
        // /////////////////////////

        // start script
        function start() {
            // get list of comments in document
            const comments = findComments();

            for(const comment of comments)
                if (comment.parentElement)
                    addAttributes(
                        comment.parentElement,
                        comment.nodeValue.trim()
                    );
        }

        // add html attributes to specified element based on string of 
        // html attributes and values
        function addAttributes(element, text) {
            // regex's for finding attribute/value pairs in the format of
            // attribute="value" or attribute='value
            const regex2 = /\$([a-zA-Z\-]+)?=\"(.+?)\"/;
            const regex1 = /\$([a-zA-Z\-]+)?=\'(.+?)\'/;

            // loop through attribute/value pairs
            let match;
            while(match = text.match(regex2) || text.match(regex1)) {
                // get attribute and value from regex capture groups
                let attribute = match[1];
                let value = match[2];

                // remove from string
                text = text.substring(match.index + match[0].length);

                if (!attribute || !value)
                    break;

                // set attribute of parent element
                try {
                    element.setAttribute(attribute, value);
                } catch(error) {
                    console.log(error);
                }

                // special case for colspan
                if (attribute === 'colspan')
                    removeTableCells(element, value);
            }
        }

        // get list of comment elements in document
        function findComments() {
            const comments = [];

            // iterate over comment nodes in document
            function acceptNode(node) {
                return NodeFilter.FILTER_ACCEPT;
            }
            const iterator = document.createNodeIterator(
                document.body,
                NodeFilter.SHOW_COMMENT,
                acceptNode
            );
            let node;
            while(node = iterator.nextNode())
                comments.push(node);

            return comments;
        }

        // remove certain number of cells after specified cell
        function removeTableCells(cell, number) {
            number = parseInt(number);
            if (!number)
                return;

            // remove elements
            for(; number > 1; number--) {
                if (cell.nextElementSibling)
                    cell.nextElementSibling.remove();
            }
        }

        // load options from url parameters
        function loadOptions() {
            const url = window.location.search;
            const params = new URLSearchParams(url);
            for (const optionName of Object.keys(options)) {
                const paramName = pluginName + '-' + optionName;
                const param = params.get(paramName);
                if (param !== '' && param !== null)
                    options[optionName] = param;
            }
        }
        loadOptions();

        // start script when document is finished loading
        if (options.enabled === 'true')
            window.addEventListener('load', start);
    })();
</script>
<!-- mathjax plugin configuration -->

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        "CommonHTML": { linebreaks: { automatic: true } },
        "HTML-CSS": { linebreaks: { automatic: true } },
        "SVG": { linebreaks: { automatic: true } },
        "fast-preview": { disabled: true }
  });
</script>

<!-- mathjax plugin -->

<script
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
    integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A=="
    crossorigin="anonymous"
>
    // /////////////////////////
    // DESCRIPTION
    // /////////////////////////

    // This third-party plugin 'MathJax' allows the proper rendering of
    // math/equations written in LaTeX.

    // https://www.mathjax.org/
</script>
<!-- annotations plugin -->

<script>
    // /////////////////////////
    // DESCRIPTION
    // /////////////////////////

    // This third-party plugin 'Hypothesis' allows public annotation of the
    // manuscript.

    // https://web.hypothes.is/

    // plugin configuration
    window.hypothesisConfig = function() {
        return {
            branding: {
                accentColor: '#2196f3',
                appBackgroundColor: '#f8f8f8',
                ctaBackgroundColor: '#f8f8f8',
                ctaTextColor: '#000000',
                selectionFontFamily: 'Open Sans, Helvetica, sans serif',
                annotationFontFamily: 'Open Sans, Helvetica, sans serif'
            }
        };
    };

    // hypothesis client script
    const embed = 'https://hypothes.is/embed.js';
    // hypothesis annotation count query url
    const query = 'https://api.hypothes.is/api/search?limit=0&url='

    
    // start script
    function start() {
        const button = makeButton();
        document.body.insertBefore(button, document.body.firstChild);
        insertCount(button);
    }

    // make button
    function makeButton() {
        // create button
        const button = document.createElement('button');
        button.id = 'hypothesis_button';
        button.innerHTML = document.querySelector('.icon_hypothesis').innerHTML;
        button.title = 'Hypothesis annotations';
        button.classList.add('icon_button');

        function onClick(event) {
            onButtonClick(event, button);
        }

        // attach click listeners
        button.addEventListener('click', onClick);

        return button;
    }

    // insert annotations count
    async function insertCount(button) {
        // get annotation count from Hypothesis based on url
        let count = '-';
        try {
            const canonical = document.querySelector('link[rel="canonical"]');
            const location = window.location;
            const url = encodeURIComponent((canonical || location).href);
            const response = await fetch(query + url);
            const json = await response.json();
            count = json.total || '-';
        } catch(error) {
            console.log(error);
        }
        
        // put count into button
        const counter = document.createElement('span');
        counter.id = 'hypothesis_count';
        counter.innerHTML = count;
        button.title = 'View ' + count + ' Hypothesis annotations';
        button.append(counter);
    }

    // when button is clicked
    function onButtonClick(event, button) {
        const script = document.createElement('script');
        script.src = embed;
        document.body.append(script);
        button.remove();
    }

    window.addEventListener('load', start);
</script>

<!-- hypothesis icon -->

<template class="icon_hypothesis">
    <!-- modified from: https://simpleicons.org/icons/hypothesis.svg / https://git.io/Jf1VB -->
    <svg width="16" height="16" viewBox="0 0 24 24" tabindex="-1">
        <path
            fill="currentColor"
            d="M3.43 0C2.5 0 1.72 .768 1.72 1.72V18.86C1.72 19.8 2.5 20.57 3.43 20.57H9.38L12 24L14.62 20.57H20.57C21.5 20.57 22.29 19.8 22.29 18.86V1.72C22.29 .77 21.5 0 20.57 0H3.43M5.14 3.43H7.72V9.43S8.58 7.72 10.28 7.72C12 7.72 13.74 8.57 13.74 11.24V17.14H11.16V12C11.16 10.61 10.28 10.07 9.43 10.29C8.57 10.5 7.72 11.41 7.72 13.29V17.14H5.14V3.43M18 13.72C18.95 13.72 19.72 14.5 19.72 15.42A1.71 1.71 0 0 1 18 17.13A1.71 1.71 0 0 1 16.29 15.42C16.29 14.5 17.05 13.71 18 13.71Z"
            tabindex="-1"
        ></path>
    </svg>
</template>
<!-- analytics plugin -->

<!-- copy and paste code from Google Analytics or similar service here -->
</body>
</html>
